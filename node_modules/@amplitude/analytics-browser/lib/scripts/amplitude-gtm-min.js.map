{"version":3,"file":"amplitude-gtm-min.js","sources":["../../../../node_modules/tslib/tslib.es6.js","../../../analytics-core/lib/esm/types/event/event.js","../../../analytics-core/lib/esm/types/constants.js","../../../analytics-core/lib/esm/identify.js","../../../analytics-core/lib/esm/utils/valid-properties.js","../../../analytics-core/lib/esm/types/status.js","../../../analytics-core/lib/esm/utils/result-builder.js","../../../analytics-core/lib/esm/revenue.js","../../../analytics-core/lib/esm/global-scope.js","../../../analytics-core/lib/esm/utils/uuid.js","../../../analytics-core/lib/esm/timeline.js","../../../analytics-core/lib/esm/utils/event-builder.js","../../../analytics-core/lib/esm/utils/return-wrapper.js","../../../analytics-core/lib/esm/core-client.js","../../../analytics-core/lib/esm/types/messages.js","../../../analytics-core/lib/esm/utils/chunk.js","../../../analytics-core/lib/esm/types/loglevel.js","../../../analytics-core/lib/esm/logger.js","../../../analytics-core/lib/esm/config.js","../../../analytics-core/lib/esm/plugins/destination.js","../../../../node_modules/@amplitude/analytics-connector/dist/analytics-connector.esm.js","../../../analytics-core/lib/esm/types/server-zone.js","../../../analytics-core/lib/esm/analytics-connector.js","../../../analytics-core/lib/esm/plugins/identity.js","../../../analytics-core/lib/esm/session.js","../../../analytics-core/lib/esm/cookie-name.js","../../../analytics-core/lib/esm/language.js","../../../analytics-core/lib/esm/query-params.js","../../../analytics-core/lib/esm/utils/debug.js","../../../analytics-core/lib/esm/storage/memory.js","../../../analytics-core/lib/esm/storage/cookie.js","../../../analytics-core/lib/esm/transports/base.js","../../../analytics-core/lib/esm/transports/fetch.js","../../../analytics-core/lib/esm/types/offline.js","../../../analytics-types/lib/esm/event.js","../../../analytics-types/lib/esm/server-zone.js","../../../analytics-types/lib/esm/status.js","../../../analytics-core/lib/esm/types/element-interactions.js","../../../src/default-tracking.ts","../../../src/utils/snippet-helper.ts","../../../src/version.ts","../../../src/plugins/context.ts","../../../src/lib-prefix.ts","../../../src/storage/browser-storage.ts","../../../src/storage/local-storage.ts","../../../src/storage/session-storage.ts","../../../src/transports/xhr.ts","../../../src/transports/send-beacon.ts","../../../src/cookie-migration/index.ts","../../../src/constants.ts","../../../src/config.ts","../../../analytics-client-common/lib/esm/global-scope.js","../../../analytics-client-common/lib/esm/query-params.js","../../../analytics-client-common/lib/esm/attribution/constants.js","../../../analytics-client-common/lib/esm/attribution/campaign-parser.js","../../../plugin-page-view-tracking-browser/lib/esm/utils.js","../../../plugin-page-view-tracking-browser/lib/esm/page-view-tracking.js","../../../src/plugins/form-interaction-tracking.ts","../../../src/plugins/file-download-tracking.ts","../../../src/det-notification.ts","../../../src/plugins/network-connectivity-checker.ts","../../node_modules/@amplitude/analytics-remote-config/lib/esm/remote-config.js","../../node_modules/@amplitude/analytics-remote-config/lib/esm/index.js","../../../src/config/joined-config.ts","../../../plugin-autocapture-browser/lib/esm/constants.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isFunction.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Subscription.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/config.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/noop.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/errorContext.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Subscriber.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/symbol/observable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/identity.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/pipe.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Observable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/lift.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/ConnectableObservable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/refCount.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/performanceTimestampProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/dom/animationFrames.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/animationFrameProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Subject.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/dateTimestampProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/ReplaySubject.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/AsyncSubject.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/Action.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/Immediate.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/intervalProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncAction.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/immediateProvider.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AsapAction.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Scheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AsyncScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AsapScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/asap.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/async.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/QueueAction.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/QueueScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/queue.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AnimationFrameAction.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/AnimationFrameScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/animationFrame.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduler/VirtualTimeScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/empty.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isScheduler.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/args.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isPromise.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/symbol/iterator.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/Notification.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isIterable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/executeSchedule.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/observeOn.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/subscribeOn.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/from.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/isDate.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/EmptyError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/ArgumentOutOfRangeError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/NotFoundError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/SequenceError.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/timeout.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/map.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/util/mapOneOrManyArgs.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/mergeAll.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/concatAll.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/merge.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/filter.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/take.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/delayWhen.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/concat.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/ignoreElements.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/mapTo.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/delay.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/timer.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/share.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/observable/never.js","../../../plugin-autocapture-browser/lib/esm/helpers.js","../../../plugin-autocapture-browser/lib/esm/libs/messenger.js","../../../plugin-autocapture-browser/lib/esm/hierarchy.js","../../../plugin-autocapture-browser/lib/esm/autocapture/track-click.js","../../../plugin-autocapture-browser/lib/esm/autocapture-plugin.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/buffer.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/pairwise.js","../../../plugin-autocapture-browser/lib/esm/autocapture/track-action-click.js","../../../plugin-autocapture-browser/node_modules/rxjs/dist/esm5/internal/operators/switchMap.js","../../../src/index.ts","../../../plugin-autocapture-browser/lib/esm/autocapture/track-change.js","../../../src/attribution/constants.ts","../../../src/attribution/helpers.ts","../../../src/attribution/campaign-parser.ts","../../../src/attribution/web-attribution.ts","../../../analytics-core/lib/esm/storage/helpers.js","../../../src/browser-client.ts","../../../src/browser-client-factory.ts","../../../src/gtm-snippet-index.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","export var IdentifyOperation;\n(function (IdentifyOperation) {\n    // Base Operations to set values\n    IdentifyOperation[\"SET\"] = \"$set\";\n    IdentifyOperation[\"SET_ONCE\"] = \"$setOnce\";\n    // Operations around modifying existing values\n    IdentifyOperation[\"ADD\"] = \"$add\";\n    IdentifyOperation[\"APPEND\"] = \"$append\";\n    IdentifyOperation[\"PREPEND\"] = \"$prepend\";\n    IdentifyOperation[\"REMOVE\"] = \"$remove\";\n    // Operations around appending values *if* they aren't present\n    IdentifyOperation[\"PREINSERT\"] = \"$preInsert\";\n    IdentifyOperation[\"POSTINSERT\"] = \"$postInsert\";\n    // Operations around removing properties/values\n    IdentifyOperation[\"UNSET\"] = \"$unset\";\n    IdentifyOperation[\"CLEAR_ALL\"] = \"$clearAll\";\n})(IdentifyOperation || (IdentifyOperation = {}));\n/**\n * Strings that have special meaning when used as an event's type\n * and have different specifications.\n */\nexport var SpecialEventType;\n(function (SpecialEventType) {\n    SpecialEventType[\"IDENTIFY\"] = \"$identify\";\n    SpecialEventType[\"GROUP_IDENTIFY\"] = \"$groupidentify\";\n    SpecialEventType[\"REVENUE\"] = \"revenue_amount\";\n})(SpecialEventType || (SpecialEventType = {}));\n//# sourceMappingURL=event.js.map","export var UNSET_VALUE = '-';\nexport var AMPLITUDE_PREFIX = 'AMP';\nexport var STORAGE_PREFIX = \"\".concat(AMPLITUDE_PREFIX, \"_unsent\");\nexport var AMPLITUDE_SERVER_URL = 'https://api2.amplitude.com/2/httpapi';\nexport var EU_AMPLITUDE_SERVER_URL = 'https://api.eu.amplitude.com/2/httpapi';\nexport var AMPLITUDE_BATCH_SERVER_URL = 'https://api2.amplitude.com/batch';\nexport var EU_AMPLITUDE_BATCH_SERVER_URL = 'https://api.eu.amplitude.com/batch';\n//# sourceMappingURL=constants.js.map","import { __assign } from \"tslib\";\nimport { UNSET_VALUE } from './types/constants';\nimport { isValidProperties } from './utils/valid-properties';\nvar Identify = /** @class */ (function () {\n    function Identify() {\n        this._propertySet = new Set();\n        this._properties = {};\n    }\n    Identify.prototype.getUserProperties = function () {\n        return __assign({}, this._properties);\n    };\n    Identify.prototype.set = function (property, value) {\n        this._safeSet(IdentifyOperation.SET, property, value);\n        return this;\n    };\n    Identify.prototype.setOnce = function (property, value) {\n        this._safeSet(IdentifyOperation.SET_ONCE, property, value);\n        return this;\n    };\n    Identify.prototype.append = function (property, value) {\n        this._safeSet(IdentifyOperation.APPEND, property, value);\n        return this;\n    };\n    Identify.prototype.prepend = function (property, value) {\n        this._safeSet(IdentifyOperation.PREPEND, property, value);\n        return this;\n    };\n    Identify.prototype.postInsert = function (property, value) {\n        this._safeSet(IdentifyOperation.POSTINSERT, property, value);\n        return this;\n    };\n    Identify.prototype.preInsert = function (property, value) {\n        this._safeSet(IdentifyOperation.PREINSERT, property, value);\n        return this;\n    };\n    Identify.prototype.remove = function (property, value) {\n        this._safeSet(IdentifyOperation.REMOVE, property, value);\n        return this;\n    };\n    Identify.prototype.add = function (property, value) {\n        this._safeSet(IdentifyOperation.ADD, property, value);\n        return this;\n    };\n    Identify.prototype.unset = function (property) {\n        this._safeSet(IdentifyOperation.UNSET, property, UNSET_VALUE);\n        return this;\n    };\n    Identify.prototype.clearAll = function () {\n        // When clear all happens, all properties are unset. Reset the entire object.\n        this._properties = {};\n        this._properties[IdentifyOperation.CLEAR_ALL] = UNSET_VALUE;\n        return this;\n    };\n    // Returns whether or not this set actually worked.\n    Identify.prototype._safeSet = function (operation, property, value) {\n        if (this._validate(operation, property, value)) {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            var userPropertyMap = this._properties[operation];\n            if (userPropertyMap === undefined) {\n                userPropertyMap = {};\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this._properties[operation] = userPropertyMap;\n            }\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n            userPropertyMap[property] = value;\n            this._propertySet.add(property);\n            return true;\n        }\n        return false;\n    };\n    Identify.prototype._validate = function (operation, property, value) {\n        if (this._properties[IdentifyOperation.CLEAR_ALL] !== undefined) {\n            // clear all already set. Skipping operation;\n            return false;\n        }\n        if (this._propertySet.has(property)) {\n            // Property already used. Skipping operation\n            return false;\n        }\n        if (operation === IdentifyOperation.ADD) {\n            return typeof value === 'number';\n        }\n        if (operation !== IdentifyOperation.UNSET && operation !== IdentifyOperation.REMOVE) {\n            return isValidProperties(property, value);\n        }\n        return true;\n    };\n    return Identify;\n}());\nexport { Identify };\nexport var IdentifyOperation;\n(function (IdentifyOperation) {\n    // Base Operations to set values\n    IdentifyOperation[\"SET\"] = \"$set\";\n    IdentifyOperation[\"SET_ONCE\"] = \"$setOnce\";\n    // Operations around modifying existing values\n    IdentifyOperation[\"ADD\"] = \"$add\";\n    IdentifyOperation[\"APPEND\"] = \"$append\";\n    IdentifyOperation[\"PREPEND\"] = \"$prepend\";\n    IdentifyOperation[\"REMOVE\"] = \"$remove\";\n    // Operations around appending values *if* they aren't present\n    IdentifyOperation[\"PREINSERT\"] = \"$preInsert\";\n    IdentifyOperation[\"POSTINSERT\"] = \"$postInsert\";\n    // Operations around removing properties/values\n    IdentifyOperation[\"UNSET\"] = \"$unset\";\n    IdentifyOperation[\"CLEAR_ALL\"] = \"$clearAll\";\n})(IdentifyOperation || (IdentifyOperation = {}));\n/**\n * Note that the order of operations should align with https://github.com/amplitude/nova/blob/7701b5986b565d4b2fb53b99a9f2175df055dea8/src/main/java/com/amplitude/ingestion/core/UserPropertyUtils.java#L210\n */\nexport var OrderedIdentifyOperations = [\n    IdentifyOperation.CLEAR_ALL,\n    IdentifyOperation.UNSET,\n    IdentifyOperation.SET,\n    IdentifyOperation.SET_ONCE,\n    IdentifyOperation.ADD,\n    IdentifyOperation.APPEND,\n    IdentifyOperation.PREPEND,\n    IdentifyOperation.PREINSERT,\n    IdentifyOperation.POSTINSERT,\n    IdentifyOperation.REMOVE,\n];\n//# sourceMappingURL=identify.js.map","import { __values } from \"tslib\";\nvar MAX_PROPERTY_KEYS = 1000;\nexport var isValidObject = function (properties) {\n    if (Object.keys(properties).length > MAX_PROPERTY_KEYS) {\n        return false;\n    }\n    for (var key in properties) {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n        var value = properties[key];\n        if (!isValidProperties(key, value))\n            return false;\n    }\n    return true;\n};\nexport var isValidProperties = function (property, value) {\n    var e_1, _a;\n    if (typeof property !== 'string')\n        return false;\n    if (Array.isArray(value)) {\n        var isValid = true;\n        try {\n            for (var value_1 = __values(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {\n                var valueElement = value_1_1.value;\n                if (Array.isArray(valueElement)) {\n                    return false;\n                }\n                else if (typeof valueElement === 'object') {\n                    isValid = isValid && isValidObject(valueElement);\n                }\n                else if (!['number', 'string'].includes(typeof valueElement)) {\n                    return false;\n                }\n                if (!isValid) {\n                    return false;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    else if (value === null || value === undefined) {\n        return false;\n    }\n    else if (typeof value === 'object') {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n        return isValidObject(value);\n    }\n    else if (!['number', 'string', 'boolean'].includes(typeof value)) {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=valid-properties.js.map","/** The status of an event. */\nexport var Status;\n(function (Status) {\n    /** The status could not be determined. */\n    Status[\"Unknown\"] = \"unknown\";\n    /** The event was skipped due to configuration or callbacks. */\n    Status[\"Skipped\"] = \"skipped\";\n    /** The event was sent successfully. */\n    Status[\"Success\"] = \"success\";\n    /** A user or device in the payload is currently rate limited and should try again later. */\n    Status[\"RateLimit\"] = \"rate_limit\";\n    /** The sent payload was too large to be processed. */\n    Status[\"PayloadTooLarge\"] = \"payload_too_large\";\n    /** The event could not be processed. */\n    Status[\"Invalid\"] = \"invalid\";\n    /** A server-side error ocurred during submission. */\n    Status[\"Failed\"] = \"failed\";\n    /** a server or client side error occuring when a request takes too long and is cancelled */\n    Status[\"Timeout\"] = \"Timeout\";\n    /** NodeJS runtime environment error.. E.g. disconnected from network */\n    Status[\"SystemError\"] = \"SystemError\";\n})(Status || (Status = {}));\n//# sourceMappingURL=status.js.map","import { Status } from '../types/status';\nexport var buildResult = function (event, code, message) {\n    if (code === void 0) { code = 0; }\n    if (message === void 0) { message = Status.Unknown; }\n    return { event: event, code: code, message: message };\n};\n//# sourceMappingURL=result-builder.js.map","import { __assign } from \"tslib\";\nimport { isValidObject } from './utils/valid-properties';\nvar Revenue = /** @class */ (function () {\n    function Revenue() {\n        this.productId = '';\n        this.quantity = 1;\n        this.price = 0.0;\n    }\n    Revenue.prototype.setProductId = function (productId) {\n        this.productId = productId;\n        return this;\n    };\n    Revenue.prototype.setQuantity = function (quantity) {\n        if (quantity > 0) {\n            this.quantity = quantity;\n        }\n        return this;\n    };\n    Revenue.prototype.setPrice = function (price) {\n        this.price = price;\n        return this;\n    };\n    Revenue.prototype.setRevenueType = function (revenueType) {\n        this.revenueType = revenueType;\n        return this;\n    };\n    Revenue.prototype.setCurrency = function (currency) {\n        this.currency = currency;\n        return this;\n    };\n    Revenue.prototype.setRevenue = function (revenue) {\n        this.revenue = revenue;\n        return this;\n    };\n    Revenue.prototype.setReceipt = function (receipt) {\n        this.receipt = receipt;\n        return this;\n    };\n    Revenue.prototype.setReceiptSig = function (receiptSig) {\n        this.receiptSig = receiptSig;\n        return this;\n    };\n    Revenue.prototype.setEventProperties = function (properties) {\n        if (isValidObject(properties)) {\n            this.properties = properties;\n        }\n        return this;\n    };\n    Revenue.prototype.getEventProperties = function () {\n        var eventProperties = this.properties ? __assign({}, this.properties) : {};\n        eventProperties[RevenueProperty.REVENUE_PRODUCT_ID] = this.productId;\n        eventProperties[RevenueProperty.REVENUE_QUANTITY] = this.quantity;\n        eventProperties[RevenueProperty.REVENUE_PRICE] = this.price;\n        eventProperties[RevenueProperty.REVENUE_TYPE] = this.revenueType;\n        eventProperties[RevenueProperty.REVENUE_CURRENCY] = this.currency;\n        eventProperties[RevenueProperty.REVENUE] = this.revenue;\n        eventProperties[RevenueProperty.RECEIPT] = this.receipt;\n        eventProperties[RevenueProperty.RECEIPT_SIG] = this.receiptSig;\n        return eventProperties;\n    };\n    return Revenue;\n}());\nexport { Revenue };\nexport var RevenueProperty;\n(function (RevenueProperty) {\n    RevenueProperty[\"REVENUE_PRODUCT_ID\"] = \"$productId\";\n    RevenueProperty[\"REVENUE_QUANTITY\"] = \"$quantity\";\n    RevenueProperty[\"REVENUE_PRICE\"] = \"$price\";\n    RevenueProperty[\"REVENUE_TYPE\"] = \"$revenueType\";\n    RevenueProperty[\"REVENUE_CURRENCY\"] = \"$currency\";\n    RevenueProperty[\"REVENUE\"] = \"$revenue\";\n    RevenueProperty[\"RECEIPT\"] = \"$receipt\";\n    RevenueProperty[\"RECEIPT_SIG\"] = \"$receiptSig\";\n})(RevenueProperty || (RevenueProperty = {}));\n//# sourceMappingURL=revenue.js.map","/* eslint-disable no-restricted-globals */\n/* Only file allowed to access to globalThis, window, self */\nexport var getGlobalScope = function () {\n    // This should only be used for integrations with Amplitude that are not running in a browser environment\n    //   We need to specify the name of the global variable as a string to prevent it from being minified\n    var ampIntegrationContextName = 'ampIntegrationContext';\n    if (typeof globalThis !== 'undefined' && typeof globalThis[ampIntegrationContextName] !== 'undefined') {\n        return globalThis[ampIntegrationContextName];\n    }\n    if (typeof globalThis !== 'undefined') {\n        return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    return undefined;\n};\n//# sourceMappingURL=global-scope.js.map","/**\n * Source: [jed's gist's comment]{@link https://gist.github.com/jed/982883?permalink_comment_id=3223002#gistcomment-3223002}.\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f, and\n * y is replaced with a random hexadecimal digit from 8 to b.\n * Used to generate UUIDs for deviceIds.\n * @private\n */\nimport { __read, __spreadArray } from \"tslib\";\nimport { getGlobalScope } from '../global-scope';\nvar legacyUUID = function (a) {\n    return a // if the placeholder was passed, return\n        ? // a random number from 0 to 15\n            (a ^ // unless b is 8,\n                ((Math.random() * // in which case\n                    16) >> // a random number from\n                    (a / 4))) // 8 to 11\n                .toString(16) // in hexadecimal\n        : // or otherwise a concatenated string:\n            (String(1e7) + // 10000000 +\n                String(-1e3) + // -1000 +\n                String(-4e3) + // -4000 +\n                String(-8e3) + // -80000000 +\n                String(-1e11)) // -100000000000,\n                .replace(\n            // replacing\n            /[018]/g, // zeroes, ones, and eights with\n            UUID);\n};\nvar hex = __spreadArray([], __read(Array(256).keys()), false).map(function (index) { return index.toString(16).padStart(2, '0'); });\nexport var UUID = function (a) {\n    var _a;\n    var globalScope = getGlobalScope();\n    /* istanbul ignore next */\n    if (!((_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.crypto) === null || _a === void 0 ? void 0 : _a.getRandomValues)) {\n        // Fallback to legacy UUID generation if crypto is not available\n        return legacyUUID(a);\n    }\n    var r = globalScope.crypto.getRandomValues(new Uint8Array(16));\n    r[6] = (r[6] & 0x0f) | 0x40;\n    r[8] = (r[8] & 0x3f) | 0x80;\n    return __spreadArray([], __read(r.entries()), false).map(function (_a) {\n        var _b = __read(_a, 2), index = _b[0], int = _b[1];\n        return ([4, 6, 8, 10].includes(index) ? \"-\".concat(hex[int]) : hex[int]);\n    }).join('');\n};\n//# sourceMappingURL=uuid.js.map","import { __assign, __awaiter, __generator, __read, __values } from \"tslib\";\nimport { buildResult } from './utils/result-builder';\nimport { UUID } from './utils/uuid';\nvar Timeline = /** @class */ (function () {\n    function Timeline(client) {\n        this.client = client;\n        this.queue = [];\n        // Flag to guarantee one schedule apply is running\n        this.applying = false;\n        // Flag indicates whether timeline is ready to process event\n        // Events collected before timeline is ready will stay in the queue to be processed later\n        this.plugins = [];\n    }\n    Timeline.prototype.register = function (plugin, config) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this.plugins.some(function (existingPlugin) { return existingPlugin.name === plugin.name; })) {\n                            // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n                            config.loggerProvider.warn(\"Plugin with name \".concat(plugin.name, \" already exists, skipping registration\"));\n                            return [2 /*return*/];\n                        }\n                        if (plugin.name === undefined) {\n                            plugin.name = UUID();\n                            config.loggerProvider.warn(\"Plugin name is undefined. \\n      Generating a random UUID for plugin name: \".concat(plugin.name, \". \\n      Set a name for the plugin to prevent it from being added multiple times.\"));\n                        }\n                        plugin.type = (_a = plugin.type) !== null && _a !== void 0 ? _a : 'enrichment';\n                        return [4 /*yield*/, ((_b = plugin.setup) === null || _b === void 0 ? void 0 : _b.call(plugin, config, this.client))];\n                    case 1:\n                        _c.sent();\n                        this.plugins.push(plugin);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.deregister = function (pluginName, config) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var index, plugin;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        index = this.plugins.findIndex(function (plugin) { return plugin.name === pluginName; });\n                        if (index === -1) {\n                            config.loggerProvider.warn(\"Plugin with name \".concat(pluginName, \" does not exist, skipping deregistration\"));\n                            return [2 /*return*/];\n                        }\n                        plugin = this.plugins[index];\n                        this.plugins.splice(index, 1);\n                        return [4 /*yield*/, ((_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin))];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.reset = function (client) {\n        this.applying = false;\n        var plugins = this.plugins;\n        plugins.map(function (plugin) { var _a; return (_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin); });\n        this.plugins = [];\n        this.client = client;\n    };\n    Timeline.prototype.push = function (event) {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.queue.push([event, resolve]);\n            _this.scheduleApply(0);\n        });\n    };\n    Timeline.prototype.scheduleApply = function (timeout) {\n        var _this = this;\n        if (this.applying)\n            return;\n        this.applying = true;\n        setTimeout(function () {\n            void _this.apply(_this.queue.shift()).then(function () {\n                _this.applying = false;\n                if (_this.queue.length > 0) {\n                    _this.scheduleApply(0);\n                }\n            });\n        }, timeout);\n    };\n    Timeline.prototype.apply = function (item) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, event, _b, resolve, before, before_1, before_1_1, plugin, e, e_1_1, enrichment, enrichment_1, enrichment_1_1, plugin, e, e_2_1, destination, executeDestinations;\n            var e_1, _c, e_2, _d;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0:\n                        if (!item) {\n                            return [2 /*return*/];\n                        }\n                        _a = __read(item, 1), event = _a[0];\n                        _b = __read(item, 2), resolve = _b[1];\n                        before = this.plugins.filter(function (plugin) { return plugin.type === 'before'; });\n                        _e.label = 1;\n                    case 1:\n                        _e.trys.push([1, 6, 7, 8]);\n                        before_1 = __values(before), before_1_1 = before_1.next();\n                        _e.label = 2;\n                    case 2:\n                        if (!!before_1_1.done) return [3 /*break*/, 5];\n                        plugin = before_1_1.value;\n                        /* istanbul ignore if */\n                        if (!plugin.execute) {\n                            // do nothing\n                            return [3 /*break*/, 4];\n                        }\n                        return [4 /*yield*/, plugin.execute(__assign({}, event))];\n                    case 3:\n                        e = _e.sent();\n                        if (e === null) {\n                            resolve({ event: event, code: 0, message: '' });\n                            return [2 /*return*/];\n                        }\n                        else {\n                            event = e;\n                        }\n                        _e.label = 4;\n                    case 4:\n                        before_1_1 = before_1.next();\n                        return [3 /*break*/, 2];\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        e_1_1 = _e.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 8];\n                    case 7:\n                        try {\n                            if (before_1_1 && !before_1_1.done && (_c = before_1.return)) _c.call(before_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                        return [7 /*endfinally*/];\n                    case 8:\n                        enrichment = this.plugins.filter(function (plugin) { return plugin.type === 'enrichment' || plugin.type === undefined; });\n                        _e.label = 9;\n                    case 9:\n                        _e.trys.push([9, 14, 15, 16]);\n                        enrichment_1 = __values(enrichment), enrichment_1_1 = enrichment_1.next();\n                        _e.label = 10;\n                    case 10:\n                        if (!!enrichment_1_1.done) return [3 /*break*/, 13];\n                        plugin = enrichment_1_1.value;\n                        /* istanbul ignore if */\n                        if (!plugin.execute) {\n                            // do nothing\n                            return [3 /*break*/, 12];\n                        }\n                        return [4 /*yield*/, plugin.execute(__assign({}, event))];\n                    case 11:\n                        e = _e.sent();\n                        if (e === null) {\n                            resolve({ event: event, code: 0, message: '' });\n                            return [2 /*return*/];\n                        }\n                        else {\n                            event = e;\n                        }\n                        _e.label = 12;\n                    case 12:\n                        enrichment_1_1 = enrichment_1.next();\n                        return [3 /*break*/, 10];\n                    case 13: return [3 /*break*/, 16];\n                    case 14:\n                        e_2_1 = _e.sent();\n                        e_2 = { error: e_2_1 };\n                        return [3 /*break*/, 16];\n                    case 15:\n                        try {\n                            if (enrichment_1_1 && !enrichment_1_1.done && (_d = enrichment_1.return)) _d.call(enrichment_1);\n                        }\n                        finally { if (e_2) throw e_2.error; }\n                        return [7 /*endfinally*/];\n                    case 16:\n                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });\n                        executeDestinations = destination.map(function (plugin) {\n                            var eventClone = __assign({}, event);\n                            return plugin.execute(eventClone).catch(function (e) { return buildResult(eventClone, 0, String(e)); });\n                        });\n                        void Promise.all(executeDestinations).then(function (_a) {\n                            var _b = __read(_a, 1), result = _b[0];\n                            var resolveResult = result || buildResult(event, 100, 'Event not tracked, no destination plugins on the instance');\n                            resolve(resolveResult);\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.flush = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var queue, destination, executeDestinations;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        queue = this.queue;\n                        this.queue = [];\n                        return [4 /*yield*/, Promise.all(queue.map(function (item) { return _this.apply(item); }))];\n                    case 1:\n                        _a.sent();\n                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });\n                        executeDestinations = destination.map(function (plugin) {\n                            return plugin.flush && plugin.flush();\n                        });\n                        return [4 /*yield*/, Promise.all(executeDestinations)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.onIdentityChanged = function (identity) {\n        this.plugins.forEach(function (plugin) {\n            var _a;\n            // Intentionally to not await plugin.onIdentityChanged() for non-blocking.\n            // Ignore optional channing next line for test coverage.\n            // If the plugin doesn't implement it, it won't be called.\n            /* istanbul ignore next */\n            void ((_a = plugin.onIdentityChanged) === null || _a === void 0 ? void 0 : _a.call(plugin, identity));\n        });\n    };\n    Timeline.prototype.onSessionIdChanged = function (sessionId) {\n        this.plugins.forEach(function (plugin) {\n            var _a;\n            // Intentionally to not await plugin.onSessionIdChanged() for non-blocking.\n            // Ignore optional channing next line for test coverage.\n            // If the plugin doesn't implement it, it won't be called.\n            /* istanbul ignore next */\n            void ((_a = plugin.onSessionIdChanged) === null || _a === void 0 ? void 0 : _a.call(plugin, sessionId));\n        });\n    };\n    Timeline.prototype.onOptOutChanged = function (optOut) {\n        this.plugins.forEach(function (plugin) {\n            var _a;\n            // Intentionally to not await plugin.onOptOutChanged() for non-blocking.\n            // Ignore optional channing next line for test coverage.\n            // If the plugin doesn't implement it, it won't be called.\n            /* istanbul ignore next */\n            void ((_a = plugin.onOptOutChanged) === null || _a === void 0 ? void 0 : _a.call(plugin, optOut));\n        });\n    };\n    return Timeline;\n}());\nexport { Timeline };\n//# sourceMappingURL=timeline.js.map","import { __assign } from \"tslib\";\nimport { Identify } from '../identify';\nimport { SpecialEventType } from '../types/event/event';\nexport var createTrackEvent = function (eventInput, eventProperties, eventOptions) {\n    var baseEvent = typeof eventInput === 'string' ? { event_type: eventInput } : eventInput;\n    return __assign(__assign(__assign({}, baseEvent), eventOptions), (eventProperties && { event_properties: eventProperties }));\n};\nexport var createIdentifyEvent = function (identify, eventOptions) {\n    var identifyEvent = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties() });\n    return identifyEvent;\n};\nexport var createGroupIdentifyEvent = function (groupType, groupName, identify, eventOptions) {\n    var _a;\n    var groupIdentify = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.GROUP_IDENTIFY, group_properties: identify.getUserProperties(), groups: (_a = {},\n            _a[groupType] = groupName,\n            _a) });\n    return groupIdentify;\n};\nexport var createGroupEvent = function (groupType, groupName, eventOptions) {\n    var _a;\n    var identify = new Identify();\n    identify.set(groupType, groupName);\n    var groupEvent = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties(), groups: (_a = {},\n            _a[groupType] = groupName,\n            _a) });\n    return groupEvent;\n};\nexport var createRevenueEvent = function (revenue, eventOptions) {\n    return __assign(__assign({}, eventOptions), { event_type: SpecialEventType.REVENUE, event_properties: revenue.getEventProperties() });\n};\n//# sourceMappingURL=event-builder.js.map","export var returnWrapper = function (awaitable) { return ({\n    promise: awaitable || Promise.resolve(),\n}); };\n//# sourceMappingURL=return-wrapper.js.map","import { __awaiter, __generator, __values } from \"tslib\";\nimport { IdentifyOperation, SpecialEventType, } from './types/event/event';\nimport { OrderedIdentifyOperations } from './identify';\nimport { CLIENT_NOT_INITIALIZED, OPT_OUT_MESSAGE } from './types/messages';\nimport { Timeline } from './timeline';\nimport { createGroupEvent, createGroupIdentifyEvent, createIdentifyEvent, createRevenueEvent, createTrackEvent, } from './utils/event-builder';\nimport { buildResult } from './utils/result-builder';\nimport { returnWrapper } from './utils/return-wrapper';\nvar AmplitudeCore = /** @class */ (function () {\n    function AmplitudeCore(name) {\n        if (name === void 0) { name = '$default'; }\n        this.initializing = false;\n        this.isReady = false;\n        this.q = [];\n        this.dispatchQ = [];\n        this.logEvent = this.track.bind(this);\n        this.timeline = new Timeline(this);\n        this.name = name;\n    }\n    AmplitudeCore.prototype._init = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.config = config;\n                        this.timeline.reset(this);\n                        return [4 /*yield*/, this.runQueuedFunctions('q')];\n                    case 1:\n                        _a.sent();\n                        this.isReady = true;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.runQueuedFunctions = function (queueName) {\n        return __awaiter(this, void 0, void 0, function () {\n            var queuedFunctions, queuedFunctions_1, queuedFunctions_1_1, queuedFunction, val, e_1_1;\n            var e_1, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        queuedFunctions = this[queueName];\n                        this[queueName] = [];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 8, 9, 10]);\n                        queuedFunctions_1 = __values(queuedFunctions), queuedFunctions_1_1 = queuedFunctions_1.next();\n                        _b.label = 2;\n                    case 2:\n                        if (!!queuedFunctions_1_1.done) return [3 /*break*/, 7];\n                        queuedFunction = queuedFunctions_1_1.value;\n                        val = queuedFunction();\n                        if (!(val && 'promise' in val)) return [3 /*break*/, 4];\n                        return [4 /*yield*/, val.promise];\n                    case 3:\n                        _b.sent();\n                        return [3 /*break*/, 6];\n                    case 4: return [4 /*yield*/, val];\n                    case 5:\n                        _b.sent();\n                        _b.label = 6;\n                    case 6:\n                        queuedFunctions_1_1 = queuedFunctions_1.next();\n                        return [3 /*break*/, 2];\n                    case 7: return [3 /*break*/, 10];\n                    case 8:\n                        e_1_1 = _b.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 10];\n                    case 9:\n                        try {\n                            if (queuedFunctions_1_1 && !queuedFunctions_1_1.done && (_a = queuedFunctions_1.return)) _a.call(queuedFunctions_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                        return [7 /*endfinally*/];\n                    case 10:\n                        if (!this[queueName].length) return [3 /*break*/, 12];\n                        return [4 /*yield*/, this.runQueuedFunctions(queueName)];\n                    case 11:\n                        _b.sent();\n                        _b.label = 12;\n                    case 12: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.track = function (eventInput, eventProperties, eventOptions) {\n        var event = createTrackEvent(eventInput, eventProperties, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.identify = function (identify, eventOptions) {\n        var event = createIdentifyEvent(identify, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.groupIdentify = function (groupType, groupName, identify, eventOptions) {\n        var event = createGroupIdentifyEvent(groupType, groupName, identify, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.setGroup = function (groupType, groupName, eventOptions) {\n        var event = createGroupEvent(groupType, groupName, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.revenue = function (revenue, eventOptions) {\n        var event = createRevenueEvent(revenue, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.add = function (plugin) {\n        if (!this.isReady) {\n            this.q.push(this._addPlugin.bind(this, plugin));\n            return returnWrapper();\n        }\n        return this._addPlugin(plugin);\n    };\n    AmplitudeCore.prototype._addPlugin = function (plugin) {\n        return returnWrapper(this.timeline.register(plugin, this.config));\n    };\n    AmplitudeCore.prototype.remove = function (pluginName) {\n        if (!this.isReady) {\n            this.q.push(this._removePlugin.bind(this, pluginName));\n            return returnWrapper();\n        }\n        return this._removePlugin(pluginName);\n    };\n    AmplitudeCore.prototype._removePlugin = function (pluginName) {\n        return returnWrapper(this.timeline.deregister(pluginName, this.config));\n    };\n    AmplitudeCore.prototype.dispatchWithCallback = function (event, callback) {\n        if (!this.isReady) {\n            return callback(buildResult(event, 0, CLIENT_NOT_INITIALIZED));\n        }\n        void this.process(event).then(callback);\n    };\n    AmplitudeCore.prototype.dispatch = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                if (!this.isReady) {\n                    return [2 /*return*/, new Promise(function (resolve) {\n                            _this.dispatchQ.push(_this.dispatchWithCallback.bind(_this, event, resolve));\n                        })];\n                }\n                return [2 /*return*/, this.process(event)];\n            });\n        });\n    };\n    /**\n     *\n     * This method applies identify operations to user properties and\n     * returns a single object representing the final user property state.\n     *\n     * This is a best-effort api that only supports $set, $clearAll, and $unset.\n     * Other operations are not supported and are ignored.\n     *\n     *\n     * @param userProperties The `event.userProperties` object from an Identify event.\n     * @returns A key-value object user properties without operations.\n     *\n     * @example\n     * Input:\n     * {\n     *   $set: { plan: 'premium' },\n     *   custom_flag: true\n     * }\n     *\n     * Output:\n     * {\n     *   plan: 'premium',\n     *   custom_flag: true\n     * }\n     */\n    AmplitudeCore.prototype.getOperationAppliedUserProperties = function (userProperties) {\n        var updatedProperties = {};\n        if (userProperties === undefined) {\n            return updatedProperties;\n        }\n        // Keep non-operation keys for later merge\n        var nonOpProperties = {};\n        Object.keys(userProperties).forEach(function (key) {\n            if (!Object.values(IdentifyOperation).includes(key)) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                nonOpProperties[key] = userProperties[key];\n            }\n        });\n        OrderedIdentifyOperations.forEach(function (operation) {\n            // Skip when key is an operation.\n            if (!Object.keys(userProperties).includes(operation))\n                return;\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            var opProperties = userProperties[operation];\n            switch (operation) {\n                case IdentifyOperation.CLEAR_ALL:\n                    // Due to operation order, the following line will never execute.\n                    /* istanbul ignore next */\n                    Object.keys(updatedProperties).forEach(function (prop) {\n                        delete updatedProperties[prop];\n                    });\n                    break;\n                case IdentifyOperation.UNSET:\n                    Object.keys(opProperties).forEach(function (prop) {\n                        delete updatedProperties[prop];\n                    });\n                    break;\n                case IdentifyOperation.SET:\n                    Object.assign(updatedProperties, opProperties);\n                    break;\n            }\n        });\n        // Merge non-operation properties.\n        // Custom properties should not be affected by operations.\n        // https://github.com/amplitude/nova/blob/343f678ded83c032e83b189796b3c2be161b48f5/src/main/java/com/amplitude/userproperty/model/ModifyUserPropertiesIdent.java#L79-L83\n        Object.assign(updatedProperties, nonOpProperties);\n        return updatedProperties;\n    };\n    AmplitudeCore.prototype.process = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var userProperties, result, e_2, message, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        // skip event processing if opt out\n                        if (this.config.optOut) {\n                            return [2 /*return*/, buildResult(event, 0, OPT_OUT_MESSAGE)];\n                        }\n                        if (event.event_type === SpecialEventType.IDENTIFY) {\n                            userProperties = this.getOperationAppliedUserProperties(event.user_properties);\n                            this.timeline.onIdentityChanged({ userProperties: userProperties });\n                        }\n                        return [4 /*yield*/, this.timeline.push(event)];\n                    case 1:\n                        result = _a.sent();\n                        result.code === 200\n                            ? this.config.loggerProvider.log(result.message)\n                            : result.code === 100\n                                ? this.config.loggerProvider.warn(result.message)\n                                : this.config.loggerProvider.error(result.message);\n                        return [2 /*return*/, result];\n                    case 2:\n                        e_2 = _a.sent();\n                        message = String(e_2);\n                        this.config.loggerProvider.error(message);\n                        result = buildResult(event, 0, message);\n                        return [2 /*return*/, result];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.setOptOut = function (optOut) {\n        if (!this.isReady) {\n            this.q.push(this._setOptOut.bind(this, Boolean(optOut)));\n            return;\n        }\n        this._setOptOut(optOut);\n    };\n    AmplitudeCore.prototype._setOptOut = function (optOut) {\n        if (this.config.optOut !== optOut) {\n            this.timeline.onOptOutChanged(optOut);\n            this.config.optOut = Boolean(optOut);\n        }\n    };\n    AmplitudeCore.prototype.flush = function () {\n        return returnWrapper(this.timeline.flush());\n    };\n    AmplitudeCore.prototype.plugin = function (name) {\n        var plugin = this.timeline.plugins.find(function (plugin) { return plugin.name === name; });\n        if (plugin === undefined) {\n            this.config.loggerProvider.debug(\"Cannot find plugin with name \".concat(name));\n            return undefined;\n        }\n        return plugin;\n    };\n    return AmplitudeCore;\n}());\nexport { AmplitudeCore };\n//# sourceMappingURL=core-client.js.map","export var SUCCESS_MESSAGE = 'Event tracked successfully';\nexport var UNEXPECTED_ERROR_MESSAGE = 'Unexpected error occurred';\nexport var MAX_RETRIES_EXCEEDED_MESSAGE = 'Event rejected due to exceeded retry count';\nexport var OPT_OUT_MESSAGE = 'Event skipped due to optOut config';\nexport var MISSING_API_KEY_MESSAGE = 'Event rejected due to missing API key';\nexport var INVALID_API_KEY = 'Invalid API key';\nexport var CLIENT_NOT_INITIALIZED = 'Client not initialized';\n//# sourceMappingURL=messages.js.map","// Creates an array of elements split into groups the length of size.\n// If array can't be split evenly, the final chunk will be the remaining elements.\n// Works similary as https://lodash.com/docs/4.17.15#chunk\nexport var chunk = function (arr, size) {\n    var chunkSize = Math.max(size, 1);\n    return arr.reduce(function (chunks, element, index) {\n        var chunkIndex = Math.floor(index / chunkSize);\n        if (!chunks[chunkIndex]) {\n            chunks[chunkIndex] = [];\n        }\n        chunks[chunkIndex].push(element);\n        return chunks;\n    }, []);\n};\n//# sourceMappingURL=chunk.js.map","export var LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"None\"] = 0] = \"None\";\n    LogLevel[LogLevel[\"Error\"] = 1] = \"Error\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Verbose\"] = 3] = \"Verbose\";\n    LogLevel[LogLevel[\"Debug\"] = 4] = \"Debug\";\n})(LogLevel || (LogLevel = {}));\n//# sourceMappingURL=loglevel.js.map","import { LogLevel } from './types/loglevel';\nvar PREFIX = 'Amplitude Logger ';\nvar Logger = /** @class */ (function () {\n    function Logger() {\n        this.logLevel = LogLevel.None;\n    }\n    Logger.prototype.disable = function () {\n        this.logLevel = LogLevel.None;\n    };\n    Logger.prototype.enable = function (logLevel) {\n        if (logLevel === void 0) { logLevel = LogLevel.Warn; }\n        this.logLevel = logLevel;\n    };\n    Logger.prototype.log = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Verbose) {\n            return;\n        }\n        console.log(\"\".concat(PREFIX, \"[Log]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.warn = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Warn) {\n            return;\n        }\n        console.warn(\"\".concat(PREFIX, \"[Warn]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.error = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Error) {\n            return;\n        }\n        console.error(\"\".concat(PREFIX, \"[Error]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.debug = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Debug) {\n            return;\n        }\n        // console.debug output is hidden by default in chrome\n        console.log(\"\".concat(PREFIX, \"[Debug]: \").concat(args.join(' ')));\n    };\n    return Logger;\n}());\nexport { Logger };\n//# sourceMappingURL=logger.js.map","import { AMPLITUDE_SERVER_URL, AMPLITUDE_BATCH_SERVER_URL, EU_AMPLITUDE_SERVER_URL, EU_AMPLITUDE_BATCH_SERVER_URL, } from './types/constants';\nimport { Logger } from './logger';\nimport { LogLevel } from './types/loglevel';\nexport var getDefaultConfig = function () { return ({\n    flushMaxRetries: 12,\n    flushQueueSize: 200,\n    flushIntervalMillis: 10000,\n    instanceName: '$default_instance',\n    logLevel: LogLevel.Warn,\n    loggerProvider: new Logger(),\n    offline: false,\n    optOut: false,\n    serverUrl: AMPLITUDE_SERVER_URL,\n    serverZone: 'US',\n    useBatch: false,\n}); };\nvar Config = /** @class */ (function () {\n    function Config(options) {\n        var _a, _b, _c, _d;\n        this._optOut = false;\n        var defaultConfig = getDefaultConfig();\n        this.apiKey = options.apiKey;\n        this.flushIntervalMillis = (_a = options.flushIntervalMillis) !== null && _a !== void 0 ? _a : defaultConfig.flushIntervalMillis;\n        this.flushMaxRetries = options.flushMaxRetries || defaultConfig.flushMaxRetries;\n        this.flushQueueSize = options.flushQueueSize || defaultConfig.flushQueueSize;\n        this.instanceName = options.instanceName || defaultConfig.instanceName;\n        this.loggerProvider = options.loggerProvider || defaultConfig.loggerProvider;\n        this.logLevel = (_b = options.logLevel) !== null && _b !== void 0 ? _b : defaultConfig.logLevel;\n        this.minIdLength = options.minIdLength;\n        this.plan = options.plan;\n        this.ingestionMetadata = options.ingestionMetadata;\n        this.offline = options.offline !== undefined ? options.offline : defaultConfig.offline;\n        this.optOut = (_c = options.optOut) !== null && _c !== void 0 ? _c : defaultConfig.optOut;\n        this.serverUrl = options.serverUrl;\n        this.serverZone = options.serverZone || defaultConfig.serverZone;\n        this.storageProvider = options.storageProvider;\n        this.transportProvider = options.transportProvider;\n        this.useBatch = (_d = options.useBatch) !== null && _d !== void 0 ? _d : defaultConfig.useBatch;\n        this.loggerProvider.enable(this.logLevel);\n        var serverConfig = createServerConfig(options.serverUrl, options.serverZone, options.useBatch);\n        this.serverZone = serverConfig.serverZone;\n        this.serverUrl = serverConfig.serverUrl;\n    }\n    Object.defineProperty(Config.prototype, \"optOut\", {\n        get: function () {\n            return this._optOut;\n        },\n        set: function (optOut) {\n            this._optOut = optOut;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Config;\n}());\nexport { Config };\nexport var getServerUrl = function (serverZone, useBatch) {\n    if (serverZone === 'EU') {\n        return useBatch ? EU_AMPLITUDE_BATCH_SERVER_URL : EU_AMPLITUDE_SERVER_URL;\n    }\n    return useBatch ? AMPLITUDE_BATCH_SERVER_URL : AMPLITUDE_SERVER_URL;\n};\nexport var createServerConfig = function (serverUrl, serverZone, useBatch) {\n    if (serverUrl === void 0) { serverUrl = ''; }\n    if (serverZone === void 0) { serverZone = getDefaultConfig().serverZone; }\n    if (useBatch === void 0) { useBatch = getDefaultConfig().useBatch; }\n    if (serverUrl) {\n        return { serverUrl: serverUrl, serverZone: undefined };\n    }\n    var _serverZone = ['US', 'EU'].includes(serverZone) ? serverZone : getDefaultConfig().serverZone;\n    return {\n        serverZone: _serverZone,\n        serverUrl: getServerUrl(_serverZone, useBatch),\n    };\n};\nvar RequestMetadata = /** @class */ (function () {\n    function RequestMetadata() {\n        this.sdk = {\n            metrics: {\n                histogram: {},\n            },\n        };\n    }\n    RequestMetadata.prototype.recordHistogram = function (key, value) {\n        this.sdk.metrics.histogram[key] = value;\n    };\n    return RequestMetadata;\n}());\nexport { RequestMetadata };\nvar HistogramOptions = /** @class */ (function () {\n    function HistogramOptions() {\n    }\n    return HistogramOptions;\n}());\n//# sourceMappingURL=config.js.map","import { __awaiter, __generator, __read, __rest, __spreadArray } from \"tslib\";\nimport { Status } from '../types/status';\nimport { INVALID_API_KEY, MAX_RETRIES_EXCEEDED_MESSAGE, MISSING_API_KEY_MESSAGE, SUCCESS_MESSAGE, UNEXPECTED_ERROR_MESSAGE, } from '../types/messages';\nimport { STORAGE_PREFIX } from '../types/constants';\nimport { chunk } from '../utils/chunk';\nimport { buildResult } from '../utils/result-builder';\nimport { createServerConfig, RequestMetadata } from '../config';\nimport { UUID } from '../utils/uuid';\nfunction getErrorMessage(error) {\n    if (error instanceof Error)\n        return error.message;\n    return String(error);\n}\nexport function getResponseBodyString(res) {\n    var responseBodyString = '';\n    try {\n        if ('body' in res) {\n            responseBodyString = JSON.stringify(res.body, null, 2);\n        }\n    }\n    catch (_a) {\n        // to avoid crash, but don't care about the error, add comment to avoid empty block lint error\n    }\n    return responseBodyString;\n}\nvar Destination = /** @class */ (function () {\n    function Destination() {\n        this.name = 'amplitude';\n        this.type = 'destination';\n        this.retryTimeout = 1000;\n        this.throttleTimeout = 30000;\n        this.storageKey = '';\n        // Indicator of whether events that are scheduled (but not flushed yet).\n        // When flush:\n        //   1. assign `scheduleId` to `flushId`\n        //   2. set `scheduleId` to null\n        this.scheduleId = null;\n        // Timeout in milliseconds of current schedule\n        this.scheduledTimeout = 0;\n        // Indicator of whether current flush resolves.\n        // When flush resolves, set `flushId` to null\n        this.flushId = null;\n        this.queue = [];\n    }\n    Destination.prototype.setup = function (config) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var unsent;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.config = config;\n                        this.storageKey = \"\".concat(STORAGE_PREFIX, \"_\").concat(this.config.apiKey.substring(0, 10));\n                        return [4 /*yield*/, ((_a = this.config.storageProvider) === null || _a === void 0 ? void 0 : _a.get(this.storageKey))];\n                    case 1:\n                        unsent = _b.sent();\n                        if (unsent && unsent.length > 0) {\n                            void Promise.all(unsent.map(function (event) { return _this.execute(event); })).catch();\n                        }\n                        return [2 /*return*/, Promise.resolve(undefined)];\n                }\n            });\n        });\n    };\n    Destination.prototype.execute = function (event) {\n        var _this = this;\n        // Assign insert_id for dropping invalid event later\n        if (!event.insert_id) {\n            event.insert_id = UUID();\n        }\n        return new Promise(function (resolve) {\n            var context = {\n                event: event,\n                attempts: 0,\n                callback: function (result) { return resolve(result); },\n                timeout: 0,\n            };\n            _this.queue.push(context);\n            _this.schedule(_this.config.flushIntervalMillis);\n            _this.saveEvents();\n        });\n    };\n    Destination.prototype.removeEventsExceedFlushMaxRetries = function (list) {\n        var _this = this;\n        return list.filter(function (context) {\n            context.attempts += 1;\n            if (context.attempts < _this.config.flushMaxRetries) {\n                return true;\n            }\n            void _this.fulfillRequest([context], 500, MAX_RETRIES_EXCEEDED_MESSAGE);\n            return false;\n        });\n    };\n    Destination.prototype.scheduleEvents = function (list) {\n        var _this = this;\n        list.forEach(function (context) {\n            _this.schedule(context.timeout === 0 ? _this.config.flushIntervalMillis : context.timeout);\n        });\n    };\n    // Schedule a flush in timeout when\n    // 1. No schedule\n    // 2. Timeout greater than existing timeout.\n    // This makes sure that when throttled, no flush when throttle timeout expires.\n    Destination.prototype.schedule = function (timeout) {\n        var _this = this;\n        if (this.config.offline) {\n            return;\n        }\n        if (this.scheduleId === null || (this.scheduleId && timeout > this.scheduledTimeout)) {\n            if (this.scheduleId) {\n                clearTimeout(this.scheduleId);\n            }\n            this.scheduledTimeout = timeout;\n            this.scheduleId = setTimeout(function () {\n                _this.queue = _this.queue.map(function (context) {\n                    context.timeout = 0;\n                    return context;\n                });\n                void _this.flush(true);\n            }, timeout);\n            return;\n        }\n    };\n    // Mark current schedule is flushed.\n    Destination.prototype.resetSchedule = function () {\n        this.scheduleId = null;\n        this.scheduledTimeout = 0;\n    };\n    // Flush all events regardless of their timeout\n    Destination.prototype.flush = function (useRetry) {\n        if (useRetry === void 0) { useRetry = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var list, later, batches;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // Skip flush if offline\n                        if (this.config.offline) {\n                            this.resetSchedule();\n                            this.config.loggerProvider.debug('Skipping flush while offline.');\n                            return [2 /*return*/];\n                        }\n                        if (this.flushId) {\n                            this.resetSchedule();\n                            this.config.loggerProvider.debug('Skipping flush because previous flush has not resolved.');\n                            return [2 /*return*/];\n                        }\n                        this.flushId = this.scheduleId;\n                        this.resetSchedule();\n                        list = [];\n                        later = [];\n                        this.queue.forEach(function (context) { return (context.timeout === 0 ? list.push(context) : later.push(context)); });\n                        batches = chunk(list, this.config.flushQueueSize);\n                        // Promise.all() doesn't guarantee resolve order.\n                        // Sequentially resolve to make sure backend receives events in order\n                        return [4 /*yield*/, batches.reduce(function (promise, batch) { return __awaiter(_this, void 0, void 0, function () {\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, promise];\n                                        case 1:\n                                            _a.sent();\n                                            return [4 /*yield*/, this.send(batch, useRetry)];\n                                        case 2: return [2 /*return*/, _a.sent()];\n                                    }\n                                });\n                            }); }, Promise.resolve())];\n                    case 1:\n                        // Promise.all() doesn't guarantee resolve order.\n                        // Sequentially resolve to make sure backend receives events in order\n                        _a.sent();\n                        // Mark current flush is done\n                        this.flushId = null;\n                        this.scheduleEvents(this.queue);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Destination.prototype.send = function (list, useRetry) {\n        if (useRetry === void 0) { useRetry = true; }\n        return __awaiter(this, void 0, void 0, function () {\n            var payload, serverUrl, res, e_1, errorMessage;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.config.apiKey) {\n                            return [2 /*return*/, this.fulfillRequest(list, 400, MISSING_API_KEY_MESSAGE)];\n                        }\n                        payload = {\n                            api_key: this.config.apiKey,\n                            events: list.map(function (context) {\n                                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                var _a = context.event, extra = _a.extra, eventWithoutExtra = __rest(_a, [\"extra\"]);\n                                return eventWithoutExtra;\n                            }),\n                            options: {\n                                min_id_length: this.config.minIdLength,\n                            },\n                            client_upload_time: new Date().toISOString(),\n                            request_metadata: this.config.requestMetadata,\n                        };\n                        this.config.requestMetadata = new RequestMetadata();\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        serverUrl = createServerConfig(this.config.serverUrl, this.config.serverZone, this.config.useBatch).serverUrl;\n                        return [4 /*yield*/, this.config.transportProvider.send(serverUrl, payload)];\n                    case 2:\n                        res = _a.sent();\n                        if (res === null) {\n                            this.fulfillRequest(list, 0, UNEXPECTED_ERROR_MESSAGE);\n                            return [2 /*return*/];\n                        }\n                        if (!useRetry) {\n                            if ('body' in res) {\n                                this.fulfillRequest(list, res.statusCode, \"\".concat(res.status, \": \").concat(getResponseBodyString(res)));\n                            }\n                            else {\n                                this.fulfillRequest(list, res.statusCode, res.status);\n                            }\n                            return [2 /*return*/];\n                        }\n                        this.handleResponse(res, list);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        errorMessage = getErrorMessage(e_1);\n                        this.config.loggerProvider.error(errorMessage);\n                        this.handleResponse({ status: Status.Failed, statusCode: 0 }, list);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Destination.prototype.handleResponse = function (res, list) {\n        var status = res.status;\n        switch (status) {\n            case Status.Success: {\n                this.handleSuccessResponse(res, list);\n                break;\n            }\n            case Status.Invalid: {\n                this.handleInvalidResponse(res, list);\n                break;\n            }\n            case Status.PayloadTooLarge: {\n                this.handlePayloadTooLargeResponse(res, list);\n                break;\n            }\n            case Status.RateLimit: {\n                this.handleRateLimitResponse(res, list);\n                break;\n            }\n            default: {\n                // log intermediate event status before retry\n                this.config.loggerProvider.warn(\"{code: 0, error: \\\"Status '\".concat(status, \"' provided for \").concat(list.length, \" events\\\"}\"));\n                this.handleOtherResponse(list);\n                break;\n            }\n        }\n    };\n    Destination.prototype.handleSuccessResponse = function (res, list) {\n        this.fulfillRequest(list, res.statusCode, SUCCESS_MESSAGE);\n    };\n    Destination.prototype.handleInvalidResponse = function (res, list) {\n        var _this = this;\n        if (res.body.missingField || res.body.error.startsWith(INVALID_API_KEY)) {\n            this.fulfillRequest(list, res.statusCode, res.body.error);\n            return;\n        }\n        var dropIndex = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(Object.values(res.body.eventsWithInvalidFields)), false), __read(Object.values(res.body.eventsWithMissingFields)), false), __read(Object.values(res.body.eventsWithInvalidIdLengths)), false), __read(res.body.silencedEvents), false).flat();\n        var dropIndexSet = new Set(dropIndex);\n        var retry = list.filter(function (context, index) {\n            if (dropIndexSet.has(index)) {\n                _this.fulfillRequest([context], res.statusCode, res.body.error);\n                return;\n            }\n            return true;\n        });\n        if (retry.length > 0) {\n            // log intermediate event status before retry\n            this.config.loggerProvider.warn(getResponseBodyString(res));\n        }\n        var tryable = this.removeEventsExceedFlushMaxRetries(retry);\n        this.scheduleEvents(tryable);\n    };\n    Destination.prototype.handlePayloadTooLargeResponse = function (res, list) {\n        if (list.length === 1) {\n            this.fulfillRequest(list, res.statusCode, res.body.error);\n            return;\n        }\n        // log intermediate event status before retry\n        this.config.loggerProvider.warn(getResponseBodyString(res));\n        this.config.flushQueueSize /= 2;\n        var tryable = this.removeEventsExceedFlushMaxRetries(list);\n        this.scheduleEvents(tryable);\n    };\n    Destination.prototype.handleRateLimitResponse = function (res, list) {\n        var _this = this;\n        var dropUserIds = Object.keys(res.body.exceededDailyQuotaUsers);\n        var dropDeviceIds = Object.keys(res.body.exceededDailyQuotaDevices);\n        var throttledIndex = res.body.throttledEvents;\n        var dropUserIdsSet = new Set(dropUserIds);\n        var dropDeviceIdsSet = new Set(dropDeviceIds);\n        var throttledIndexSet = new Set(throttledIndex);\n        var retry = list.filter(function (context, index) {\n            if ((context.event.user_id && dropUserIdsSet.has(context.event.user_id)) ||\n                (context.event.device_id && dropDeviceIdsSet.has(context.event.device_id))) {\n                _this.fulfillRequest([context], res.statusCode, res.body.error);\n                return;\n            }\n            if (throttledIndexSet.has(index)) {\n                context.timeout = _this.throttleTimeout;\n            }\n            return true;\n        });\n        if (retry.length > 0) {\n            // log intermediate event status before retry\n            this.config.loggerProvider.warn(getResponseBodyString(res));\n        }\n        var tryable = this.removeEventsExceedFlushMaxRetries(retry);\n        this.scheduleEvents(tryable);\n    };\n    Destination.prototype.handleOtherResponse = function (list) {\n        var _this = this;\n        var later = list.map(function (context) {\n            context.timeout = context.attempts * _this.retryTimeout;\n            return context;\n        });\n        var tryable = this.removeEventsExceedFlushMaxRetries(later);\n        this.scheduleEvents(tryable);\n    };\n    Destination.prototype.fulfillRequest = function (list, code, message) {\n        this.removeEvents(list);\n        list.forEach(function (context) { return context.callback(buildResult(context.event, code, message)); });\n    };\n    /**\n     * This is called on\n     * 1) new events are added to queue; or\n     * 2) response comes back for a request\n     *\n     * Update the event storage based on the queue\n     */\n    Destination.prototype.saveEvents = function () {\n        if (!this.config.storageProvider) {\n            return;\n        }\n        var updatedEvents = this.queue.map(function (context) { return context.event; });\n        void this.config.storageProvider.set(this.storageKey, updatedEvents);\n    };\n    /**\n     * This is called on response comes back for a request\n     */\n    Destination.prototype.removeEvents = function (eventsToRemove) {\n        this.queue = this.queue.filter(function (queuedContext) { return !eventsToRemove.some(function (context) { return context.event.insert_id === queuedContext.event.insert_id; }); });\n        this.saveEvents();\n    };\n    return Destination;\n}());\nexport { Destination };\n//# sourceMappingURL=destination.js.map","var ApplicationContextProviderImpl = /** @class */ (function () {\n    function ApplicationContextProviderImpl() {\n    }\n    ApplicationContextProviderImpl.prototype.getApplicationContext = function () {\n        return {\n            versionName: this.versionName,\n            language: getLanguage(),\n            platform: 'Web',\n            os: undefined,\n            deviceModel: undefined,\n        };\n    };\n    return ApplicationContextProviderImpl;\n}());\nvar getLanguage = function () {\n    return ((typeof navigator !== 'undefined' &&\n        ((navigator.languages && navigator.languages[0]) ||\n            navigator.language)) ||\n        '');\n};\n\nvar EventBridgeImpl = /** @class */ (function () {\n    function EventBridgeImpl() {\n        this.queue = [];\n    }\n    EventBridgeImpl.prototype.logEvent = function (event) {\n        if (!this.receiver) {\n            if (this.queue.length < 512) {\n                this.queue.push(event);\n            }\n        }\n        else {\n            this.receiver(event);\n        }\n    };\n    EventBridgeImpl.prototype.setEventReceiver = function (receiver) {\n        this.receiver = receiver;\n        if (this.queue.length > 0) {\n            this.queue.forEach(function (event) {\n                receiver(event);\n            });\n            this.queue = [];\n        }\n    };\n    return EventBridgeImpl;\n}());\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nfunction __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n}\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar isEqual = function (obj1, obj2) {\n    var e_1, _a;\n    var primitive = ['string', 'number', 'boolean', 'undefined'];\n    var typeA = typeof obj1;\n    var typeB = typeof obj2;\n    if (typeA !== typeB) {\n        return false;\n    }\n    try {\n        for (var primitive_1 = __values(primitive), primitive_1_1 = primitive_1.next(); !primitive_1_1.done; primitive_1_1 = primitive_1.next()) {\n            var p = primitive_1_1.value;\n            if (p === typeA) {\n                return obj1 === obj2;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (primitive_1_1 && !primitive_1_1.done && (_a = primitive_1.return)) _a.call(primitive_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    // check null\n    if (obj1 == null && obj2 == null) {\n        return true;\n    }\n    else if (obj1 == null || obj2 == null) {\n        return false;\n    }\n    // if got here - objects\n    if (obj1.length !== obj2.length) {\n        return false;\n    }\n    //check if arrays\n    var isArrayA = Array.isArray(obj1);\n    var isArrayB = Array.isArray(obj2);\n    if (isArrayA !== isArrayB) {\n        return false;\n    }\n    if (isArrayA && isArrayB) {\n        //arrays\n        for (var i = 0; i < obj1.length; i++) {\n            if (!isEqual(obj1[i], obj2[i])) {\n                return false;\n            }\n        }\n    }\n    else {\n        //objects\n        var sorted1 = Object.keys(obj1).sort();\n        var sorted2 = Object.keys(obj2).sort();\n        if (!isEqual(sorted1, sorted2)) {\n            return false;\n        }\n        //compare object values\n        var result_1 = true;\n        Object.keys(obj1).forEach(function (key) {\n            if (!isEqual(obj1[key], obj2[key])) {\n                result_1 = false;\n            }\n        });\n        return result_1;\n    }\n    return true;\n};\n\nvar ID_OP_SET = '$set';\nvar ID_OP_UNSET = '$unset';\nvar ID_OP_CLEAR_ALL = '$clearAll';\n// Polyfill for Object.entries\nif (!Object.entries) {\n    Object.entries = function (obj) {\n        var ownProps = Object.keys(obj);\n        var i = ownProps.length;\n        var resArray = new Array(i);\n        while (i--) {\n            resArray[i] = [ownProps[i], obj[ownProps[i]]];\n        }\n        return resArray;\n    };\n}\nvar IdentityStoreImpl = /** @class */ (function () {\n    function IdentityStoreImpl() {\n        this.identity = { userProperties: {} };\n        this.listeners = new Set();\n    }\n    IdentityStoreImpl.prototype.editIdentity = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var self = this;\n        var actingUserProperties = __assign({}, this.identity.userProperties);\n        var actingIdentity = __assign(__assign({}, this.identity), { userProperties: actingUserProperties });\n        return {\n            setUserId: function (userId) {\n                actingIdentity.userId = userId;\n                return this;\n            },\n            setDeviceId: function (deviceId) {\n                actingIdentity.deviceId = deviceId;\n                return this;\n            },\n            setUserProperties: function (userProperties) {\n                actingIdentity.userProperties = userProperties;\n                return this;\n            },\n            setOptOut: function (optOut) {\n                actingIdentity.optOut = optOut;\n                return this;\n            },\n            updateUserProperties: function (actions) {\n                var e_1, _a, e_2, _b, e_3, _c;\n                var actingProperties = actingIdentity.userProperties || {};\n                try {\n                    for (var _d = __values(Object.entries(actions)), _e = _d.next(); !_e.done; _e = _d.next()) {\n                        var _f = __read(_e.value, 2), action = _f[0], properties = _f[1];\n                        switch (action) {\n                            case ID_OP_SET:\n                                try {\n                                    for (var _g = (e_2 = void 0, __values(Object.entries(properties))), _h = _g.next(); !_h.done; _h = _g.next()) {\n                                        var _j = __read(_h.value, 2), key = _j[0], value = _j[1];\n                                        actingProperties[key] = value;\n                                    }\n                                }\n                                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                                finally {\n                                    try {\n                                        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n                                    }\n                                    finally { if (e_2) throw e_2.error; }\n                                }\n                                break;\n                            case ID_OP_UNSET:\n                                try {\n                                    for (var _k = (e_3 = void 0, __values(Object.keys(properties))), _l = _k.next(); !_l.done; _l = _k.next()) {\n                                        var key = _l.value;\n                                        delete actingProperties[key];\n                                    }\n                                }\n                                catch (e_3_1) { e_3 = { error: e_3_1 }; }\n                                finally {\n                                    try {\n                                        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n                                    }\n                                    finally { if (e_3) throw e_3.error; }\n                                }\n                                break;\n                            case ID_OP_CLEAR_ALL:\n                                actingProperties = {};\n                                break;\n                        }\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (_e && !_e.done && (_a = _d.return)) _a.call(_d);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n                actingIdentity.userProperties = actingProperties;\n                return this;\n            },\n            commit: function () {\n                self.setIdentity(actingIdentity);\n                return this;\n            },\n        };\n    };\n    IdentityStoreImpl.prototype.getIdentity = function () {\n        return __assign({}, this.identity);\n    };\n    IdentityStoreImpl.prototype.setIdentity = function (identity) {\n        var originalIdentity = __assign({}, this.identity);\n        this.identity = __assign({}, identity);\n        if (!isEqual(originalIdentity, this.identity)) {\n            this.listeners.forEach(function (listener) {\n                listener(identity);\n            });\n        }\n    };\n    IdentityStoreImpl.prototype.addIdentityListener = function (listener) {\n        this.listeners.add(listener);\n    };\n    IdentityStoreImpl.prototype.removeIdentityListener = function (listener) {\n        this.listeners.delete(listener);\n    };\n    return IdentityStoreImpl;\n}());\n\nvar safeGlobal = typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof global !== 'undefined'\n        ? global\n        : self;\n\nvar AnalyticsConnector = /** @class */ (function () {\n    function AnalyticsConnector() {\n        this.identityStore = new IdentityStoreImpl();\n        this.eventBridge = new EventBridgeImpl();\n        this.applicationContextProvider = new ApplicationContextProviderImpl();\n    }\n    AnalyticsConnector.getInstance = function (instanceName) {\n        if (!safeGlobal['analyticsConnectorInstances']) {\n            safeGlobal['analyticsConnectorInstances'] = {};\n        }\n        if (!safeGlobal['analyticsConnectorInstances'][instanceName]) {\n            safeGlobal['analyticsConnectorInstances'][instanceName] =\n                new AnalyticsConnector();\n        }\n        return safeGlobal['analyticsConnectorInstances'][instanceName];\n    };\n    return AnalyticsConnector;\n}());\n\nexport { AnalyticsConnector };\n","/**\n * @deprecated use ServerZoneType instead\n */\nexport var ServerZone;\n(function (ServerZone) {\n    ServerZone[\"US\"] = \"US\";\n    ServerZone[\"EU\"] = \"EU\";\n    /**\n     * Add for session-replay-browser migration from analytics-type v1.x.\n     */\n    ServerZone[\"STAGING\"] = \"STAGING\";\n})(ServerZone || (ServerZone = {}));\n//# sourceMappingURL=server-zone.js.map","import { AnalyticsConnector } from '@amplitude/analytics-connector';\nexport var getAnalyticsConnector = function (instanceName) {\n    if (instanceName === void 0) { instanceName = '$default_instance'; }\n    return AnalyticsConnector.getInstance(instanceName);\n};\nexport var setConnectorUserId = function (userId, instanceName) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    getAnalyticsConnector(instanceName).identityStore.editIdentity().setUserId(userId).commit();\n};\nexport var setConnectorDeviceId = function (deviceId, instanceName) {\n    getAnalyticsConnector(instanceName).identityStore.editIdentity().setDeviceId(deviceId).commit();\n};\n//# sourceMappingURL=analytics-connector.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { getAnalyticsConnector } from '../analytics-connector';\nvar IdentityEventSender = /** @class */ (function () {\n    function IdentityEventSender() {\n        this.name = 'identity';\n        this.type = 'before';\n        this.identityStore = getAnalyticsConnector().identityStore;\n    }\n    IdentityEventSender.prototype.execute = function (context) {\n        return __awaiter(this, void 0, void 0, function () {\n            var userProperties;\n            return __generator(this, function (_a) {\n                userProperties = context.user_properties;\n                if (userProperties) {\n                    this.identityStore.editIdentity().updateUserProperties(userProperties).commit();\n                }\n                return [2 /*return*/, context];\n            });\n        });\n    };\n    IdentityEventSender.prototype.setup = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (config.instanceName) {\n                    this.identityStore = getAnalyticsConnector(config.instanceName).identityStore;\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    return IdentityEventSender;\n}());\nexport { IdentityEventSender };\n//# sourceMappingURL=identity.js.map","export var isNewSession = function (sessionTimeout, lastEventTime) {\n    if (lastEventTime === void 0) { lastEventTime = Date.now(); }\n    var currentTime = Date.now();\n    var timeSinceLastEvent = currentTime - lastEventTime;\n    return timeSinceLastEvent > sessionTimeout;\n};\n//# sourceMappingURL=session.js.map","import { AMPLITUDE_PREFIX } from './types/constants';\nexport var getCookieName = function (apiKey, postKey, limit) {\n    if (postKey === void 0) { postKey = ''; }\n    if (limit === void 0) { limit = 10; }\n    return [AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');\n};\nexport var getOldCookieName = function (apiKey) {\n    return \"\".concat(AMPLITUDE_PREFIX.toLowerCase(), \"_\").concat(apiKey.substring(0, 6));\n};\n//# sourceMappingURL=cookie-name.js.map","export var getLanguage = function () {\n    var _a, _b, _c, _d;\n    if (typeof navigator === 'undefined')\n        return '';\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    var userLanguage = navigator.userLanguage;\n    return (_d = (_c = (_b = (_a = navigator.languages) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : navigator.language) !== null && _c !== void 0 ? _c : userLanguage) !== null && _d !== void 0 ? _d : '';\n};\n//# sourceMappingURL=language.js.map","import { getGlobalScope } from './global-scope';\nexport var getQueryParams = function () {\n    var _a;\n    var globalScope = getGlobalScope();\n    /* istanbul ignore if */\n    if (!((_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.location) === null || _a === void 0 ? void 0 : _a.search)) {\n        return {};\n    }\n    var pairs = globalScope.location.search.substring(1).split('&').filter(Boolean);\n    var params = pairs.reduce(function (acc, curr) {\n        var query = curr.split('=', 2);\n        var key = tryDecodeURIComponent(query[0]);\n        var value = tryDecodeURIComponent(query[1]);\n        if (!value) {\n            return acc;\n        }\n        acc[key] = value;\n        return acc;\n    }, {});\n    return params;\n};\nexport var tryDecodeURIComponent = function (value) {\n    if (value === void 0) { value = ''; }\n    try {\n        return decodeURIComponent(value);\n    }\n    catch (_a) {\n        return '';\n    }\n};\n//# sourceMappingURL=query-params.js.map","import { __assign, __values } from \"tslib\";\nimport { LogLevel } from '../types/loglevel';\nexport var getStacktrace = function (ignoreDepth) {\n    if (ignoreDepth === void 0) { ignoreDepth = 0; }\n    var trace = new Error().stack || '';\n    return trace\n        .split('\\n')\n        .slice(2 + ignoreDepth)\n        .map(function (text) { return text.trim(); });\n};\n// This hook makes sure we always get the latest logger and logLevel.\nexport var getClientLogConfig = function (client) { return function () {\n    var _a = __assign({}, client.config), logger = _a.loggerProvider, logLevel = _a.logLevel;\n    return {\n        logger: logger,\n        logLevel: logLevel,\n    };\n}; };\n// This is a convenient function to get the attribute from object with string path, similar to lodash '#get'.\nexport var getValueByStringPath = function (obj, path) {\n    var e_1, _a;\n    path = path.replace(/\\[(\\w+)\\]/g, '.$1'); // convert indexes to properties\n    path = path.replace(/^\\./, ''); // strip a leading dot\n    try {\n        for (var _b = __values(path.split('.')), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var attr = _c.value;\n            if (attr in obj) {\n                obj = obj[attr];\n            }\n            else {\n                return;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return obj;\n};\nexport var getClientStates = function (client, paths) { return function () {\n    var e_2, _a;\n    var res = {};\n    try {\n        for (var paths_1 = __values(paths), paths_1_1 = paths_1.next(); !paths_1_1.done; paths_1_1 = paths_1.next()) {\n            var path = paths_1_1.value;\n            res[path] = getValueByStringPath(client, path);\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (paths_1_1 && !paths_1_1.done && (_a = paths_1.return)) _a.call(paths_1);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return res;\n}; };\nexport var debugWrapper = function (fn, fnName, getLogConfig, getStates, fnContext) {\n    if (fnContext === void 0) { fnContext = null; }\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var _a = getLogConfig(), logger = _a.logger, logLevel = _a.logLevel;\n        // return early if possible to reduce overhead\n        if ((logLevel && logLevel < LogLevel.Debug) || !logLevel || !logger) {\n            return fn.apply(fnContext, args);\n        }\n        var debugContext = {\n            type: 'invoke public method',\n            name: fnName,\n            args: args,\n            stacktrace: getStacktrace(1),\n            time: {\n                start: new Date().toISOString(),\n            },\n            states: {},\n        };\n        if (getStates && debugContext.states) {\n            debugContext.states.before = getStates();\n        }\n        var result = fn.apply(fnContext, args);\n        if (result && result.promise) {\n            // if result is a promise, add the callback\n            result.promise.then(function () {\n                if (getStates && debugContext.states) {\n                    debugContext.states.after = getStates();\n                }\n                if (debugContext.time) {\n                    debugContext.time.end = new Date().toISOString();\n                }\n                logger.debug(JSON.stringify(debugContext, null, 2));\n            });\n        }\n        else {\n            if (getStates && debugContext.states) {\n                debugContext.states.after = getStates();\n            }\n            if (debugContext.time) {\n                debugContext.time.end = new Date().toISOString();\n            }\n            logger.debug(JSON.stringify(debugContext, null, 2));\n        }\n        return result;\n    };\n};\n//# sourceMappingURL=debug.js.map","import { __awaiter, __generator } from \"tslib\";\nvar MemoryStorage = /** @class */ (function () {\n    function MemoryStorage() {\n        this.memoryStorage = new Map();\n    }\n    MemoryStorage.prototype.isEnabled = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, true];\n            });\n        });\n    };\n    MemoryStorage.prototype.get = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.memoryStorage.get(key)];\n            });\n        });\n    };\n    MemoryStorage.prototype.getRaw = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            var value;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.get(key)];\n                    case 1:\n                        value = _a.sent();\n                        return [2 /*return*/, value ? JSON.stringify(value) : undefined];\n                }\n            });\n        });\n    };\n    MemoryStorage.prototype.set = function (key, value) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.set(key, value);\n                return [2 /*return*/];\n            });\n        });\n    };\n    MemoryStorage.prototype.remove = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.delete(key);\n                return [2 /*return*/];\n            });\n        });\n    };\n    MemoryStorage.prototype.reset = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.clear();\n                return [2 /*return*/];\n            });\n        });\n    };\n    return MemoryStorage;\n}());\nexport { MemoryStorage };\n//# sourceMappingURL=memory.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { getGlobalScope } from '../global-scope';\nvar CookieStorage = /** @class */ (function () {\n    function CookieStorage(options) {\n        this.options = __assign({}, options);\n    }\n    CookieStorage.prototype.isEnabled = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var testStrorage, testKey, value, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        /* istanbul ignore if */\n                        if (!getGlobalScope()) {\n                            return [2 /*return*/, false];\n                        }\n                        CookieStorage.testValue = String(Date.now());\n                        testStrorage = new CookieStorage(this.options);\n                        testKey = 'AMP_TEST';\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, 5, 7]);\n                        return [4 /*yield*/, testStrorage.set(testKey, CookieStorage.testValue)];\n                    case 2:\n                        _b.sent();\n                        return [4 /*yield*/, testStrorage.get(testKey)];\n                    case 3:\n                        value = _b.sent();\n                        return [2 /*return*/, value === CookieStorage.testValue];\n                    case 4:\n                        _a = _b.sent();\n                        /* istanbul ignore next */\n                        return [2 /*return*/, false];\n                    case 5: return [4 /*yield*/, testStrorage.remove(testKey)];\n                    case 6:\n                        _b.sent();\n                        return [7 /*endfinally*/];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.get = function (key) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var value, decodedValue;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.getRaw(key)];\n                    case 1:\n                        value = _b.sent();\n                        if (!value) {\n                            return [2 /*return*/, undefined];\n                        }\n                        try {\n                            decodedValue = (_a = decodeCookiesAsDefault(value)) !== null && _a !== void 0 ? _a : decodeCookiesWithDoubleUrlEncoding(value);\n                            if (decodedValue === undefined) {\n                                console.error(\"Amplitude Logger [Error]: Failed to decode cookie value for key: \".concat(key, \", value: \").concat(value));\n                                return [2 /*return*/, undefined];\n                            }\n                            // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n                            return [2 /*return*/, JSON.parse(decodedValue)];\n                        }\n                        catch (_c) {\n                            console.error(\"Amplitude Logger [Error]: Failed to parse cookie value for key: \".concat(key, \", value: \").concat(value));\n                            return [2 /*return*/, undefined];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.getRaw = function (key) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var globalScope, cookie, match;\n            return __generator(this, function (_c) {\n                globalScope = getGlobalScope();\n                cookie = (_b = (_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.document) === null || _a === void 0 ? void 0 : _a.cookie.split('; ')) !== null && _b !== void 0 ? _b : [];\n                match = cookie.find(function (c) { return c.indexOf(key + '=') === 0; });\n                if (!match) {\n                    return [2 /*return*/, undefined];\n                }\n                return [2 /*return*/, match.substring(key.length + 1)];\n            });\n        });\n    };\n    CookieStorage.prototype.set = function (key, value) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var expirationDays, expires, expireDate, date, str, globalScope, errorMessage;\n            return __generator(this, function (_b) {\n                try {\n                    expirationDays = (_a = this.options.expirationDays) !== null && _a !== void 0 ? _a : 0;\n                    expires = value !== null ? expirationDays : -1;\n                    expireDate = undefined;\n                    if (expires) {\n                        date = new Date();\n                        date.setTime(date.getTime() + expires * 24 * 60 * 60 * 1000);\n                        expireDate = date;\n                    }\n                    str = \"\".concat(key, \"=\").concat(btoa(encodeURIComponent(JSON.stringify(value))));\n                    if (expireDate) {\n                        str += \"; expires=\".concat(expireDate.toUTCString());\n                    }\n                    str += '; path=/';\n                    if (this.options.domain) {\n                        str += \"; domain=\".concat(this.options.domain);\n                    }\n                    if (this.options.secure) {\n                        str += '; Secure';\n                    }\n                    if (this.options.sameSite) {\n                        str += \"; SameSite=\".concat(this.options.sameSite);\n                    }\n                    globalScope = getGlobalScope();\n                    if (globalScope) {\n                        globalScope.document.cookie = str;\n                    }\n                }\n                catch (error) {\n                    errorMessage = error instanceof Error ? error.message : String(error);\n                    console.error(\"Amplitude Logger [Error]: Failed to set cookie for key: \".concat(key, \". Error: \").concat(errorMessage));\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    CookieStorage.prototype.remove = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.set(key, null)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.reset = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    };\n    return CookieStorage;\n}());\nexport { CookieStorage };\nvar decodeCookiesAsDefault = function (value) {\n    try {\n        return decodeURIComponent(atob(value));\n    }\n    catch (_a) {\n        return undefined;\n    }\n};\nvar decodeCookiesWithDoubleUrlEncoding = function (value) {\n    // Modern Ruby (v7+) automatically encodes cookies with URL encoding by\n    // https://api.rubyonrails.org/classes/ActionDispatch/Cookies.html\n    try {\n        return decodeURIComponent(atob(decodeURIComponent(value)));\n    }\n    catch (_a) {\n        return undefined;\n    }\n};\n//# sourceMappingURL=cookie.js.map","import { Status } from '../types/status';\nvar BaseTransport = /** @class */ (function () {\n    function BaseTransport() {\n    }\n    BaseTransport.prototype.send = function (_serverUrl, _payload) {\n        return Promise.resolve(null);\n    };\n    BaseTransport.prototype.buildResponse = function (responseJSON) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x;\n        if (typeof responseJSON !== 'object') {\n            return null;\n        }\n        var statusCode = responseJSON.code || 0;\n        var status = this.buildStatus(statusCode);\n        switch (status) {\n            case Status.Success:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        eventsIngested: (_a = responseJSON.events_ingested) !== null && _a !== void 0 ? _a : 0,\n                        payloadSizeBytes: (_b = responseJSON.payload_size_bytes) !== null && _b !== void 0 ? _b : 0,\n                        serverUploadTime: (_c = responseJSON.server_upload_time) !== null && _c !== void 0 ? _c : 0,\n                    },\n                };\n            case Status.Invalid:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_d = responseJSON.error) !== null && _d !== void 0 ? _d : '',\n                        missingField: (_e = responseJSON.missing_field) !== null && _e !== void 0 ? _e : '',\n                        eventsWithInvalidFields: (_f = responseJSON.events_with_invalid_fields) !== null && _f !== void 0 ? _f : {},\n                        eventsWithMissingFields: (_g = responseJSON.events_with_missing_fields) !== null && _g !== void 0 ? _g : {},\n                        eventsWithInvalidIdLengths: (_h = responseJSON.events_with_invalid_id_lengths) !== null && _h !== void 0 ? _h : {},\n                        epsThreshold: (_j = responseJSON.eps_threshold) !== null && _j !== void 0 ? _j : 0,\n                        exceededDailyQuotaDevices: (_k = responseJSON.exceeded_daily_quota_devices) !== null && _k !== void 0 ? _k : {},\n                        silencedDevices: (_l = responseJSON.silenced_devices) !== null && _l !== void 0 ? _l : [],\n                        silencedEvents: (_m = responseJSON.silenced_events) !== null && _m !== void 0 ? _m : [],\n                        throttledDevices: (_o = responseJSON.throttled_devices) !== null && _o !== void 0 ? _o : {},\n                        throttledEvents: (_p = responseJSON.throttled_events) !== null && _p !== void 0 ? _p : [],\n                    },\n                };\n            case Status.PayloadTooLarge:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_q = responseJSON.error) !== null && _q !== void 0 ? _q : '',\n                    },\n                };\n            case Status.RateLimit:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_r = responseJSON.error) !== null && _r !== void 0 ? _r : '',\n                        epsThreshold: (_s = responseJSON.eps_threshold) !== null && _s !== void 0 ? _s : 0,\n                        throttledDevices: (_t = responseJSON.throttled_devices) !== null && _t !== void 0 ? _t : {},\n                        throttledUsers: (_u = responseJSON.throttled_users) !== null && _u !== void 0 ? _u : {},\n                        exceededDailyQuotaDevices: (_v = responseJSON.exceeded_daily_quota_devices) !== null && _v !== void 0 ? _v : {},\n                        exceededDailyQuotaUsers: (_w = responseJSON.exceeded_daily_quota_users) !== null && _w !== void 0 ? _w : {},\n                        throttledEvents: (_x = responseJSON.throttled_events) !== null && _x !== void 0 ? _x : [],\n                    },\n                };\n            case Status.Timeout:\n            default:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                };\n        }\n    };\n    BaseTransport.prototype.buildStatus = function (code) {\n        if (code >= 200 && code < 300) {\n            return Status.Success;\n        }\n        if (code === 429) {\n            return Status.RateLimit;\n        }\n        if (code === 413) {\n            return Status.PayloadTooLarge;\n        }\n        if (code === 408) {\n            return Status.Timeout;\n        }\n        if (code >= 400 && code < 500) {\n            return Status.Invalid;\n        }\n        if (code >= 500) {\n            return Status.Failed;\n        }\n        return Status.Unknown;\n    };\n    return BaseTransport;\n}());\nexport { BaseTransport };\n//# sourceMappingURL=base.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\nimport { BaseTransport } from './base';\nvar FetchTransport = /** @class */ (function (_super) {\n    __extends(FetchTransport, _super);\n    function FetchTransport() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FetchTransport.prototype.send = function (serverUrl, payload) {\n        return __awaiter(this, void 0, void 0, function () {\n            var options, response, responseText;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        /* istanbul ignore if */\n                        if (typeof fetch === 'undefined') {\n                            throw new Error('FetchTransport is not supported');\n                        }\n                        options = {\n                            headers: {\n                                'Content-Type': 'application/json',\n                                Accept: '*/*',\n                            },\n                            body: JSON.stringify(payload),\n                            method: 'POST',\n                        };\n                        return [4 /*yield*/, fetch(serverUrl, options)];\n                    case 1:\n                        response = _a.sent();\n                        return [4 /*yield*/, response.text()];\n                    case 2:\n                        responseText = _a.sent();\n                        try {\n                            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                            return [2 /*return*/, this.buildResponse(JSON.parse(responseText))];\n                        }\n                        catch (_b) {\n                            return [2 /*return*/, this.buildResponse({ code: response.status })];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return FetchTransport;\n}(BaseTransport));\nexport { FetchTransport };\n//# sourceMappingURL=fetch.js.map","export var OfflineDisabled = null;\n//# sourceMappingURL=offline.js.map","export var IdentifyOperation;\n(function (IdentifyOperation) {\n    // Base Operations to set values\n    IdentifyOperation[\"SET\"] = \"$set\";\n    IdentifyOperation[\"SET_ONCE\"] = \"$setOnce\";\n    // Operations around modifying existing values\n    IdentifyOperation[\"ADD\"] = \"$add\";\n    IdentifyOperation[\"APPEND\"] = \"$append\";\n    IdentifyOperation[\"PREPEND\"] = \"$prepend\";\n    IdentifyOperation[\"REMOVE\"] = \"$remove\";\n    // Operations around appending values *if* they aren't present\n    IdentifyOperation[\"PREINSERT\"] = \"$preInsert\";\n    IdentifyOperation[\"POSTINSERT\"] = \"$postInsert\";\n    // Operations around removing properties/values\n    IdentifyOperation[\"UNSET\"] = \"$unset\";\n    IdentifyOperation[\"CLEAR_ALL\"] = \"$clearAll\";\n})(IdentifyOperation || (IdentifyOperation = {}));\nexport var RevenueProperty;\n(function (RevenueProperty) {\n    RevenueProperty[\"REVENUE_PRODUCT_ID\"] = \"$productId\";\n    RevenueProperty[\"REVENUE_QUANTITY\"] = \"$quantity\";\n    RevenueProperty[\"REVENUE_PRICE\"] = \"$price\";\n    RevenueProperty[\"REVENUE_TYPE\"] = \"$revenueType\";\n    RevenueProperty[\"REVENUE_CURRENCY\"] = \"$currency\";\n    RevenueProperty[\"REVENUE\"] = \"$revenue\";\n})(RevenueProperty || (RevenueProperty = {}));\n/**\n * Strings that have special meaning when used as an event's type\n * and have different specifications.\n */\nexport var SpecialEventType;\n(function (SpecialEventType) {\n    SpecialEventType[\"IDENTIFY\"] = \"$identify\";\n    SpecialEventType[\"GROUP_IDENTIFY\"] = \"$groupidentify\";\n    SpecialEventType[\"REVENUE\"] = \"revenue_amount\";\n})(SpecialEventType || (SpecialEventType = {}));\n//# sourceMappingURL=event.js.map","/**\n * @deprecated use ServerZoneType instead\n */\nexport var ServerZone;\n(function (ServerZone) {\n    ServerZone[\"US\"] = \"US\";\n    ServerZone[\"EU\"] = \"EU\";\n})(ServerZone || (ServerZone = {}));\n//# sourceMappingURL=server-zone.js.map","/** The status of an event. */\nexport var Status;\n(function (Status) {\n    /** The status could not be determined. */\n    Status[\"Unknown\"] = \"unknown\";\n    /** The event was skipped due to configuration or callbacks. */\n    Status[\"Skipped\"] = \"skipped\";\n    /** The event was sent successfully. */\n    Status[\"Success\"] = \"success\";\n    /** A user or device in the payload is currently rate limited and should try again later. */\n    Status[\"RateLimit\"] = \"rate_limit\";\n    /** The sent payload was too large to be processed. */\n    Status[\"PayloadTooLarge\"] = \"payload_too_large\";\n    /** The event could not be processed. */\n    Status[\"Invalid\"] = \"invalid\";\n    /** A server-side error ocurred during submission. */\n    Status[\"Failed\"] = \"failed\";\n    /** a server or client side error occuring when a request takes too long and is cancelled */\n    Status[\"Timeout\"] = \"Timeout\";\n    /** NodeJS runtime environment error.. E.g. disconnected from network */\n    Status[\"SystemError\"] = \"SystemError\";\n})(Status || (Status = {}));\n//# sourceMappingURL=status.js.map","/**\n * Default CSS selectors to define which elements on the page to track.\n * Extend this list to include additional elements to track. For example:\n * ```\n * autocapturePlugin({\n *    cssSelectorAllowlist: [...DEFAULT_CSS_SELECTOR_ALLOWLIST, \".my-class\"],\n * })\n * ```\n */\nexport var DEFAULT_CSS_SELECTOR_ALLOWLIST = [\n    'a',\n    'button',\n    'input',\n    'select',\n    'textarea',\n    'label',\n    'video',\n    'audio',\n    '[contenteditable=\"true\" i]',\n    '[data-amp-default-track]',\n    '.amp-default-track',\n];\n/**\n * Default prefix to allow the plugin to capture data attributes as an event property.\n */\nexport var DEFAULT_DATA_ATTRIBUTE_PREFIX = 'data-amp-track-';\n/**\n * Default list of elements on the page should be tracked when the page changes.\n */\nexport var DEFAULT_ACTION_CLICK_ALLOWLIST = ['div', 'span', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n//# sourceMappingURL=element-interactions.js.map","import {\n  PageTrackingHistoryChanges,\n  PageTrackingOptions,\n  PageTrackingTrackOn,\n  ElementInteractionsOptions,\n  BrowserOptions,\n  AutocaptureOptions,\n  AttributionOptions,\n} from '@amplitude/analytics-core';\n\n/**\n * Returns false if autocapture === false or if autocapture[event],\n * otherwise returns true\n */\nconst isTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined, event: keyof AutocaptureOptions) => {\n  if (typeof autocapture === 'boolean') {\n    return autocapture;\n  }\n\n  if (autocapture?.[event] === false) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const isAttributionTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined) =>\n  isTrackingEnabled(autocapture, 'attribution');\n\nexport const isFileDownloadTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined) =>\n  isTrackingEnabled(autocapture, 'fileDownloads');\n\nexport const isFormInteractionTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined) =>\n  isTrackingEnabled(autocapture, 'formInteractions');\n\nexport const isPageViewTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined) =>\n  isTrackingEnabled(autocapture, 'pageViews');\n\nexport const isSessionTrackingEnabled = (autocapture: AutocaptureOptions | boolean | undefined) =>\n  isTrackingEnabled(autocapture, 'sessions');\n\n/**\n * Returns true if\n * 1. autocapture === true\n * 2. if autocapture.elementInteractions === true\n * 3. if autocapture.elementInteractions === object\n * otherwise returns false\n */\nexport const isElementInteractionsEnabled = (autocapture: AutocaptureOptions | boolean | undefined): boolean => {\n  if (typeof autocapture === 'boolean') {\n    return autocapture;\n  }\n\n  if (\n    typeof autocapture === 'object' &&\n    (autocapture.elementInteractions === true || typeof autocapture.elementInteractions === 'object')\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const getElementInteractionsConfig = (config: BrowserOptions): ElementInteractionsOptions | undefined => {\n  if (\n    isElementInteractionsEnabled(config.autocapture) &&\n    typeof config.autocapture === 'object' &&\n    typeof config.autocapture.elementInteractions === 'object'\n  ) {\n    return config.autocapture.elementInteractions;\n  }\n  return undefined;\n};\n\nexport const getPageViewTrackingConfig = (config: BrowserOptions): PageTrackingOptions => {\n  let trackOn: PageTrackingTrackOn | undefined = () => false;\n  let trackHistoryChanges: PageTrackingHistoryChanges | undefined = undefined;\n  let eventType: string | undefined;\n  const pageCounter = config.pageCounter;\n\n  const isDefaultPageViewTrackingEnabled = isPageViewTrackingEnabled(config.defaultTracking);\n  if (isDefaultPageViewTrackingEnabled) {\n    trackOn = undefined;\n    eventType = undefined;\n\n    if (\n      config.defaultTracking &&\n      typeof config.defaultTracking === 'object' &&\n      config.defaultTracking.pageViews &&\n      typeof config.defaultTracking.pageViews === 'object'\n    ) {\n      if ('trackOn' in config.defaultTracking.pageViews) {\n        trackOn = config.defaultTracking.pageViews.trackOn;\n      }\n\n      if ('trackHistoryChanges' in config.defaultTracking.pageViews) {\n        trackHistoryChanges = config.defaultTracking.pageViews.trackHistoryChanges;\n      }\n\n      if ('eventType' in config.defaultTracking.pageViews && config.defaultTracking.pageViews.eventType) {\n        eventType = config.defaultTracking.pageViews.eventType;\n      }\n    }\n  }\n\n  return {\n    trackOn,\n    trackHistoryChanges,\n    eventType,\n    pageCounter,\n  };\n};\n\nexport const getAttributionTrackingConfig = (config: BrowserOptions): AttributionOptions => {\n  if (\n    isAttributionTrackingEnabled(config.defaultTracking) &&\n    config.defaultTracking &&\n    typeof config.defaultTracking === 'object' &&\n    config.defaultTracking.attribution &&\n    typeof config.defaultTracking.attribution === 'object'\n  ) {\n    return {\n      ...config.defaultTracking.attribution,\n    };\n  }\n\n  return {};\n};\n","import { Result, AmplitudeReturn } from '@amplitude/analytics-core';\n\ninterface ProxyItem {\n  name: string;\n  args: any[];\n  resolve?: (promise: Promise<Result>) => void;\n}\n\ntype QueueProxy = Array<ProxyItem>;\n\ninterface InstanceProxy {\n  _q: QueueProxy;\n  _iq: Record<string, InstanceProxy>;\n}\n\n/**\n * Applies the proxied functions on the proxied amplitude snippet to an instance of the real object.\n * @ignore\n */\nexport const runQueuedFunctions = (instance: object, queue: QueueProxy) => {\n  convertProxyObjectToRealObject(instance, queue);\n};\n\n/**\n * Applies the proxied functions on the proxied object to an instance of the real object.\n * Used to convert proxied Identify and Revenue objects.\n */\nexport const convertProxyObjectToRealObject = <T>(instance: T, queue: QueueProxy): T => {\n  for (let i = 0; i < queue.length; i++) {\n    const { name, args, resolve } = queue[i];\n    const fn = instance && instance[name as keyof T];\n    if (typeof fn === 'function') {\n      const result = fn.apply(instance, args) as AmplitudeReturn<Result>;\n      if (typeof resolve === 'function') {\n        resolve(result?.promise);\n      }\n    }\n  }\n  return instance;\n};\n\n/**\n * Check if the param is snippet proxy\n */\nexport const isInstanceProxy = (instance: unknown): instance is InstanceProxy => {\n  const instanceProxy = instance as InstanceProxy;\n  return instanceProxy && instanceProxy._q !== undefined;\n};\n","export const VERSION = '2.16.0';\n","import { UUID, getLanguage, Event, BeforePlugin, BrowserConfig } from '@amplitude/analytics-core';\nimport { VERSION } from '../version';\nimport { LIBPREFIX } from '../lib-prefix';\n\nconst BROWSER_PLATFORM = 'Web';\nconst IP_ADDRESS = '$remote';\nexport class Context implements BeforePlugin {\n  name = '@amplitude/plugin-context-browser';\n  type = 'before' as const;\n\n  // this.config is defined in setup() which will always be called first\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  config: BrowserConfig;\n  userAgent: string | undefined;\n  library = `${LIBPREFIX}/${VERSION}`;\n\n  constructor() {\n    /* istanbul ignore else */\n    if (typeof navigator !== 'undefined') {\n      this.userAgent = navigator.userAgent;\n    }\n  }\n\n  setup(config: BrowserConfig): Promise<undefined> {\n    this.config = config;\n\n    return Promise.resolve(undefined);\n  }\n\n  async execute(context: Event): Promise<Event> {\n    const time = new Date().getTime();\n    const lastEventId = this.config.lastEventId ?? -1;\n    const nextEventId = context.event_id ?? lastEventId + 1;\n    this.config.lastEventId = nextEventId;\n    if (!context.time) {\n      this.config.lastEventTime = time;\n    }\n\n    const event: Event = {\n      user_id: this.config.userId,\n      device_id: this.config.deviceId,\n      session_id: this.config.sessionId,\n      time,\n      ...(this.config.appVersion && { app_version: this.config.appVersion }),\n      ...(this.config.trackingOptions.platform && { platform: BROWSER_PLATFORM }),\n      ...(this.config.trackingOptions.language && { language: getLanguage() }),\n      ...(this.config.trackingOptions.ipAddress && { ip: IP_ADDRESS }),\n      insert_id: UUID(),\n      partner_id: this.config.partnerId,\n      plan: this.config.plan,\n      ...(this.config.ingestionMetadata && {\n        ingestion_metadata: {\n          source_name: this.config.ingestionMetadata.sourceName,\n          source_version: this.config.ingestionMetadata.sourceVersion,\n        },\n      }),\n      ...context,\n      event_id: nextEventId,\n      library: this.library,\n      user_agent: this.userAgent,\n    };\n    return event;\n  }\n}\n","export const LIBPREFIX = 'amplitude-ts';\n","import { Storage as AmplitudeStorage } from '@amplitude/analytics-core';\n\nexport class BrowserStorage<T> implements AmplitudeStorage<T> {\n  constructor(private storage?: Storage) {}\n\n  async isEnabled(): Promise<boolean> {\n    /* istanbul ignore if */\n    if (!this.storage) {\n      return false;\n    }\n\n    const random = String(Date.now());\n    const testStorage = new BrowserStorage<string>(this.storage);\n    const testKey = 'AMP_TEST';\n    try {\n      await testStorage.set(testKey, random);\n      const value = await testStorage.get(testKey);\n      return value === random;\n    } catch {\n      /* istanbul ignore next */\n      return false;\n    } finally {\n      await testStorage.remove(testKey);\n    }\n  }\n\n  async get(key: string): Promise<T | undefined> {\n    try {\n      const value = await this.getRaw(key);\n      if (!value) {\n        return undefined;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n      return JSON.parse(value);\n    } catch {\n      console.error(`[Amplitude] Error: Could not get value from storage`);\n      return undefined;\n    }\n  }\n\n  async getRaw(key: string): Promise<string | undefined> {\n    return this.storage?.getItem(key) || undefined;\n  }\n\n  async set(key: string, value: T): Promise<void> {\n    try {\n      this.storage?.setItem(key, JSON.stringify(value));\n    } catch {\n      //\n    }\n  }\n\n  async remove(key: string): Promise<void> {\n    try {\n      this.storage?.removeItem(key);\n    } catch {\n      //\n    }\n  }\n\n  async reset(): Promise<void> {\n    try {\n      this.storage?.clear();\n    } catch {\n      //\n    }\n  }\n}\n","import { getGlobalScope, ILogger } from '@amplitude/analytics-core';\nimport { BrowserStorage } from './browser-storage';\n\nconst MAX_ARRAY_LENGTH = 1000;\n\ninterface LocalStorageOptions {\n  loggerProvider?: ILogger;\n}\nexport class LocalStorage<T> extends BrowserStorage<T> {\n  loggerProvider?: ILogger;\n\n  constructor(config?: LocalStorageOptions) {\n    let localStorage;\n\n    try {\n      localStorage = getGlobalScope()?.localStorage;\n    } catch (e) {\n      config?.loggerProvider?.debug(`Failed to access localStorage. error=${JSON.stringify(e)}`);\n      localStorage = undefined;\n    }\n    super(localStorage);\n    this.loggerProvider = config?.loggerProvider;\n  }\n\n  async set(key: string, value: T): Promise<void> {\n    if (Array.isArray(value) && value.length > MAX_ARRAY_LENGTH) {\n      const droppedEventsCount = value.length - MAX_ARRAY_LENGTH;\n      await super.set(key, value.slice(0, MAX_ARRAY_LENGTH) as T);\n      this.loggerProvider?.error(\n        `Failed to save ${droppedEventsCount} events because the queue length exceeded ${MAX_ARRAY_LENGTH}.`,\n      );\n    } else {\n      await super.set(key, value);\n    }\n  }\n}\n","import { getGlobalScope } from '@amplitude/analytics-core';\nimport { BrowserStorage } from './browser-storage';\n\nexport class SessionStorage<T> extends BrowserStorage<T> {\n  constructor() {\n    super(getGlobalScope()?.sessionStorage);\n  }\n}\n","import { BaseTransport, Payload, Response, Transport } from '@amplitude/analytics-core';\n\nexport class XHRTransport extends BaseTransport implements Transport {\n  private state = {\n    done: 4,\n  };\n\n  async send(serverUrl: string, payload: Payload): Promise<Response | null> {\n    return new Promise((resolve, reject) => {\n      /* istanbul ignore if */\n      if (typeof XMLHttpRequest === 'undefined') {\n        reject(new Error('XHRTransport is not supported.'));\n      }\n\n      const xhr = new XMLHttpRequest();\n      xhr.open('POST', serverUrl, true);\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === this.state.done) {\n          const responseText = xhr.responseText;\n          try {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n            resolve(this.buildResponse(JSON.parse(responseText)));\n          } catch {\n            resolve(this.buildResponse({ code: xhr.status }));\n          }\n        }\n      };\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      xhr.setRequestHeader('Accept', '*/*');\n      xhr.send(JSON.stringify(payload));\n    });\n  }\n}\n","import { BaseTransport, getGlobalScope, Payload, Response, Transport } from '@amplitude/analytics-core';\n\nexport class SendBeaconTransport extends BaseTransport implements Transport {\n  async send(serverUrl: string, payload: Payload): Promise<Response | null> {\n    return new Promise((resolve, reject) => {\n      const globalScope = getGlobalScope();\n      /* istanbul ignore if */\n      if (!globalScope?.navigator.sendBeacon) {\n        throw new Error('SendBeaconTransport is not supported');\n      }\n      try {\n        const data = JSON.stringify(payload);\n        const success = globalScope.navigator.sendBeacon(serverUrl, JSON.stringify(payload));\n        if (success) {\n          return resolve(\n            this.buildResponse({\n              code: 200,\n              events_ingested: payload.events.length,\n              payload_size_bytes: data.length,\n              server_upload_time: Date.now(),\n            }),\n          );\n        }\n        return resolve(this.buildResponse({ code: 500 }));\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }\n}\n","import { getOldCookieName, Storage, UserSession } from '@amplitude/analytics-core';\n\nexport const parseLegacyCookies = async (\n  apiKey: string,\n  cookieStorage: Storage<UserSession>,\n  deleteLegacyCookies = true,\n): Promise<UserSession> => {\n  const cookieName = getOldCookieName(apiKey);\n  const cookies = await cookieStorage.getRaw(cookieName);\n  if (!cookies) {\n    return {\n      optOut: false,\n    };\n  }\n  if (deleteLegacyCookies) {\n    await cookieStorage.remove(cookieName);\n  }\n  const [deviceId, userId, optOut, sessionId, lastEventTime, lastEventId] = cookies.split('.');\n  return {\n    deviceId,\n    userId: decode(userId),\n    sessionId: parseTime(sessionId),\n    lastEventId: parseTime(lastEventId),\n    lastEventTime: parseTime(lastEventTime),\n    optOut: Boolean(optOut),\n  };\n};\n\nexport const parseTime = (num: string) => {\n  const integer = parseInt(num, 32);\n  if (isNaN(integer)) {\n    return undefined;\n  }\n  return integer;\n};\n\nexport const decode = (value?: string): string | undefined => {\n  if (!atob || !escape || !value) {\n    return undefined;\n  }\n  try {\n    return decodeURIComponent(escape(atob(value)));\n  } catch {\n    return undefined;\n  }\n};\n","import { IdentityStorageType, ServerZoneType } from '@amplitude/analytics-core';\n\nexport const DEFAULT_EVENT_PREFIX = '[Amplitude]';\n\nexport const DEFAULT_PAGE_VIEW_EVENT = `${DEFAULT_EVENT_PREFIX} Page Viewed`;\nexport const DEFAULT_FORM_START_EVENT = `${DEFAULT_EVENT_PREFIX} Form Started`;\nexport const DEFAULT_FORM_SUBMIT_EVENT = `${DEFAULT_EVENT_PREFIX} Form Submitted`;\nexport const DEFAULT_FILE_DOWNLOAD_EVENT = `${DEFAULT_EVENT_PREFIX} File Downloaded`;\nexport const DEFAULT_SESSION_START_EVENT = 'session_start';\nexport const DEFAULT_SESSION_END_EVENT = 'session_end';\n\nexport const FILE_EXTENSION = `${DEFAULT_EVENT_PREFIX} File Extension`;\nexport const FILE_NAME = `${DEFAULT_EVENT_PREFIX} File Name`;\nexport const LINK_ID = `${DEFAULT_EVENT_PREFIX} Link ID`;\nexport const LINK_TEXT = `${DEFAULT_EVENT_PREFIX} Link Text`;\nexport const LINK_URL = `${DEFAULT_EVENT_PREFIX} Link URL`;\n\nexport const FORM_ID = `${DEFAULT_EVENT_PREFIX} Form ID`;\nexport const FORM_NAME = `${DEFAULT_EVENT_PREFIX} Form Name`;\nexport const FORM_DESTINATION = `${DEFAULT_EVENT_PREFIX} Form Destination`;\n\nexport const DEFAULT_IDENTITY_STORAGE: IdentityStorageType = 'cookie';\nexport const DEFAULT_SERVER_ZONE: ServerZoneType = 'US';\n","import {\n  Config,\n  Logger,\n  ILogger,\n  LogLevel,\n  Event,\n  Storage,\n  IngestionMetadata,\n  ServerZoneType,\n  OfflineDisabled,\n  Plan,\n  IdentityStorageType,\n  TransportType,\n  MemoryStorage,\n  UUID,\n  CookieStorage,\n  getCookieName,\n  FetchTransport,\n  getQueryParams,\n  UserSession,\n  BrowserOptions,\n  BrowserConfig as IBrowserConfig,\n  DefaultTrackingOptions,\n  TrackingOptions,\n  AutocaptureOptions,\n  CookieOptions,\n} from '@amplitude/analytics-core';\n\nimport { LocalStorage } from './storage/local-storage';\nimport { SessionStorage } from './storage/session-storage';\nimport { XHRTransport } from './transports/xhr';\nimport { SendBeaconTransport } from './transports/send-beacon';\nimport { parseLegacyCookies } from './cookie-migration';\nimport { DEFAULT_IDENTITY_STORAGE, DEFAULT_SERVER_ZONE } from './constants';\nimport { AmplitudeBrowser } from './browser-client';\nimport { VERSION } from './version';\n\n// Exported for testing purposes only. Do not expose to public interface.\nexport class BrowserConfig extends Config implements IBrowserConfig {\n  public readonly version = VERSION;\n  protected _cookieStorage: Storage<UserSession>;\n  protected _deviceId?: string;\n  protected _lastEventId?: number;\n  protected _lastEventTime?: number;\n  protected _optOut = false;\n  protected _sessionId?: number;\n  protected _userId?: string;\n  protected _pageCounter?: number;\n  protected _debugLogsEnabled?: boolean;\n  constructor(\n    public apiKey: string,\n    public appVersion?: string,\n    cookieStorage: Storage<UserSession> = new MemoryStorage(),\n    public cookieOptions: CookieOptions = {\n      domain: '',\n      expiration: 365,\n      sameSite: 'Lax' as const,\n      secure: false,\n      upgrade: true,\n    },\n    public defaultTracking?: boolean | DefaultTrackingOptions,\n    public autocapture?: boolean | AutocaptureOptions,\n    deviceId?: string,\n    public flushIntervalMillis: number = 1000,\n    public flushMaxRetries: number = 5,\n    public flushQueueSize: number = 30,\n    public identityStorage: IdentityStorageType = DEFAULT_IDENTITY_STORAGE,\n    public ingestionMetadata?: IngestionMetadata,\n    public instanceName?: string,\n    lastEventId?: number,\n    lastEventTime?: number,\n    public loggerProvider: ILogger = new Logger(),\n    public logLevel: LogLevel = LogLevel.Warn,\n    public minIdLength?: number,\n    public offline: boolean | typeof OfflineDisabled = false,\n    optOut = false,\n    public partnerId?: string,\n    public plan?: Plan,\n    public serverUrl: string = '',\n    public serverZone: ServerZoneType = DEFAULT_SERVER_ZONE,\n    sessionId?: number,\n    public sessionTimeout: number = 30 * 60 * 1000,\n    public storageProvider: Storage<Event[]> = new LocalStorage({ loggerProvider }),\n    public trackingOptions: Required<TrackingOptions> = {\n      ipAddress: true,\n      language: true,\n      platform: true,\n    },\n    public transport: 'fetch' | 'xhr' | 'beacon' = 'fetch',\n    public useBatch: boolean = false,\n    public fetchRemoteConfig: boolean = true,\n    userId?: string,\n    pageCounter?: number,\n    debugLogsEnabled?: boolean,\n  ) {\n    super({ apiKey, storageProvider, transportProvider: createTransport(transport) });\n    this._cookieStorage = cookieStorage;\n    this.deviceId = deviceId;\n    this.lastEventId = lastEventId;\n    this.lastEventTime = lastEventTime;\n    this.optOut = optOut;\n    this.sessionId = sessionId;\n    this.pageCounter = pageCounter;\n    this.userId = userId;\n    this.debugLogsEnabled = debugLogsEnabled;\n    this.loggerProvider.enable(debugLogsEnabled ? LogLevel.Debug : this.logLevel);\n  }\n\n  get cookieStorage() {\n    return this._cookieStorage;\n  }\n\n  set cookieStorage(cookieStorage: Storage<UserSession>) {\n    if (this._cookieStorage !== cookieStorage) {\n      this._cookieStorage = cookieStorage;\n      this.updateStorage();\n    }\n  }\n\n  get deviceId() {\n    return this._deviceId;\n  }\n\n  set deviceId(deviceId: string | undefined) {\n    if (this._deviceId !== deviceId) {\n      this._deviceId = deviceId;\n      this.updateStorage();\n    }\n  }\n\n  get userId() {\n    return this._userId;\n  }\n\n  set userId(userId: string | undefined) {\n    if (this._userId !== userId) {\n      this._userId = userId;\n      this.updateStorage();\n    }\n  }\n\n  get sessionId() {\n    return this._sessionId;\n  }\n\n  set sessionId(sessionId: number | undefined) {\n    if (this._sessionId !== sessionId) {\n      this._sessionId = sessionId;\n      this.updateStorage();\n    }\n  }\n\n  get optOut() {\n    return this._optOut;\n  }\n\n  set optOut(optOut: boolean) {\n    if (this._optOut !== optOut) {\n      this._optOut = optOut;\n      this.updateStorage();\n    }\n  }\n\n  get lastEventTime() {\n    return this._lastEventTime;\n  }\n\n  set lastEventTime(lastEventTime: number | undefined) {\n    if (this._lastEventTime !== lastEventTime) {\n      this._lastEventTime = lastEventTime;\n      this.updateStorage();\n    }\n  }\n\n  get lastEventId() {\n    return this._lastEventId;\n  }\n\n  set lastEventId(lastEventId: number | undefined) {\n    if (this._lastEventId !== lastEventId) {\n      this._lastEventId = lastEventId;\n      this.updateStorage();\n    }\n  }\n\n  get pageCounter() {\n    return this._pageCounter;\n  }\n\n  set pageCounter(pageCounter: number | undefined) {\n    if (this._pageCounter !== pageCounter) {\n      this._pageCounter = pageCounter;\n      this.updateStorage();\n    }\n  }\n\n  set debugLogsEnabled(debugLogsEnabled: boolean | undefined) {\n    if (this._debugLogsEnabled !== debugLogsEnabled) {\n      this._debugLogsEnabled = debugLogsEnabled;\n      this.updateStorage();\n    }\n  }\n\n  private updateStorage() {\n    const cache = {\n      deviceId: this._deviceId,\n      userId: this._userId,\n      sessionId: this._sessionId,\n      optOut: this._optOut,\n      lastEventTime: this._lastEventTime,\n      lastEventId: this._lastEventId,\n      pageCounter: this._pageCounter,\n      debugLogsEnabled: this._debugLogsEnabled,\n    };\n    void this.cookieStorage.set(getCookieName(this.apiKey), cache);\n  }\n}\n\nexport const useBrowserConfig = async (\n  apiKey: string,\n  options: BrowserOptions = {},\n  amplitudeInstance: AmplitudeBrowser,\n): Promise<IBrowserConfig> => {\n  // Step 1: Create identity storage instance\n  const identityStorage = options.identityStorage || DEFAULT_IDENTITY_STORAGE;\n  const cookieOptions = {\n    domain:\n      identityStorage !== DEFAULT_IDENTITY_STORAGE ? '' : options.cookieOptions?.domain ?? (await getTopLevelDomain()),\n    expiration: 365,\n    sameSite: 'Lax' as const,\n    secure: false,\n    upgrade: true,\n    ...options.cookieOptions,\n  };\n  const cookieStorage = createCookieStorage<UserSession>(options.identityStorage, cookieOptions);\n\n  // Step 1: Parse cookies using identity storage instance\n  const legacyCookies = await parseLegacyCookies(apiKey, cookieStorage, options.cookieOptions?.upgrade ?? true);\n  const previousCookies = await cookieStorage.get(getCookieName(apiKey));\n  const queryParams = getQueryParams();\n\n  // Step 3: Reconcile user identity\n  const deviceId =\n    options.deviceId ??\n    queryParams.ampDeviceId ??\n    queryParams.deviceId ??\n    previousCookies?.deviceId ??\n    legacyCookies.deviceId ??\n    UUID();\n  const lastEventId = previousCookies?.lastEventId ?? legacyCookies.lastEventId;\n  const lastEventTime = previousCookies?.lastEventTime ?? legacyCookies.lastEventTime;\n  const optOut = options.optOut ?? previousCookies?.optOut ?? legacyCookies.optOut;\n  const sessionId = previousCookies?.sessionId ?? legacyCookies.sessionId;\n  const userId = options.userId ?? previousCookies?.userId ?? legacyCookies.userId;\n  amplitudeInstance.previousSessionDeviceId = previousCookies?.deviceId ?? legacyCookies.deviceId;\n  amplitudeInstance.previousSessionUserId = previousCookies?.userId ?? legacyCookies.userId;\n\n  const trackingOptions = {\n    ipAddress: options.trackingOptions?.ipAddress ?? true,\n    language: options.trackingOptions?.language ?? true,\n    platform: options.trackingOptions?.platform ?? true,\n  };\n  const pageCounter = previousCookies?.pageCounter;\n  const debugLogsEnabled = previousCookies?.debugLogsEnabled;\n\n  // Override default tracking options if autocapture is set\n  if (options.autocapture !== undefined) {\n    options.defaultTracking = options.autocapture;\n  }\n\n  const browserConfig = new BrowserConfig(\n    apiKey,\n    options.appVersion,\n    cookieStorage,\n    cookieOptions,\n    options.defaultTracking,\n    options.autocapture,\n    deviceId,\n    options.flushIntervalMillis,\n    options.flushMaxRetries,\n    options.flushQueueSize,\n    identityStorage,\n    options.ingestionMetadata,\n    options.instanceName,\n    lastEventId,\n    lastEventTime,\n    options.loggerProvider,\n    options.logLevel,\n    options.minIdLength,\n    options.offline,\n    optOut,\n    options.partnerId,\n    options.plan,\n    options.serverUrl,\n    options.serverZone,\n    sessionId,\n    options.sessionTimeout,\n    options.storageProvider,\n    trackingOptions,\n    options.transport,\n    options.useBatch,\n    options.fetchRemoteConfig,\n    userId,\n    pageCounter,\n    debugLogsEnabled,\n  );\n\n  if (!(await browserConfig.storageProvider.isEnabled())) {\n    browserConfig.loggerProvider.warn(\n      `Storage provider ${browserConfig.storageProvider.constructor.name} is not enabled. Falling back to MemoryStorage.`,\n    );\n    browserConfig.storageProvider = new MemoryStorage();\n  }\n\n  return browserConfig;\n};\n\nexport const createCookieStorage = <T>(\n  identityStorage: IdentityStorageType = DEFAULT_IDENTITY_STORAGE,\n  cookieOptions: CookieOptions = {},\n) => {\n  switch (identityStorage) {\n    case 'localStorage':\n      return new LocalStorage<T>();\n    case 'sessionStorage':\n      return new SessionStorage<T>();\n    case 'none':\n      return new MemoryStorage<T>();\n    case 'cookie':\n    default:\n      return new CookieStorage<T>({\n        ...cookieOptions,\n        expirationDays: cookieOptions.expiration,\n      });\n  }\n};\n\nexport const createTransport = (transport?: TransportType) => {\n  if (transport === 'xhr') {\n    return new XHRTransport();\n  }\n  if (transport === 'beacon') {\n    return new SendBeaconTransport();\n  }\n  return new FetchTransport();\n};\n\nexport const getTopLevelDomain = async (url?: string) => {\n  if (\n    !(await new CookieStorage<number>().isEnabled()) ||\n    (!url && (typeof location === 'undefined' || !location.hostname))\n  ) {\n    return '';\n  }\n\n  const host = url ?? location.hostname;\n  const parts = host.split('.');\n  const levels = [];\n  const storageKey = 'AMP_TLDTEST';\n\n  for (let i = parts.length - 2; i >= 0; --i) {\n    levels.push(parts.slice(i).join('.'));\n  }\n  for (let i = 0; i < levels.length; i++) {\n    const domain = levels[i];\n    const options = { domain: '.' + domain };\n    const storage = new CookieStorage<number>(options);\n    await storage.set(storageKey, 1);\n    const value = await storage.get(storageKey);\n    if (value) {\n      await storage.remove(storageKey);\n      return '.' + domain;\n    }\n  }\n\n  return '';\n};\n","/* eslint-disable no-restricted-globals */\n/* Only file allowed to access to globalThis, window, self */\nexport var getGlobalScope = function () {\n    // This should only be used for integrations with Amplitude that are not running in a browser environment\n    //   We need to specify the name of the global variable as a string to prevent it from being minified\n    var ampIntegrationContextName = 'ampIntegrationContext';\n    if (typeof globalThis !== 'undefined' && typeof globalThis[ampIntegrationContextName] !== 'undefined') {\n        return globalThis[ampIntegrationContextName];\n    }\n    if (typeof globalThis !== 'undefined') {\n        return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    return undefined;\n};\n//# sourceMappingURL=global-scope.js.map","import { getGlobalScope } from './global-scope';\nexport var getQueryParams = function () {\n    var _a;\n    var globalScope = getGlobalScope();\n    /* istanbul ignore if */\n    if (!((_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.location) === null || _a === void 0 ? void 0 : _a.search)) {\n        return {};\n    }\n    var pairs = globalScope.location.search.substring(1).split('&').filter(Boolean);\n    var params = pairs.reduce(function (acc, curr) {\n        var query = curr.split('=', 2);\n        var key = tryDecodeURIComponent(query[0]);\n        var value = tryDecodeURIComponent(query[1]);\n        if (!value) {\n            return acc;\n        }\n        acc[key] = value;\n        return acc;\n    }, {});\n    return params;\n};\nexport var tryDecodeURIComponent = function (value) {\n    if (value === void 0) { value = ''; }\n    try {\n        return decodeURIComponent(value);\n    }\n    catch (_a) {\n        return '';\n    }\n};\n//# sourceMappingURL=query-params.js.map","export var UTM_CAMPAIGN = 'utm_campaign';\nexport var UTM_CONTENT = 'utm_content';\nexport var UTM_ID = 'utm_id';\nexport var UTM_MEDIUM = 'utm_medium';\nexport var UTM_SOURCE = 'utm_source';\nexport var UTM_TERM = 'utm_term';\nexport var DCLID = 'dclid';\nexport var FBCLID = 'fbclid';\nexport var GBRAID = 'gbraid';\nexport var GCLID = 'gclid';\nexport var KO_CLICK_ID = 'ko_click_id';\nexport var LI_FAT_ID = 'li_fat_id';\nexport var MSCLKID = 'msclkid';\nexport var RDT_CID = 'rtd_cid';\nexport var TTCLID = 'ttclid';\nexport var TWCLID = 'twclid';\nexport var WBRAID = 'wbraid';\nexport var EMPTY_VALUE = 'EMPTY';\nexport var BASE_CAMPAIGN = {\n    utm_campaign: undefined,\n    utm_content: undefined,\n    utm_id: undefined,\n    utm_medium: undefined,\n    utm_source: undefined,\n    utm_term: undefined,\n    referrer: undefined,\n    referring_domain: undefined,\n    dclid: undefined,\n    gbraid: undefined,\n    gclid: undefined,\n    fbclid: undefined,\n    ko_click_id: undefined,\n    li_fat_id: undefined,\n    msclkid: undefined,\n    rtd_cid: undefined,\n    ttclid: undefined,\n    twclid: undefined,\n    wbraid: undefined,\n};\nexport var MKTG = 'MKTG';\n//# sourceMappingURL=constants.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { getQueryParams } from '../query-params';\nimport { UTM_CAMPAIGN, UTM_CONTENT, UTM_MEDIUM, UTM_SOURCE, UTM_TERM, GCLID, FBCLID, BASE_CAMPAIGN, DCLID, MSCLKID, RDT_CID, TWCLID, TTCLID, KO_CLICK_ID, LI_FAT_ID, GBRAID, WBRAID, UTM_ID, } from './constants';\nvar CampaignParser = /** @class */ (function () {\n    function CampaignParser() {\n    }\n    CampaignParser.prototype.parse = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, __assign(__assign(__assign(__assign({}, BASE_CAMPAIGN), this.getUtmParam()), this.getReferrer()), this.getClickIds())];\n            });\n        });\n    };\n    CampaignParser.prototype.getUtmParam = function () {\n        var params = getQueryParams();\n        var utmCampaign = params[UTM_CAMPAIGN];\n        var utmContent = params[UTM_CONTENT];\n        var utmId = params[UTM_ID];\n        var utmMedium = params[UTM_MEDIUM];\n        var utmSource = params[UTM_SOURCE];\n        var utmTerm = params[UTM_TERM];\n        return {\n            utm_campaign: utmCampaign,\n            utm_content: utmContent,\n            utm_id: utmId,\n            utm_medium: utmMedium,\n            utm_source: utmSource,\n            utm_term: utmTerm,\n        };\n    };\n    CampaignParser.prototype.getReferrer = function () {\n        var _a, _b;\n        var data = {\n            referrer: undefined,\n            referring_domain: undefined,\n        };\n        try {\n            data.referrer = document.referrer || undefined;\n            data.referring_domain = (_b = (_a = data.referrer) === null || _a === void 0 ? void 0 : _a.split('/')[2]) !== null && _b !== void 0 ? _b : undefined;\n        }\n        catch (_c) {\n            // nothing to track\n        }\n        return data;\n    };\n    CampaignParser.prototype.getClickIds = function () {\n        var _a;\n        var params = getQueryParams();\n        return _a = {},\n            _a[DCLID] = params[DCLID],\n            _a[FBCLID] = params[FBCLID],\n            _a[GBRAID] = params[GBRAID],\n            _a[GCLID] = params[GCLID],\n            _a[KO_CLICK_ID] = params[KO_CLICK_ID],\n            _a[LI_FAT_ID] = params[LI_FAT_ID],\n            _a[MSCLKID] = params[MSCLKID],\n            _a[RDT_CID] = params[RDT_CID],\n            _a[TTCLID] = params[TTCLID],\n            _a[TWCLID] = params[TWCLID],\n            _a[WBRAID] = params[WBRAID],\n            _a;\n    };\n    return CampaignParser;\n}());\nexport { CampaignParser };\n//# sourceMappingURL=campaign-parser.js.map","export var omitUndefined = function (input) {\n    var obj = {};\n    for (var key in input) {\n        var val = input[key];\n        if (val) {\n            obj[key] = val;\n        }\n    }\n    return obj;\n};\n//# sourceMappingURL=utils.js.map","import { __assign, __awaiter, __generator, __read, __spreadArray } from \"tslib\";\nimport { CampaignParser, getGlobalScope } from '@amplitude/analytics-client-common';\nimport { IdentifyOperation, } from '@amplitude/analytics-types';\nimport { BASE_CAMPAIGN } from '@amplitude/analytics-client-common';\nimport { omitUndefined } from './utils';\nexport var defaultPageViewEvent = '[Amplitude] Page Viewed';\nexport var pageViewTrackingPlugin = function (options) {\n    if (options === void 0) { options = {}; }\n    var amplitude;\n    var globalScope = getGlobalScope();\n    var loggerProvider = undefined;\n    var pushState;\n    var localConfig;\n    var trackOn = options.trackOn, trackHistoryChanges = options.trackHistoryChanges, _a = options.eventType, eventType = _a === void 0 ? defaultPageViewEvent : _a;\n    var getDecodeURI = function (locationStr) {\n        var decodedLocationStr = locationStr;\n        try {\n            decodedLocationStr = decodeURI(locationStr);\n        }\n        catch (e) {\n            /* istanbul ignore next */\n            loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.error('Malformed URI sequence: ', e);\n        }\n        return decodedLocationStr;\n    };\n    var createPageViewEvent = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var locationHREF, _a;\n        var _b;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    locationHREF = getDecodeURI((typeof location !== 'undefined' && location.href) || '');\n                    _b = {\n                        event_type: eventType\n                    };\n                    _a = [{}];\n                    return [4 /*yield*/, getCampaignParams()];\n                case 1: return [2 /*return*/, (_b.event_properties = __assign.apply(void 0, [__assign.apply(void 0, _a.concat([(_c.sent())])), { '[Amplitude] Page Domain': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.hostname) || '', '[Amplitude] Page Location': locationHREF, '[Amplitude] Page Path': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && getDecodeURI(location.pathname)) || '', '[Amplitude] Page Title': /* istanbul ignore next */ (typeof document !== 'undefined' && document.title) || '', '[Amplitude] Page URL': locationHREF.split('?')[0] }]),\n                        _b)];\n            }\n        });\n    }); };\n    var shouldTrackOnPageLoad = function () { return typeof trackOn === 'undefined' || (typeof trackOn === 'function' && trackOn()); };\n    /* istanbul ignore next */\n    var previousURL = typeof location !== 'undefined' ? location.href : null;\n    var trackHistoryPageView = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var newURL, shouldTrackPageView, _a, _b, _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    newURL = location.href;\n                    shouldTrackPageView = shouldTrackHistoryPageView(trackHistoryChanges, newURL, previousURL || '') && shouldTrackOnPageLoad();\n                    // Note: Update `previousURL` in the same clock tick as `shouldTrackHistoryPageView()`\n                    // This was previously done after `amplitude?.track(await createPageViewEvent());` and\n                    // causes a concurrency issue where app triggers `pushState` twice with the same URL target\n                    // but `previousURL` is only updated after the second `pushState` producing two page viewed events\n                    previousURL = newURL;\n                    if (!shouldTrackPageView) return [3 /*break*/, 4];\n                    /* istanbul ignore next */\n                    loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Tracking page view event');\n                    if (!(amplitude === null || amplitude === void 0)) return [3 /*break*/, 1];\n                    _a = void 0;\n                    return [3 /*break*/, 3];\n                case 1:\n                    _c = (_b = amplitude).track;\n                    return [4 /*yield*/, createPageViewEvent()];\n                case 2:\n                    _a = _c.apply(_b, [_d.sent()]);\n                    _d.label = 3;\n                case 3:\n                    _a;\n                    _d.label = 4;\n                case 4: return [2 /*return*/];\n            }\n        });\n    }); };\n    /* istanbul ignore next */\n    var trackHistoryPageViewWrapper = function () {\n        void trackHistoryPageView();\n    };\n    var plugin = {\n        name: '@amplitude/plugin-page-view-tracking-browser',\n        type: 'enrichment',\n        setup: function (config, client) { return __awaiter(void 0, void 0, void 0, function () {\n            var _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        amplitude = client;\n                        localConfig = config;\n                        loggerProvider = config.loggerProvider;\n                        loggerProvider.log('Installing @amplitude/plugin-page-view-tracking-browser');\n                        if (globalScope) {\n                            globalScope.addEventListener('popstate', trackHistoryPageViewWrapper);\n                            // Save reference to original push state, to be used in teardown\n                            // eslint-disable-next-line @typescript-eslint/unbound-method\n                            pushState = globalScope.history.pushState;\n                            /* istanbul ignore next */\n                            // There is no global browser listener for changes to history, so we have\n                            // to modify pushState directly.\n                            // https://stackoverflow.com/a/64927639\n                            // eslint-disable-next-line @typescript-eslint/unbound-method\n                            globalScope.history.pushState = new Proxy(globalScope.history.pushState, {\n                                apply: function (target, thisArg, _a) {\n                                    var _b = __read(_a, 3), state = _b[0], unused = _b[1], url = _b[2];\n                                    target.apply(thisArg, [state, unused, url]);\n                                    void trackHistoryPageView();\n                                },\n                            });\n                        }\n                        if (!shouldTrackOnPageLoad()) return [3 /*break*/, 2];\n                        loggerProvider.log('Tracking page view event');\n                        _b = (_a = amplitude).track;\n                        return [4 /*yield*/, createPageViewEvent()];\n                    case 1:\n                        _b.apply(_a, [_c.sent()]);\n                        _c.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        }); },\n        execute: function (event) { return __awaiter(void 0, void 0, void 0, function () {\n            var pageViewEvent;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(trackOn === 'attribution' && isCampaignEvent(event))) return [3 /*break*/, 2];\n                        /* istanbul ignore next */ // loggerProvider should be defined by the time execute is invoked\n                        loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Enriching campaign event to page view event with campaign parameters');\n                        return [4 /*yield*/, createPageViewEvent()];\n                    case 1:\n                        pageViewEvent = _a.sent();\n                        event.event_type = pageViewEvent.event_type;\n                        event.event_properties = __assign(__assign({}, event.event_properties), pageViewEvent.event_properties);\n                        _a.label = 2;\n                    case 2:\n                        // Update the pageCounter for the page view event\n                        if (localConfig && event.event_type === eventType) {\n                            localConfig.pageCounter = !localConfig.pageCounter ? 1 : localConfig.pageCounter + 1;\n                            event.event_properties = __assign(__assign({}, event.event_properties), { '[Amplitude] Page Counter': localConfig.pageCounter });\n                        }\n                        return [2 /*return*/, event];\n                }\n            });\n        }); },\n        teardown: function () { return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (globalScope) {\n                    globalScope.removeEventListener('popstate', trackHistoryPageViewWrapper);\n                    if (pushState) {\n                        globalScope.history.pushState = pushState;\n                    }\n                }\n                return [2 /*return*/];\n            });\n        }); },\n    };\n    return plugin;\n};\nvar getCampaignParams = function () { return __awaiter(void 0, void 0, void 0, function () { var _a; return __generator(this, function (_b) {\n    switch (_b.label) {\n        case 0:\n            _a = omitUndefined;\n            return [4 /*yield*/, new CampaignParser().parse()];\n        case 1: return [2 /*return*/, _a.apply(void 0, [_b.sent()])];\n    }\n}); }); };\nvar isCampaignEvent = function (event) {\n    if (event.event_type === '$identify' && event.user_properties) {\n        var properties = event.user_properties;\n        var $set = properties[IdentifyOperation.SET] || {};\n        var $unset = properties[IdentifyOperation.UNSET] || {};\n        var userProperties_1 = __spreadArray(__spreadArray([], __read(Object.keys($set)), false), __read(Object.keys($unset)), false);\n        return Object.keys(BASE_CAMPAIGN).every(function (value) { return userProperties_1.includes(value); });\n    }\n    return false;\n};\nexport var shouldTrackHistoryPageView = function (trackingOption, newURLStr, oldURLStr) {\n    switch (trackingOption) {\n        case 'pathOnly': {\n            if (oldURLStr == '')\n                return true;\n            var newURL = new URL(newURLStr);\n            var oldURL = new URL(oldURLStr);\n            var newBaseStr = newURL.origin + newURL.pathname;\n            var oldBaseStr = oldURL.origin + oldURL.pathname;\n            return newBaseStr !== oldBaseStr;\n        }\n        default:\n            return newURLStr !== oldURLStr;\n    }\n};\n//# sourceMappingURL=page-view-tracking.js.map","import {\n  DEFAULT_FORM_START_EVENT,\n  DEFAULT_FORM_SUBMIT_EVENT,\n  FORM_ID,\n  FORM_NAME,\n  FORM_DESTINATION,\n} from '../constants';\nimport { BrowserConfig } from '../config';\nimport { getGlobalScope, Event, EnrichmentPlugin, BrowserClient } from '@amplitude/analytics-core';\n\ninterface EventListener {\n  element: Element;\n  type: 'change' | 'submit';\n  handler: () => void;\n}\n\nexport const formInteractionTracking = (): EnrichmentPlugin => {\n  let observer: MutationObserver | undefined;\n  let eventListeners: EventListener[] = [];\n\n  const addEventListener = (element: Element, type: 'change' | 'submit', handler: () => void) => {\n    element.addEventListener(type, handler);\n    eventListeners.push({\n      element,\n      type,\n      handler,\n    });\n  };\n\n  const removeClickListeners = () => {\n    eventListeners.forEach(({ element, type, handler }) => {\n      /* istanbul ignore next */\n      element?.removeEventListener(type, handler);\n    });\n    eventListeners = [];\n  };\n\n  const name = '@amplitude/plugin-form-interaction-tracking-browser';\n  const type = 'enrichment';\n  const setup = async (config: BrowserConfig, amplitude: BrowserClient) => {\n    const initializeFormTracking = () => {\n      /* istanbul ignore if */\n      if (!amplitude) {\n        // TODO: Add required minimum version of @amplitude/analytics-browser\n        config.loggerProvider.warn(\n          'Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.',\n        );\n        return;\n      }\n\n      /* istanbul ignore if */\n      if (typeof document === 'undefined') {\n        return;\n      }\n\n      const addFormInteractionListener = (form: HTMLFormElement) => {\n        let hasFormChanged = false;\n\n        addEventListener(form, 'change', () => {\n          const formDestination = extractFormAction(form);\n          if (!hasFormChanged) {\n            amplitude.track(DEFAULT_FORM_START_EVENT, {\n              [FORM_ID]: stringOrUndefined(form.id),\n              [FORM_NAME]: stringOrUndefined(form.name),\n              [FORM_DESTINATION]: formDestination,\n            });\n          }\n          hasFormChanged = true;\n        });\n\n        addEventListener(form, 'submit', () => {\n          const formDestination = extractFormAction(form);\n          if (!hasFormChanged) {\n            amplitude.track(DEFAULT_FORM_START_EVENT, {\n              [FORM_ID]: stringOrUndefined(form.id),\n              [FORM_NAME]: stringOrUndefined(form.name),\n              [FORM_DESTINATION]: formDestination,\n            });\n          }\n\n          amplitude.track(DEFAULT_FORM_SUBMIT_EVENT, {\n            [FORM_ID]: stringOrUndefined(form.id),\n            [FORM_NAME]: stringOrUndefined(form.name),\n            [FORM_DESTINATION]: formDestination,\n          });\n          hasFormChanged = false;\n        });\n      };\n\n      // Adds listener to existing anchor tags\n      const forms = Array.from(document.getElementsByTagName('form'));\n      forms.forEach(addFormInteractionListener);\n\n      // Adds listener to anchor tags added after initial load\n      /* istanbul ignore else */\n      if (typeof MutationObserver !== 'undefined') {\n        observer = new MutationObserver((mutations) => {\n          mutations.forEach((mutation) => {\n            mutation.addedNodes.forEach((node) => {\n              if (node.nodeName === 'FORM') {\n                addFormInteractionListener(node as HTMLFormElement);\n              }\n              if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {\n                Array.from(node.querySelectorAll('form') as HTMLFormElement[]).map(addFormInteractionListener);\n              }\n            });\n          });\n        });\n\n        observer.observe(document.body, {\n          subtree: true,\n          childList: true,\n        });\n      }\n    };\n\n    // If the document is already loaded, initialize immediately.\n    if (document.readyState === 'complete') {\n      initializeFormTracking();\n    } else {\n      // Otherwise, wait for the load event.\n      // The form interaction plugin observes changes in the dom. For this to work correctly, the observer can only be setup\n      // after the body is built. When Amplitude gets initialized in a script tag, the body tag is still unavailable. So register this\n      // only after the window is loaded\n      const window = getGlobalScope();\n      /* istanbul ignore else*/\n      if (window) {\n        window.addEventListener('load', initializeFormTracking);\n      } else {\n        config.loggerProvider.debug('Form interaction tracking is not installed because global is undefined.');\n      }\n    }\n  };\n  const execute = async (event: Event) => event;\n  const teardown = async () => {\n    observer?.disconnect();\n    removeClickListeners();\n  };\n\n  return {\n    name,\n    type,\n    setup,\n    execute,\n    teardown,\n  };\n};\n\nexport const stringOrUndefined = <T>(name: T): T extends string ? string : undefined => {\n  /* istanbul ignore if */\n  if (typeof name !== 'string') {\n    // We found instances where the value of `name` is an Element and not a string.\n    // Elements may have circular references and would throw an error when passed to `JSON.stringify(...)`.\n    // If a non-string value is seen, assume there is no value.\n    return undefined as T extends string ? string : undefined;\n  }\n\n  return name as T extends string ? string : undefined;\n};\n\n// Extracts the form action attribute, and normalizes it to a valid URL to preserve the previous behavior of accessing the action property directly.\nexport const extractFormAction = (form: HTMLFormElement): string | null => {\n  let formDestination = form.getAttribute('action');\n  try {\n    // eslint-disable-next-line no-restricted-globals\n    formDestination = new URL(encodeURI(formDestination ?? ''), window.location.href).href;\n  } catch {\n    //\n  }\n  return formDestination;\n};\n","import { DEFAULT_FILE_DOWNLOAD_EVENT, FILE_EXTENSION, FILE_NAME, LINK_ID, LINK_TEXT, LINK_URL } from '../constants';\nimport { BrowserConfig } from '../config';\nimport { getGlobalScope, Event, EnrichmentPlugin, BrowserClient } from '@amplitude/analytics-core';\n\ninterface EventListener {\n  element: Element;\n  type: 'click';\n  handler: () => void;\n}\n\nexport const fileDownloadTracking = (): EnrichmentPlugin => {\n  let observer: MutationObserver | undefined;\n  let eventListeners: EventListener[] = [];\n  const addEventListener = (element: Element, type: 'click', handler: () => void) => {\n    element.addEventListener(type, handler);\n    eventListeners.push({\n      element,\n      type,\n      handler,\n    });\n  };\n  const removeClickListeners = () => {\n    eventListeners.forEach(({ element, type, handler }) => {\n      /* istanbul ignore next */\n      element?.removeEventListener(type, handler);\n    });\n    eventListeners = [];\n  };\n\n  const name = '@amplitude/plugin-file-download-tracking-browser';\n  const type = 'enrichment';\n\n  const setup = async (config: BrowserConfig, amplitude: BrowserClient) => {\n    const initializeFileDownloadTracking = () => {\n      /* istanbul ignore if */\n      if (!amplitude) {\n        // TODO: Add required minimum version of @amplitude/analytics-browser\n        config.loggerProvider.warn(\n          'File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.',\n        );\n        return;\n      }\n\n      /* istanbul ignore if */\n      if (typeof document === 'undefined') {\n        return;\n      }\n\n      const addFileDownloadListener = (a: HTMLAnchorElement) => {\n        let url: URL;\n        try {\n          // eslint-disable-next-line no-restricted-globals\n          url = new URL(a.href, window.location.href);\n        } catch {\n          /* istanbul ignore next */\n          return;\n        }\n        const result = ext.exec(url.href);\n        const fileExtension = result?.[1];\n\n        if (fileExtension) {\n          addEventListener(a, 'click', () => {\n            if (fileExtension) {\n              amplitude.track(DEFAULT_FILE_DOWNLOAD_EVENT, {\n                [FILE_EXTENSION]: fileExtension,\n                [FILE_NAME]: url.pathname,\n                [LINK_ID]: a.id,\n                [LINK_TEXT]: a.text,\n                [LINK_URL]: a.href,\n              });\n            }\n          });\n        }\n      };\n\n      const ext =\n        /\\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)(\\?.+)?$/;\n\n      // Adds listener to existing anchor tags\n      const links = Array.from(document.getElementsByTagName('a'));\n      links.forEach(addFileDownloadListener);\n\n      // Adds listener to anchor tags added after initial load\n      /* istanbul ignore else */\n      if (typeof MutationObserver !== 'undefined') {\n        observer = new MutationObserver((mutations) => {\n          mutations.forEach((mutation) => {\n            mutation.addedNodes.forEach((node) => {\n              if (node.nodeName === 'A') {\n                addFileDownloadListener(node as HTMLAnchorElement);\n              }\n              if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {\n                Array.from(node.querySelectorAll('a') as HTMLAnchorElement[]).map(addFileDownloadListener);\n              }\n            });\n          });\n        });\n\n        observer.observe(document.body, {\n          subtree: true,\n          childList: true,\n        });\n      }\n    };\n\n    // If the document is already loaded, initialize immediately.\n    /* istanbul ignore else*/\n    if (document.readyState === 'complete') {\n      initializeFileDownloadTracking();\n    } else {\n      // Otherwise, wait for the load event.\n      const window = getGlobalScope();\n      /* istanbul ignore else*/\n      if (window) {\n        window.addEventListener('load', initializeFileDownloadTracking);\n      } else {\n        config.loggerProvider.debug('File download tracking is not installed because global is undefined.');\n      }\n    }\n  };\n\n  const execute = async (event: Event) => event;\n  const teardown = async () => {\n    observer?.disconnect();\n    removeClickListeners();\n  };\n\n  return {\n    name,\n    type,\n    setup,\n    execute,\n    teardown,\n  };\n};\n","import { BrowserConfig } from '@amplitude/analytics-core';\n\nlet notified = false;\n\nexport const detNotify = (config: BrowserConfig): void => {\n  if (notified || config.defaultTracking !== undefined) {\n    return;\n  }\n\n  const message = `\\`options.defaultTracking\\` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to \\`options.defaultTracking\\`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:\n\namplitude.init(<YOUR_API_KEY>, {\n  defaultTracking: true,\n});\n\nVisit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.`;\n  config.loggerProvider.warn(message);\n  notified = true;\n};\n\n/**\n * @private\n * This function is meant for testing purposes only\n */\nexport const resetNotify = () => {\n  notified = false;\n};\n","import { getGlobalScope, BeforePlugin, BrowserClient } from '@amplitude/analytics-core';\nimport { BrowserConfig } from 'src/config';\n\ninterface EventListener {\n  type: 'online' | 'offline';\n  handler: () => void;\n}\n\nexport const networkConnectivityCheckerPlugin = (): BeforePlugin => {\n  const name = '@amplitude/plugin-network-checker-browser';\n  const type = 'before' as const;\n  const globalScope = getGlobalScope();\n  let eventListeners: EventListener[] = [];\n\n  const addNetworkListener = (type: 'online' | 'offline', handler: () => void) => {\n    if (globalScope) {\n      globalScope.addEventListener(type, handler);\n      eventListeners.push({\n        type,\n        handler,\n      });\n    }\n  };\n\n  const removeNetworkListeners = () => {\n    eventListeners.forEach(({ type, handler }) => {\n      if (globalScope) {\n        globalScope.removeEventListener(type, handler);\n      }\n    });\n    eventListeners = [];\n  };\n\n  const setup = async (config: BrowserConfig, amplitude: BrowserClient) => {\n    if (typeof navigator === 'undefined') {\n      config.loggerProvider.debug(\n        'Network connectivity checker plugin is disabled because navigator is not available.',\n      );\n      config.offline = false;\n      return;\n    }\n\n    config.offline = !navigator.onLine;\n\n    addNetworkListener('online', () => {\n      config.loggerProvider.debug('Network connectivity changed to online.');\n      config.offline = false;\n      // Flush immediately will cause ERR_NETWORK_CHANGED\n      setTimeout(() => {\n        amplitude.flush();\n      }, config.flushIntervalMillis);\n    });\n\n    addNetworkListener('offline', () => {\n      config.loggerProvider.debug('Network connectivity changed to offline.');\n      config.offline = true;\n    });\n  };\n\n  const teardown = async () => {\n    removeNetworkListeners();\n  };\n\n  return {\n    name,\n    type,\n    setup,\n    teardown,\n  };\n};\n","import { __assign, __awaiter, __generator, __values } from \"tslib\";\nimport { BaseTransport } from '@amplitude/analytics-core';\nimport { ServerZone, Status } from '@amplitude/analytics-types';\nvar UNEXPECTED_NETWORK_ERROR_MESSAGE = 'Network error occurred, remote config fetch failed';\nvar SUCCESS_REMOTE_CONFIG = 'Remote config successfully fetched';\nvar MAX_RETRIES_EXCEEDED_MESSAGE = 'Remote config fetch rejected due to exceeded retry count';\nvar TIMEOUT_MESSAGE = 'Remote config fetch rejected due to timeout after 5 seconds';\nvar UNEXPECTED_ERROR_MESSAGE = 'Unexpected error occurred';\nexport var REMOTE_CONFIG_SERVER_URL = 'https://sr-client-cfg.amplitude.com/config';\nexport var REMOTE_CONFIG_SERVER_URL_STAGING = 'https://sr-client-cfg.stag2.amplitude.com/config';\nexport var REMOTE_CONFIG_SERVER_URL_EU = 'https://sr-client-cfg.eu.amplitude.com/config';\nvar RemoteConfigFetch = /** @class */ (function () {\n    function RemoteConfigFetch(_a) {\n        var localConfig = _a.localConfig, configKeys = _a.configKeys;\n        var _this = this;\n        this.retryTimeout = 1000;\n        this.attempts = 0;\n        this.sessionTargetingMatch = false;\n        this.metrics = {};\n        this.getRemoteConfig = function (configNamespace, key, sessionId) { return __awaiter(_this, void 0, void 0, function () {\n            var fetchStartTime, configAPIResponse, remoteConfig;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        fetchStartTime = Date.now();\n                        return [4 /*yield*/, this.fetchWithTimeout(sessionId)];\n                    case 1:\n                        configAPIResponse = _a.sent();\n                        if (configAPIResponse) {\n                            remoteConfig = configAPIResponse.configs && configAPIResponse.configs[configNamespace];\n                            if (remoteConfig) {\n                                this.metrics.fetchTimeAPISuccess = Date.now() - fetchStartTime;\n                                return [2 /*return*/, remoteConfig[key]];\n                            }\n                        }\n                        this.metrics.fetchTimeAPIFail = Date.now() - fetchStartTime;\n                        return [2 /*return*/, undefined];\n                }\n            });\n        }); };\n        this.fetchWithTimeout = function (sessionId) { return __awaiter(_this, void 0, void 0, function () {\n            var controller, timeoutId, remoteConfig;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        controller = new AbortController();\n                        timeoutId = setTimeout(function () { return controller.abort(); }, 5000);\n                        return [4 /*yield*/, this.fetchRemoteConfig(controller.signal, sessionId)];\n                    case 1:\n                        remoteConfig = _a.sent();\n                        clearTimeout(timeoutId);\n                        return [2 /*return*/, remoteConfig];\n                }\n            });\n        }); };\n        this.fetchRemoteConfig = function (signal, sessionId) { return __awaiter(_this, void 0, void 0, function () {\n            var urlParams, _a, _b, configKey, options, serverUrl, res, parsedStatus, e_1, knownError;\n            var e_2, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        if (sessionId === this.lastFetchedSessionId && this.attempts >= this.localConfig.flushMaxRetries) {\n                            return [2 /*return*/, this.completeRequest({ err: MAX_RETRIES_EXCEEDED_MESSAGE })];\n                        }\n                        else if (signal.aborted) {\n                            return [2 /*return*/, this.completeRequest({ err: TIMEOUT_MESSAGE })];\n                        }\n                        else if (sessionId !== this.lastFetchedSessionId) {\n                            this.lastFetchedSessionId = sessionId;\n                            this.attempts = 0;\n                        }\n                        _d.label = 1;\n                    case 1:\n                        _d.trys.push([1, 3, , 4]);\n                        urlParams = new URLSearchParams({\n                            api_key: this.localConfig.apiKey,\n                        });\n                        try {\n                            for (_a = __values(this.configKeys), _b = _a.next(); !_b.done; _b = _a.next()) {\n                                configKey = _b.value;\n                                urlParams.append('config_keys', configKey);\n                            }\n                        }\n                        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                        finally {\n                            try {\n                                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);\n                            }\n                            finally { if (e_2) throw e_2.error; }\n                        }\n                        if (sessionId) {\n                            urlParams.set('session_id', String(sessionId));\n                        }\n                        options = {\n                            headers: {\n                                Accept: '*/*',\n                            },\n                            method: 'GET',\n                        };\n                        serverUrl = \"\".concat(this.getServerUrl(), \"?\").concat(urlParams.toString());\n                        this.attempts += 1;\n                        return [4 /*yield*/, fetch(serverUrl, __assign(__assign({}, options), { signal: signal }))];\n                    case 2:\n                        res = _d.sent();\n                        if (res === null) {\n                            return [2 /*return*/, this.completeRequest({ err: UNEXPECTED_ERROR_MESSAGE })];\n                        }\n                        parsedStatus = new BaseTransport().buildStatus(res.status);\n                        switch (parsedStatus) {\n                            case Status.Success:\n                                this.attempts = 0;\n                                return [2 /*return*/, this.parseAndStoreConfig(res)];\n                            case Status.Failed:\n                                return [2 /*return*/, this.retryFetch(signal, sessionId)];\n                            default:\n                                return [2 /*return*/, this.completeRequest({ err: UNEXPECTED_NETWORK_ERROR_MESSAGE })];\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _d.sent();\n                        knownError = e_1;\n                        if (signal.aborted) {\n                            return [2 /*return*/, this.completeRequest({ err: TIMEOUT_MESSAGE })];\n                        }\n                        return [2 /*return*/, this.completeRequest({ err: knownError.message })];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        this.retryFetch = function (signal, sessionId) { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, new Promise(function (resolve) { return setTimeout(resolve, _this.attempts * _this.retryTimeout); })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this.fetchRemoteConfig(signal, sessionId)];\n                }\n            });\n        }); };\n        this.parseAndStoreConfig = function (res) { return __awaiter(_this, void 0, void 0, function () {\n            var remoteConfig;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, res.json()];\n                    case 1:\n                        remoteConfig = (_a.sent());\n                        this.completeRequest({ success: SUCCESS_REMOTE_CONFIG });\n                        return [2 /*return*/, remoteConfig];\n                }\n            });\n        }); };\n        this.localConfig = localConfig;\n        this.configKeys = configKeys;\n    }\n    RemoteConfigFetch.prototype.getServerUrl = function () {\n        if (this.localConfig.serverZone === ServerZone.STAGING) {\n            return REMOTE_CONFIG_SERVER_URL_STAGING;\n        }\n        if (this.localConfig.serverZone === ServerZone.EU) {\n            return REMOTE_CONFIG_SERVER_URL_EU;\n        }\n        return REMOTE_CONFIG_SERVER_URL;\n    };\n    RemoteConfigFetch.prototype.completeRequest = function (_a) {\n        var err = _a.err, success = _a.success;\n        if (err) {\n            throw new Error(err);\n        }\n        else if (success) {\n            this.localConfig.loggerProvider.log(success);\n        }\n    };\n    return RemoteConfigFetch;\n}());\nexport { RemoteConfigFetch };\nexport var createRemoteConfigFetch = function (_a) {\n    var localConfig = _a.localConfig, configKeys = _a.configKeys;\n    return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_b) {\n            return [2 /*return*/, new RemoteConfigFetch({ localConfig: localConfig, configKeys: configKeys })];\n        });\n    });\n};\n//# sourceMappingURL=remote-config.js.map","import * as remoteConfigFetch from './remote-config';\nexport var createRemoteConfigFetch = remoteConfigFetch.createRemoteConfigFetch;\n//# sourceMappingURL=index.js.map","import { createRemoteConfigFetch, RemoteConfigFetch } from '@amplitude/analytics-remote-config';\nimport {\n  RequestMetadata,\n  BrowserConfig as IBrowserConfig,\n  AutocaptureOptions,\n  type ElementInteractionsOptions,\n} from '@amplitude/analytics-core';\n\nexport interface AutocaptureOptionsRemoteConfig extends AutocaptureOptions {\n  elementInteractions?: boolean | ElementInteractionsOptionsRemoteConfig;\n}\nexport interface ElementInteractionsOptionsRemoteConfig extends ElementInteractionsOptions {\n  /**\n   * Related to pageUrlAllowlist but holds regex strings which will be initialized and appended to pageUrlAllowlist\n   */\n  pageUrlAllowlistRegex?: string[];\n}\n\nexport type BrowserRemoteConfig = {\n  browserSDK: {\n    autocapture?: AutocaptureOptionsRemoteConfig | boolean;\n  };\n};\n\nexport class BrowserJoinedConfigGenerator {\n  // Local config before generateJoinedConfig is called\n  // Joined config after generateJoinedConfig is called\n  config: IBrowserConfig;\n  remoteConfigFetch: RemoteConfigFetch<BrowserRemoteConfig> | undefined;\n\n  constructor(localConfig: IBrowserConfig) {\n    this.config = localConfig;\n    this.config.loggerProvider.debug(\n      'Local configuration before merging with remote config',\n      JSON.stringify(this.config, null, 2),\n    );\n  }\n\n  async initialize() {\n    this.remoteConfigFetch = await createRemoteConfigFetch<BrowserRemoteConfig>({\n      localConfig: this.config,\n      configKeys: ['analyticsSDK'],\n    });\n  }\n\n  async generateJoinedConfig(): Promise<IBrowserConfig> {\n    try {\n      const remoteConfig =\n        this.remoteConfigFetch &&\n        (await this.remoteConfigFetch.getRemoteConfig('analyticsSDK', 'browserSDK', this.config.sessionId));\n      this.config.loggerProvider.debug('Remote configuration:', JSON.stringify(remoteConfig, null, 2));\n\n      // merge remoteConfig.autocapture and this.config.autocapture\n      // if a field is in remoteConfig.autocapture, use that value\n      // if a field is not in remoteConfig.autocapture, use the value from this.config.autocapture\n      if (remoteConfig && 'autocapture' in remoteConfig) {\n        if (typeof remoteConfig.autocapture === 'boolean') {\n          this.config.autocapture = remoteConfig.autocapture;\n        }\n\n        if (typeof remoteConfig.autocapture === 'object') {\n          const transformedAutocaptureRemoteConfig = { ...remoteConfig.autocapture };\n\n          if (this.config.autocapture === undefined) {\n            this.config.autocapture = remoteConfig.autocapture;\n          }\n\n          // Handle Element Interactions config initialization\n          if (\n            typeof remoteConfig.autocapture.elementInteractions === 'object' &&\n            remoteConfig.autocapture.elementInteractions.pageUrlAllowlistRegex?.length\n          ) {\n            transformedAutocaptureRemoteConfig.elementInteractions = {\n              ...remoteConfig.autocapture.elementInteractions,\n            };\n            const transformedRcElementInteractions = transformedAutocaptureRemoteConfig.elementInteractions;\n\n            const exactAllowList = transformedRcElementInteractions.pageUrlAllowlist ?? [];\n            // Convert string patterns to RegExp objects, warn on invalid patterns and skip them\n            const regexList = [];\n            for (const pattern of remoteConfig.autocapture.elementInteractions.pageUrlAllowlistRegex) {\n              try {\n                regexList.push(new RegExp(pattern));\n              } catch (regexError) {\n                this.config.loggerProvider.warn(`Invalid regex pattern: ${pattern}`, regexError);\n              }\n            }\n\n            const combinedPageUrlAllowlist = exactAllowList.concat(regexList);\n\n            transformedRcElementInteractions.pageUrlAllowlist = combinedPageUrlAllowlist;\n            delete transformedRcElementInteractions.pageUrlAllowlistRegex;\n          }\n\n          if (typeof this.config.autocapture === 'boolean') {\n            this.config.autocapture = {\n              attribution: this.config.autocapture,\n              fileDownloads: this.config.autocapture,\n              formInteractions: this.config.autocapture,\n              pageViews: this.config.autocapture,\n              sessions: this.config.autocapture,\n              elementInteractions: this.config.autocapture,\n              ...transformedAutocaptureRemoteConfig,\n            };\n          }\n\n          if (typeof this.config.autocapture === 'object') {\n            this.config.autocapture = {\n              ...this.config.autocapture,\n              ...transformedAutocaptureRemoteConfig,\n            };\n          }\n        }\n\n        // Override default tracking options if autocapture is updated by remote config\n        this.config.defaultTracking = this.config.autocapture;\n      }\n\n      this.config.loggerProvider.debug('Joined configuration: ', JSON.stringify(this.config, null, 2));\n      this.config.requestMetadata ??= new RequestMetadata();\n      if (this.remoteConfigFetch?.metrics.fetchTimeAPISuccess) {\n        this.config.requestMetadata.recordHistogram(\n          'remote_config_fetch_time_API_success',\n          this.remoteConfigFetch.metrics.fetchTimeAPISuccess,\n        );\n      }\n      if (this.remoteConfigFetch?.metrics.fetchTimeAPIFail) {\n        this.config.requestMetadata.recordHistogram(\n          'remote_config_fetch_time_API_fail',\n          this.remoteConfigFetch.metrics.fetchTimeAPIFail,\n        );\n      }\n    } catch (e) {\n      this.config.loggerProvider.error('Failed to fetch remote configuration because of error: ', e);\n    }\n\n    return this.config;\n  }\n}\n\nexport const createBrowserJoinedConfigGenerator = async (localConfig: IBrowserConfig) => {\n  const joinedConfigGenerator = new BrowserJoinedConfigGenerator(localConfig);\n  await joinedConfigGenerator.initialize();\n  return joinedConfigGenerator;\n};\n","export var PLUGIN_NAME = '@amplitude/plugin-autocapture-browser';\nexport var AMPLITUDE_ELEMENT_CLICKED_EVENT = '[Amplitude] Element Clicked';\nexport var AMPLITUDE_ELEMENT_CHANGED_EVENT = '[Amplitude] Element Changed';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_ID = '[Amplitude] Element ID';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_CLASS = '[Amplitude] Element Class';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_TAG = '[Amplitude] Element Tag';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_TEXT = '[Amplitude] Element Text';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_HIERARCHY = '[Amplitude] Element Hierarchy';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_HREF = '[Amplitude] Element Href';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_POSITION_LEFT = '[Amplitude] Element Position Left';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_POSITION_TOP = '[Amplitude] Element Position Top';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_ARIA_LABEL = '[Amplitude] Element Aria Label';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_ATTRIBUTES = '[Amplitude] Element Attributes';\nexport var AMPLITUDE_EVENT_PROP_ELEMENT_PARENT_LABEL = '[Amplitude] Element Parent Label';\nexport var AMPLITUDE_EVENT_PROP_PAGE_URL = '[Amplitude] Page URL';\nexport var AMPLITUDE_EVENT_PROP_PAGE_TITLE = '[Amplitude] Page Title';\nexport var AMPLITUDE_EVENT_PROP_VIEWPORT_HEIGHT = '[Amplitude] Viewport Height';\nexport var AMPLITUDE_EVENT_PROP_VIEWPORT_WIDTH = '[Amplitude] Viewport Width';\n// Visual Tagging related constants\nexport var AMPLITUDE_ORIGIN = 'https://app.amplitude.com';\nexport var AMPLITUDE_ORIGIN_EU = 'https://app.eu.amplitude.com';\nexport var AMPLITUDE_ORIGIN_STAGING = 'https://apps.stag2.amplitude.com';\nexport var AMPLITUDE_ORIGINS_MAP = {\n    US: AMPLITUDE_ORIGIN,\n    EU: AMPLITUDE_ORIGIN_EU,\n    STAGING: AMPLITUDE_ORIGIN_STAGING,\n};\nexport var AMPLITUDE_VISUAL_TAGGING_SELECTOR_SCRIPT_URL = 'https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz';\n// This is the class name used by the visual tagging selector to highlight the selected element.\n// Should not use this class in the selector.\nexport var AMPLITUDE_VISUAL_TAGGING_HIGHLIGHT_CLASS = 'amp-visual-tagging-selector-highlight';\n//# sourceMappingURL=constants.js.map","export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","import { config } from '../config';\nvar context = null;\nexport function errorContext(cb) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        var isRoot = !context;\n        if (isRoot) {\n            context = { errorThrown: false, error: null };\n        }\n        cb();\n        if (isRoot) {\n            var _a = context, errorThrown = _a.errorThrown, error = _a.error;\n            context = null;\n            if (errorThrown) {\n                throw error;\n            }\n        }\n    }\n    else {\n        cb();\n    }\n}\nexport function captureError(err) {\n    if (config.useDeprecatedSynchronousErrorHandling && context) {\n        context.errorThrown = true;\n        context.error = err;\n    }\n}\n//# sourceMappingURL=errorContext.js.map","import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","export var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","export function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map","import { identity } from './identity';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map","import { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription } from './Subscription';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nimport { errorContext } from './util/errorContext';\nvar Observable = (function () {\n    function Observable(subscribe) {\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var _this = this;\n        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n        errorContext(function () {\n            var _a = _this, operator = _a.operator, source = _a.source;\n            subscriber.add(operator\n                ?\n                    operator.call(subscriber, source)\n                : source\n                    ?\n                        _this._subscribe(subscriber)\n                    :\n                        _this._trySubscribe(subscriber));\n        });\n        return subscriber;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.error(err);\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscriber = new SafeSubscriber({\n                next: function (value) {\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscriber.unsubscribe();\n                    }\n                },\n                error: reject,\n                complete: resolve,\n            });\n            _this.subscribe(subscriber);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var _a;\n        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    var _a;\n    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : config.Promise) !== null && _a !== void 0 ? _a : Promise;\n}\nfunction isObserver(value) {\n    return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\nfunction isSubscriber(value) {\n    return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n//# sourceMappingURL=Observable.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { __extends } from \"tslib\";\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { hasLift } from '../util/lift';\nvar ConnectableObservable = (function (_super) {\n    __extends(ConnectableObservable, _super);\n    function ConnectableObservable(source, subjectFactory) {\n        var _this = _super.call(this) || this;\n        _this.source = source;\n        _this.subjectFactory = subjectFactory;\n        _this._subject = null;\n        _this._refCount = 0;\n        _this._connection = null;\n        if (hasLift(source)) {\n            _this.lift = source.lift;\n        }\n        return _this;\n    }\n    ConnectableObservable.prototype._subscribe = function (subscriber) {\n        return this.getSubject().subscribe(subscriber);\n    };\n    ConnectableObservable.prototype.getSubject = function () {\n        var subject = this._subject;\n        if (!subject || subject.isStopped) {\n            this._subject = this.subjectFactory();\n        }\n        return this._subject;\n    };\n    ConnectableObservable.prototype._teardown = function () {\n        this._refCount = 0;\n        var _connection = this._connection;\n        this._subject = this._connection = null;\n        _connection === null || _connection === void 0 ? void 0 : _connection.unsubscribe();\n    };\n    ConnectableObservable.prototype.connect = function () {\n        var _this = this;\n        var connection = this._connection;\n        if (!connection) {\n            connection = this._connection = new Subscription();\n            var subject_1 = this.getSubject();\n            connection.add(this.source.subscribe(createOperatorSubscriber(subject_1, undefined, function () {\n                _this._teardown();\n                subject_1.complete();\n            }, function (err) {\n                _this._teardown();\n                subject_1.error(err);\n            }, function () { return _this._teardown(); })));\n            if (connection.closed) {\n                this._connection = null;\n                connection = Subscription.EMPTY;\n            }\n        }\n        return connection;\n    };\n    ConnectableObservable.prototype.refCount = function () {\n        return higherOrderRefCount()(this);\n    };\n    return ConnectableObservable;\n}(Observable));\nexport { ConnectableObservable };\n//# sourceMappingURL=ConnectableObservable.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function refCount() {\n    return operate(function (source, subscriber) {\n        var connection = null;\n        source._refCount++;\n        var refCounter = createOperatorSubscriber(subscriber, undefined, undefined, undefined, function () {\n            if (!source || source._refCount <= 0 || 0 < --source._refCount) {\n                connection = null;\n                return;\n            }\n            var sharedConnection = source._connection;\n            var conn = connection;\n            connection = null;\n            if (sharedConnection && (!conn || sharedConnection === conn)) {\n                sharedConnection.unsubscribe();\n            }\n            subscriber.unsubscribe();\n        });\n        source.subscribe(refCounter);\n        if (!refCounter.closed) {\n            connection = source.connect();\n        }\n    });\n}\n//# sourceMappingURL=refCount.js.map","export var performanceTimestampProvider = {\n    now: function () {\n        return (performanceTimestampProvider.delegate || performance).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=performanceTimestampProvider.js.map","import { Observable } from '../../Observable';\nimport { performanceTimestampProvider } from '../../scheduler/performanceTimestampProvider';\nimport { animationFrameProvider } from '../../scheduler/animationFrameProvider';\nexport function animationFrames(timestampProvider) {\n    return timestampProvider ? animationFramesFactory(timestampProvider) : DEFAULT_ANIMATION_FRAMES;\n}\nfunction animationFramesFactory(timestampProvider) {\n    return new Observable(function (subscriber) {\n        var provider = timestampProvider || performanceTimestampProvider;\n        var start = provider.now();\n        var id = 0;\n        var run = function () {\n            if (!subscriber.closed) {\n                id = animationFrameProvider.requestAnimationFrame(function (timestamp) {\n                    id = 0;\n                    var now = provider.now();\n                    subscriber.next({\n                        timestamp: timestampProvider ? now : timestamp,\n                        elapsed: now - start,\n                    });\n                    run();\n                });\n            }\n        };\n        run();\n        return function () {\n            if (id) {\n                animationFrameProvider.cancelAnimationFrame(id);\n            }\n        };\n    });\n}\nvar DEFAULT_ANIMATION_FRAMES = animationFramesFactory();\n//# sourceMappingURL=animationFrames.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { Subscription } from '../Subscription';\nexport var animationFrameProvider = {\n    schedule: function (callback) {\n        var request = requestAnimationFrame;\n        var cancel = cancelAnimationFrame;\n        var delegate = animationFrameProvider.delegate;\n        if (delegate) {\n            request = delegate.requestAnimationFrame;\n            cancel = delegate.cancelAnimationFrame;\n        }\n        var handle = request(function (timestamp) {\n            cancel = undefined;\n            callback(timestamp);\n        });\n        return new Subscription(function () { return cancel === null || cancel === void 0 ? void 0 : cancel(handle); });\n    },\n    requestAnimationFrame: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = animationFrameProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.requestAnimationFrame) || requestAnimationFrame).apply(void 0, __spreadArray([], __read(args)));\n    },\n    cancelAnimationFrame: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = animationFrameProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.cancelAnimationFrame) || cancelAnimationFrame).apply(void 0, __spreadArray([], __read(args)));\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=animationFrameProvider.js.map","import { createErrorClass } from './createErrorClass';\nexport var ObjectUnsubscribedError = createErrorClass(function (_super) {\n    return function ObjectUnsubscribedErrorImpl() {\n        _super(this);\n        this.name = 'ObjectUnsubscribedError';\n        this.message = 'object unsubscribed';\n    };\n});\n//# sourceMappingURL=ObjectUnsubscribedError.js.map","import { __extends, __values } from \"tslib\";\nimport { Observable } from './Observable';\nimport { Subscription, EMPTY_SUBSCRIPTION } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { arrRemove } from './util/arrRemove';\nimport { errorContext } from './util/errorContext';\nvar Subject = (function (_super) {\n    __extends(Subject, _super);\n    function Subject() {\n        var _this = _super.call(this) || this;\n        _this.closed = false;\n        _this.currentObservers = null;\n        _this.observers = [];\n        _this.isStopped = false;\n        _this.hasError = false;\n        _this.thrownError = null;\n        return _this;\n    }\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype._throwIfClosed = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n    };\n    Subject.prototype.next = function (value) {\n        var _this = this;\n        errorContext(function () {\n            var e_1, _a;\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                if (!_this.currentObservers) {\n                    _this.currentObservers = Array.from(_this.observers);\n                }\n                try {\n                    for (var _b = __values(_this.currentObservers), _c = _b.next(); !_c.done; _c = _b.next()) {\n                        var observer = _c.value;\n                        observer.next(value);\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n            }\n        });\n    };\n    Subject.prototype.error = function (err) {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.hasError = _this.isStopped = true;\n                _this.thrownError = err;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().error(err);\n                }\n            }\n        });\n    };\n    Subject.prototype.complete = function () {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.isStopped = true;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().complete();\n                }\n            }\n        });\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = this.closed = true;\n        this.observers = this.currentObservers = null;\n    };\n    Object.defineProperty(Subject.prototype, \"observed\", {\n        get: function () {\n            var _a;\n            return ((_a = this.observers) === null || _a === void 0 ? void 0 : _a.length) > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Subject.prototype._trySubscribe = function (subscriber) {\n        this._throwIfClosed();\n        return _super.prototype._trySubscribe.call(this, subscriber);\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        this._throwIfClosed();\n        this._checkFinalizedStatuses(subscriber);\n        return this._innerSubscribe(subscriber);\n    };\n    Subject.prototype._innerSubscribe = function (subscriber) {\n        var _this = this;\n        var _a = this, hasError = _a.hasError, isStopped = _a.isStopped, observers = _a.observers;\n        if (hasError || isStopped) {\n            return EMPTY_SUBSCRIPTION;\n        }\n        this.currentObservers = null;\n        observers.push(subscriber);\n        return new Subscription(function () {\n            _this.currentObservers = null;\n            arrRemove(observers, subscriber);\n        });\n    };\n    Subject.prototype._checkFinalizedStatuses = function (subscriber) {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, isStopped = _a.isStopped;\n        if (hasError) {\n            subscriber.error(thrownError);\n        }\n        else if (isStopped) {\n            subscriber.complete();\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\nexport { Subject };\nvar AnonymousSubject = (function (_super) {\n    __extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        var _this = _super.call(this) || this;\n        _this.destination = destination;\n        _this.source = source;\n        return _this;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.next) === null || _b === void 0 ? void 0 : _b.call(_a, value);\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.error) === null || _b === void 0 ? void 0 : _b.call(_a, err);\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.complete) === null || _b === void 0 ? void 0 : _b.call(_a);\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var _a, _b;\n        return (_b = (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber)) !== null && _b !== void 0 ? _b : EMPTY_SUBSCRIPTION;\n    };\n    return AnonymousSubject;\n}(Subject));\nexport { AnonymousSubject };\n//# sourceMappingURL=Subject.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nvar BehaviorSubject = (function (_super) {\n    __extends(BehaviorSubject, _super);\n    function BehaviorSubject(_value) {\n        var _this = _super.call(this) || this;\n        _this._value = _value;\n        return _this;\n    }\n    Object.defineProperty(BehaviorSubject.prototype, \"value\", {\n        get: function () {\n            return this.getValue();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BehaviorSubject.prototype._subscribe = function (subscriber) {\n        var subscription = _super.prototype._subscribe.call(this, subscriber);\n        !subscription.closed && subscriber.next(this._value);\n        return subscription;\n    };\n    BehaviorSubject.prototype.getValue = function () {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, _value = _a._value;\n        if (hasError) {\n            throw thrownError;\n        }\n        this._throwIfClosed();\n        return _value;\n    };\n    BehaviorSubject.prototype.next = function (value) {\n        _super.prototype.next.call(this, (this._value = value));\n    };\n    return BehaviorSubject;\n}(Subject));\nexport { BehaviorSubject };\n//# sourceMappingURL=BehaviorSubject.js.map","export var dateTimestampProvider = {\n    now: function () {\n        return (dateTimestampProvider.delegate || Date).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=dateTimestampProvider.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar ReplaySubject = (function (_super) {\n    __extends(ReplaySubject, _super);\n    function ReplaySubject(_bufferSize, _windowTime, _timestampProvider) {\n        if (_bufferSize === void 0) { _bufferSize = Infinity; }\n        if (_windowTime === void 0) { _windowTime = Infinity; }\n        if (_timestampProvider === void 0) { _timestampProvider = dateTimestampProvider; }\n        var _this = _super.call(this) || this;\n        _this._bufferSize = _bufferSize;\n        _this._windowTime = _windowTime;\n        _this._timestampProvider = _timestampProvider;\n        _this._buffer = [];\n        _this._infiniteTimeWindow = true;\n        _this._infiniteTimeWindow = _windowTime === Infinity;\n        _this._bufferSize = Math.max(1, _bufferSize);\n        _this._windowTime = Math.max(1, _windowTime);\n        return _this;\n    }\n    ReplaySubject.prototype.next = function (value) {\n        var _a = this, isStopped = _a.isStopped, _buffer = _a._buffer, _infiniteTimeWindow = _a._infiniteTimeWindow, _timestampProvider = _a._timestampProvider, _windowTime = _a._windowTime;\n        if (!isStopped) {\n            _buffer.push(value);\n            !_infiniteTimeWindow && _buffer.push(_timestampProvider.now() + _windowTime);\n        }\n        this._trimBuffer();\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype._subscribe = function (subscriber) {\n        this._throwIfClosed();\n        this._trimBuffer();\n        var subscription = this._innerSubscribe(subscriber);\n        var _a = this, _infiniteTimeWindow = _a._infiniteTimeWindow, _buffer = _a._buffer;\n        var copy = _buffer.slice();\n        for (var i = 0; i < copy.length && !subscriber.closed; i += _infiniteTimeWindow ? 1 : 2) {\n            subscriber.next(copy[i]);\n        }\n        this._checkFinalizedStatuses(subscriber);\n        return subscription;\n    };\n    ReplaySubject.prototype._trimBuffer = function () {\n        var _a = this, _bufferSize = _a._bufferSize, _timestampProvider = _a._timestampProvider, _buffer = _a._buffer, _infiniteTimeWindow = _a._infiniteTimeWindow;\n        var adjustedBufferSize = (_infiniteTimeWindow ? 1 : 2) * _bufferSize;\n        _bufferSize < Infinity && adjustedBufferSize < _buffer.length && _buffer.splice(0, _buffer.length - adjustedBufferSize);\n        if (!_infiniteTimeWindow) {\n            var now = _timestampProvider.now();\n            var last = 0;\n            for (var i = 1; i < _buffer.length && _buffer[i] <= now; i += 2) {\n                last = i;\n            }\n            last && _buffer.splice(0, last + 1);\n        }\n    };\n    return ReplaySubject;\n}(Subject));\nexport { ReplaySubject };\n//# sourceMappingURL=ReplaySubject.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nvar AsyncSubject = (function (_super) {\n    __extends(AsyncSubject, _super);\n    function AsyncSubject() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._value = null;\n        _this._hasValue = false;\n        _this._isComplete = false;\n        return _this;\n    }\n    AsyncSubject.prototype._checkFinalizedStatuses = function (subscriber) {\n        var _a = this, hasError = _a.hasError, _hasValue = _a._hasValue, _value = _a._value, thrownError = _a.thrownError, isStopped = _a.isStopped, _isComplete = _a._isComplete;\n        if (hasError) {\n            subscriber.error(thrownError);\n        }\n        else if (isStopped || _isComplete) {\n            _hasValue && subscriber.next(_value);\n            subscriber.complete();\n        }\n    };\n    AsyncSubject.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._value = value;\n            this._hasValue = true;\n        }\n    };\n    AsyncSubject.prototype.complete = function () {\n        var _a = this, _hasValue = _a._hasValue, _value = _a._value, _isComplete = _a._isComplete;\n        if (!_isComplete) {\n            this._isComplete = true;\n            _hasValue && _super.prototype.next.call(this, _value);\n            _super.prototype.complete.call(this);\n        }\n    };\n    return AsyncSubject;\n}(Subject));\nexport { AsyncSubject };\n//# sourceMappingURL=AsyncSubject.js.map","import { __extends } from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = (function (_super) {\n    __extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map","var nextHandle = 1;\nvar resolved;\nvar activeHandles = {};\nfunction findAndClearHandle(handle) {\n    if (handle in activeHandles) {\n        delete activeHandles[handle];\n        return true;\n    }\n    return false;\n}\nexport var Immediate = {\n    setImmediate: function (cb) {\n        var handle = nextHandle++;\n        activeHandles[handle] = true;\n        if (!resolved) {\n            resolved = Promise.resolve();\n        }\n        resolved.then(function () { return findAndClearHandle(handle) && cb(); });\n        return handle;\n    },\n    clearImmediate: function (handle) {\n        findAndClearHandle(handle);\n    },\n};\nexport var TestTools = {\n    pending: function () {\n        return Object.keys(activeHandles).length;\n    }\n};\n//# sourceMappingURL=Immediate.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var intervalProvider = {\n    setInterval: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = intervalProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setInterval) {\n            return delegate.setInterval.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setInterval.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearInterval: function (handle) {\n        var delegate = intervalProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearInterval) || clearInterval)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=intervalProvider.js.map","import { __extends } from \"tslib\";\nimport { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nvar AsyncAction = (function (_super) {\n    __extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = (_a = this.id) !== null && _a !== void 0 ? _a : this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, _id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (_scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        if (id != null) {\n            intervalProvider.clearInterval(id);\n        }\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, _delay) {\n        var errored = false;\n        var errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            var _a = this, id = _a.id, scheduler = _a.scheduler;\n            var actions = scheduler.actions;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            _super.prototype.unsubscribe.call(this);\n        }\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { Immediate } from '../util/Immediate';\nvar setImmediate = Immediate.setImmediate, clearImmediate = Immediate.clearImmediate;\nexport var immediateProvider = {\n    setImmediate: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = immediateProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.setImmediate) || setImmediate).apply(void 0, __spreadArray([], __read(args)));\n    },\n    clearImmediate: function (handle) {\n        var delegate = immediateProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearImmediate) || clearImmediate)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=immediateProvider.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { immediateProvider } from './immediateProvider';\nvar AsapAction = (function (_super) {\n    __extends(AsapAction, _super);\n    function AsapAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    AsapAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay !== null && delay > 0) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.actions.push(this);\n        return scheduler._scheduled || (scheduler._scheduled = immediateProvider.setImmediate(scheduler.flush.bind(scheduler, undefined)));\n    };\n    AsapAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (delay != null ? delay > 0 : this.delay > 0) {\n            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);\n        }\n        var actions = scheduler.actions;\n        if (id != null && ((_a = actions[actions.length - 1]) === null || _a === void 0 ? void 0 : _a.id) !== id) {\n            immediateProvider.clearImmediate(id);\n            if (scheduler._scheduled === id) {\n                scheduler._scheduled = undefined;\n            }\n        }\n        return undefined;\n    };\n    return AsapAction;\n}(AsyncAction));\nexport { AsapAction };\n//# sourceMappingURL=AsapAction.js.map","import { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar Scheduler = (function () {\n    function Scheduler(schedulerActionCtor, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        this.schedulerActionCtor = schedulerActionCtor;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) { delay = 0; }\n        return new this.schedulerActionCtor(this, work).schedule(state, delay);\n    };\n    Scheduler.now = dateTimestampProvider.now;\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map","import { __extends } from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = (function (_super) {\n    __extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        var _this = _super.call(this, SchedulerAction, now) || this;\n        _this.actions = [];\n        _this._active = false;\n        return _this;\n    }\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this._active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this._active = true;\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions.shift()));\n        this._active = false;\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar AsapScheduler = (function (_super) {\n    __extends(AsapScheduler, _super);\n    function AsapScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AsapScheduler.prototype.flush = function (action) {\n        this._active = true;\n        var flushId = this._scheduled;\n        this._scheduled = undefined;\n        var actions = this.actions;\n        var error;\n        action = action || actions.shift();\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions[0]) && action.id === flushId && actions.shift());\n        this._active = false;\n        if (error) {\n            while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsapScheduler;\n}(AsyncScheduler));\nexport { AsapScheduler };\n//# sourceMappingURL=AsapScheduler.js.map","import { AsapAction } from './AsapAction';\nimport { AsapScheduler } from './AsapScheduler';\nexport var asapScheduler = new AsapScheduler(AsapAction);\nexport var asap = asapScheduler;\n//# sourceMappingURL=asap.js.map","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var asyncScheduler = new AsyncScheduler(AsyncAction);\nexport var async = asyncScheduler;\n//# sourceMappingURL=async.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nvar QueueAction = (function (_super) {\n    __extends(QueueAction, _super);\n    function QueueAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    QueueAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay > 0) {\n            return _super.prototype.schedule.call(this, state, delay);\n        }\n        this.delay = delay;\n        this.state = state;\n        this.scheduler.flush(this);\n        return this;\n    };\n    QueueAction.prototype.execute = function (state, delay) {\n        return delay > 0 || this.closed ? _super.prototype.execute.call(this, state, delay) : this._execute(state, delay);\n    };\n    QueueAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if ((delay != null && delay > 0) || (delay == null && this.delay > 0)) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.flush(this);\n        return 0;\n    };\n    return QueueAction;\n}(AsyncAction));\nexport { QueueAction };\n//# sourceMappingURL=QueueAction.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar QueueScheduler = (function (_super) {\n    __extends(QueueScheduler, _super);\n    function QueueScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return QueueScheduler;\n}(AsyncScheduler));\nexport { QueueScheduler };\n//# sourceMappingURL=QueueScheduler.js.map","import { QueueAction } from './QueueAction';\nimport { QueueScheduler } from './QueueScheduler';\nexport var queueScheduler = new QueueScheduler(QueueAction);\nexport var queue = queueScheduler;\n//# sourceMappingURL=queue.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { animationFrameProvider } from './animationFrameProvider';\nvar AnimationFrameAction = (function (_super) {\n    __extends(AnimationFrameAction, _super);\n    function AnimationFrameAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    AnimationFrameAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay !== null && delay > 0) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.actions.push(this);\n        return scheduler._scheduled || (scheduler._scheduled = animationFrameProvider.requestAnimationFrame(function () { return scheduler.flush(undefined); }));\n    };\n    AnimationFrameAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (delay != null ? delay > 0 : this.delay > 0) {\n            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);\n        }\n        var actions = scheduler.actions;\n        if (id != null && ((_a = actions[actions.length - 1]) === null || _a === void 0 ? void 0 : _a.id) !== id) {\n            animationFrameProvider.cancelAnimationFrame(id);\n            scheduler._scheduled = undefined;\n        }\n        return undefined;\n    };\n    return AnimationFrameAction;\n}(AsyncAction));\nexport { AnimationFrameAction };\n//# sourceMappingURL=AnimationFrameAction.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar AnimationFrameScheduler = (function (_super) {\n    __extends(AnimationFrameScheduler, _super);\n    function AnimationFrameScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AnimationFrameScheduler.prototype.flush = function (action) {\n        this._active = true;\n        var flushId = this._scheduled;\n        this._scheduled = undefined;\n        var actions = this.actions;\n        var error;\n        action = action || actions.shift();\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions[0]) && action.id === flushId && actions.shift());\n        this._active = false;\n        if (error) {\n            while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AnimationFrameScheduler;\n}(AsyncScheduler));\nexport { AnimationFrameScheduler };\n//# sourceMappingURL=AnimationFrameScheduler.js.map","import { AnimationFrameAction } from './AnimationFrameAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\nexport var animationFrameScheduler = new AnimationFrameScheduler(AnimationFrameAction);\nexport var animationFrame = animationFrameScheduler;\n//# sourceMappingURL=animationFrame.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\nvar VirtualTimeScheduler = (function (_super) {\n    __extends(VirtualTimeScheduler, _super);\n    function VirtualTimeScheduler(schedulerActionCtor, maxFrames) {\n        if (schedulerActionCtor === void 0) { schedulerActionCtor = VirtualAction; }\n        if (maxFrames === void 0) { maxFrames = Infinity; }\n        var _this = _super.call(this, schedulerActionCtor, function () { return _this.frame; }) || this;\n        _this.maxFrames = maxFrames;\n        _this.frame = 0;\n        _this.index = -1;\n        return _this;\n    }\n    VirtualTimeScheduler.prototype.flush = function () {\n        var _a = this, actions = _a.actions, maxFrames = _a.maxFrames;\n        var error;\n        var action;\n        while ((action = actions[0]) && action.delay <= maxFrames) {\n            actions.shift();\n            this.frame = action.delay;\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        }\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    VirtualTimeScheduler.frameTimeFactor = 10;\n    return VirtualTimeScheduler;\n}(AsyncScheduler));\nexport { VirtualTimeScheduler };\nvar VirtualAction = (function (_super) {\n    __extends(VirtualAction, _super);\n    function VirtualAction(scheduler, work, index) {\n        if (index === void 0) { index = (scheduler.index += 1); }\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.index = index;\n        _this.active = true;\n        _this.index = scheduler.index = index;\n        return _this;\n    }\n    VirtualAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (Number.isFinite(delay)) {\n            if (!this.id) {\n                return _super.prototype.schedule.call(this, state, delay);\n            }\n            this.active = false;\n            var action = new VirtualAction(this.scheduler, this.work);\n            this.add(action);\n            return action.schedule(state, delay);\n        }\n        else {\n            return Subscription.EMPTY;\n        }\n    };\n    VirtualAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        this.delay = scheduler.frame + delay;\n        var actions = scheduler.actions;\n        actions.push(this);\n        actions.sort(VirtualAction.sortActions);\n        return 1;\n    };\n    VirtualAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return undefined;\n    };\n    VirtualAction.prototype._execute = function (state, delay) {\n        if (this.active === true) {\n            return _super.prototype._execute.call(this, state, delay);\n        }\n    };\n    VirtualAction.sortActions = function (a, b) {\n        if (a.delay === b.delay) {\n            if (a.index === b.index) {\n                return 0;\n            }\n            else if (a.index > b.index) {\n                return 1;\n            }\n            else {\n                return -1;\n            }\n        }\n        else if (a.delay > b.delay) {\n            return 1;\n        }\n        else {\n            return -1;\n        }\n    };\n    return VirtualAction;\n}(AsyncAction));\nexport { VirtualAction };\n//# sourceMappingURL=VirtualTimeScheduler.js.map","import { Observable } from '../Observable';\nexport var EMPTY = new Observable(function (subscriber) { return subscriber.complete(); });\nexport function empty(scheduler) {\n    return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nfunction emptyScheduled(scheduler) {\n    return new Observable(function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });\n}\n//# sourceMappingURL=empty.js.map","import { isFunction } from './isFunction';\nexport function isScheduler(value) {\n    return value && isFunction(value.schedule);\n}\n//# sourceMappingURL=isScheduler.js.map","import { isFunction } from './isFunction';\nimport { isScheduler } from './isScheduler';\nfunction last(arr) {\n    return arr[arr.length - 1];\n}\nexport function popResultSelector(args) {\n    return isFunction(last(args)) ? args.pop() : undefined;\n}\nexport function popScheduler(args) {\n    return isScheduler(last(args)) ? args.pop() : undefined;\n}\nexport function popNumber(args, defaultValue) {\n    return typeof last(args) === 'number' ? args.pop() : defaultValue;\n}\n//# sourceMappingURL=args.js.map","export var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","import { isFunction } from \"./isFunction\";\nexport function isPromise(value) {\n    return isFunction(value === null || value === void 0 ? void 0 : value.then);\n}\n//# sourceMappingURL=isPromise.js.map","import { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\nexport function isInteropObservable(input) {\n    return isFunction(input[Symbol_observable]);\n}\n//# sourceMappingURL=isInteropObservable.js.map","import { isFunction } from './isFunction';\nexport function isAsyncIterable(obj) {\n    return Symbol.asyncIterator && isFunction(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);\n}\n//# sourceMappingURL=isAsyncIterable.js.map","export function createInvalidObservableTypeError(input) {\n    return new TypeError(\"You provided \" + (input !== null && typeof input === 'object' ? 'an invalid object' : \"'\" + input + \"'\") + \" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.\");\n}\n//# sourceMappingURL=throwUnobservableError.js.map","export function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = getSymbolIterator();\n//# sourceMappingURL=iterator.js.map","import { EMPTY } from './observable/empty';\nimport { of } from './observable/of';\nimport { throwError } from './observable/throwError';\nimport { isFunction } from './util/isFunction';\nexport var NotificationKind;\n(function (NotificationKind) {\n    NotificationKind[\"NEXT\"] = \"N\";\n    NotificationKind[\"ERROR\"] = \"E\";\n    NotificationKind[\"COMPLETE\"] = \"C\";\n})(NotificationKind || (NotificationKind = {}));\nvar Notification = (function () {\n    function Notification(kind, value, error) {\n        this.kind = kind;\n        this.value = value;\n        this.error = error;\n        this.hasValue = kind === 'N';\n    }\n    Notification.prototype.observe = function (observer) {\n        return observeNotification(this, observer);\n    };\n    Notification.prototype.do = function (nextHandler, errorHandler, completeHandler) {\n        var _a = this, kind = _a.kind, value = _a.value, error = _a.error;\n        return kind === 'N' ? nextHandler === null || nextHandler === void 0 ? void 0 : nextHandler(value) : kind === 'E' ? errorHandler === null || errorHandler === void 0 ? void 0 : errorHandler(error) : completeHandler === null || completeHandler === void 0 ? void 0 : completeHandler();\n    };\n    Notification.prototype.accept = function (nextOrObserver, error, complete) {\n        var _a;\n        return isFunction((_a = nextOrObserver) === null || _a === void 0 ? void 0 : _a.next)\n            ? this.observe(nextOrObserver)\n            : this.do(nextOrObserver, error, complete);\n    };\n    Notification.prototype.toObservable = function () {\n        var _a = this, kind = _a.kind, value = _a.value, error = _a.error;\n        var result = kind === 'N'\n            ?\n                of(value)\n            :\n                kind === 'E'\n                    ?\n                        throwError(function () { return error; })\n                    :\n                        kind === 'C'\n                            ?\n                                EMPTY\n                            :\n                                0;\n        if (!result) {\n            throw new TypeError(\"Unexpected notification kind \" + kind);\n        }\n        return result;\n    };\n    Notification.createNext = function (value) {\n        return new Notification('N', value);\n    };\n    Notification.createError = function (err) {\n        return new Notification('E', undefined, err);\n    };\n    Notification.createComplete = function () {\n        return Notification.completeNotification;\n    };\n    Notification.completeNotification = new Notification('C');\n    return Notification;\n}());\nexport { Notification };\nexport function observeNotification(notification, observer) {\n    var _a, _b, _c;\n    var _d = notification, kind = _d.kind, value = _d.value, error = _d.error;\n    if (typeof kind !== 'string') {\n        throw new TypeError('Invalid notification, missing \"kind\"');\n    }\n    kind === 'N' ? (_a = observer.next) === null || _a === void 0 ? void 0 : _a.call(observer, value) : kind === 'E' ? (_b = observer.error) === null || _b === void 0 ? void 0 : _b.call(observer, error) : (_c = observer.complete) === null || _c === void 0 ? void 0 : _c.call(observer);\n}\n//# sourceMappingURL=Notification.js.map","import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\nexport function isIterable(input) {\n    return isFunction(input === null || input === void 0 ? void 0 : input[Symbol_iterator]);\n}\n//# sourceMappingURL=isIterable.js.map","import { __asyncGenerator, __await, __generator } from \"tslib\";\nimport { isFunction } from './isFunction';\nexport function readableStreamLikeToAsyncGenerator(readableStream) {\n    return __asyncGenerator(this, arguments, function readableStreamLikeToAsyncGenerator_1() {\n        var reader, _a, value, done;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    reader = readableStream.getReader();\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, , 9, 10]);\n                    _b.label = 2;\n                case 2:\n                    if (!true) return [3, 8];\n                    return [4, __await(reader.read())];\n                case 3:\n                    _a = _b.sent(), value = _a.value, done = _a.done;\n                    if (!done) return [3, 5];\n                    return [4, __await(void 0)];\n                case 4: return [2, _b.sent()];\n                case 5: return [4, __await(value)];\n                case 6: return [4, _b.sent()];\n                case 7:\n                    _b.sent();\n                    return [3, 2];\n                case 8: return [3, 10];\n                case 9:\n                    reader.releaseLock();\n                    return [7];\n                case 10: return [2];\n            }\n        });\n    });\n}\nexport function isReadableStreamLike(obj) {\n    return isFunction(obj === null || obj === void 0 ? void 0 : obj.getReader);\n}\n//# sourceMappingURL=isReadableStreamLike.js.map","import { __asyncValues, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { Observable } from '../Observable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function innerFrom(input) {\n    if (input instanceof Observable) {\n        return input;\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromInteropObservable(input);\n        }\n        if (isArrayLike(input)) {\n            return fromArrayLike(input);\n        }\n        if (isPromise(input)) {\n            return fromPromise(input);\n        }\n        if (isAsyncIterable(input)) {\n            return fromAsyncIterable(input);\n        }\n        if (isIterable(input)) {\n            return fromIterable(input);\n        }\n        if (isReadableStreamLike(input)) {\n            return fromReadableStreamLike(input);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\nexport function fromInteropObservable(obj) {\n    return new Observable(function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (isFunction(obs.subscribe)) {\n            return obs.subscribe(subscriber);\n        }\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    });\n}\nexport function fromArrayLike(array) {\n    return new Observable(function (subscriber) {\n        for (var i = 0; i < array.length && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    });\n}\nexport function fromPromise(promise) {\n    return new Observable(function (subscriber) {\n        promise\n            .then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, reportUnhandledError);\n    });\n}\nexport function fromIterable(iterable) {\n    return new Observable(function (subscriber) {\n        var e_1, _a;\n        try {\n            for (var iterable_1 = __values(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {\n                var value = iterable_1_1.value;\n                subscriber.next(value);\n                if (subscriber.closed) {\n                    return;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        subscriber.complete();\n    });\n}\nexport function fromAsyncIterable(asyncIterable) {\n    return new Observable(function (subscriber) {\n        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });\n    });\n}\nexport function fromReadableStreamLike(readableStream) {\n    return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\nfunction process(asyncIterable, subscriber) {\n    var asyncIterable_1, asyncIterable_1_1;\n    var e_2, _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var value, e_2_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 5, 6, 11]);\n                    asyncIterable_1 = __asyncValues(asyncIterable);\n                    _b.label = 1;\n                case 1: return [4, asyncIterable_1.next()];\n                case 2:\n                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];\n                    value = asyncIterable_1_1.value;\n                    subscriber.next(value);\n                    if (subscriber.closed) {\n                        return [2];\n                    }\n                    _b.label = 3;\n                case 3: return [3, 1];\n                case 4: return [3, 11];\n                case 5:\n                    e_2_1 = _b.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3, 11];\n                case 6:\n                    _b.trys.push([6, , 9, 10]);\n                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];\n                    return [4, _a.call(asyncIterable_1)];\n                case 7:\n                    _b.sent();\n                    _b.label = 8;\n                case 8: return [3, 10];\n                case 9:\n                    if (e_2) throw e_2.error;\n                    return [7];\n                case 10: return [7];\n                case 11:\n                    subscriber.complete();\n                    return [2];\n            }\n        });\n    });\n}\n//# sourceMappingURL=innerFrom.js.map","export function executeSchedule(parentSubscription, scheduler, work, delay, repeat) {\n    if (delay === void 0) { delay = 0; }\n    if (repeat === void 0) { repeat = false; }\n    var scheduleSubscription = scheduler.schedule(function () {\n        work();\n        if (repeat) {\n            parentSubscription.add(this.schedule(null, delay));\n        }\n        else {\n            this.unsubscribe();\n        }\n    }, delay);\n    parentSubscription.add(scheduleSubscription);\n    if (!repeat) {\n        return scheduleSubscription;\n    }\n}\n//# sourceMappingURL=executeSchedule.js.map","import { executeSchedule } from '../util/executeSchedule';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function observeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return executeSchedule(subscriber, scheduler, function () { return subscriber.next(value); }, delay); }, function () { return executeSchedule(subscriber, scheduler, function () { return subscriber.complete(); }, delay); }, function (err) { return executeSchedule(subscriber, scheduler, function () { return subscriber.error(err); }, delay); }));\n    });\n}\n//# sourceMappingURL=observeOn.js.map","import { operate } from '../util/lift';\nexport function subscribeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        subscriber.add(scheduler.schedule(function () { return source.subscribe(subscriber); }, delay));\n    });\n}\n//# sourceMappingURL=subscribeOn.js.map","import { Observable } from '../Observable';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleAsyncIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    return new Observable(function (subscriber) {\n        executeSchedule(subscriber, scheduler, function () {\n            var iterator = input[Symbol.asyncIterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                iterator.next().then(function (result) {\n                    if (result.done) {\n                        subscriber.complete();\n                    }\n                    else {\n                        subscriber.next(result.value);\n                    }\n                });\n            }, 0, true);\n        });\n    });\n}\n//# sourceMappingURL=scheduleAsyncIterable.js.map","import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isReadableStreamLike } from '../util/isReadableStreamLike';\nimport { scheduleReadableStreamLike } from './scheduleReadableStreamLike';\nexport function scheduled(input, scheduler) {\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return scheduleObservable(input, scheduler);\n        }\n        if (isArrayLike(input)) {\n            return scheduleArray(input, scheduler);\n        }\n        if (isPromise(input)) {\n            return schedulePromise(input, scheduler);\n        }\n        if (isAsyncIterable(input)) {\n            return scheduleAsyncIterable(input, scheduler);\n        }\n        if (isIterable(input)) {\n            return scheduleIterable(input, scheduler);\n        }\n        if (isReadableStreamLike(input)) {\n            return scheduleReadableStreamLike(input, scheduler);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\n//# sourceMappingURL=scheduled.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function scheduleObservable(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=scheduleObservable.js.map","import { Observable } from '../Observable';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var i = 0;\n        return scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n            }\n            else {\n                subscriber.next(input[i++]);\n                if (!subscriber.closed) {\n                    this.schedule();\n                }\n            }\n        });\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function schedulePromise(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=schedulePromise.js.map","import { Observable } from '../Observable';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from '../util/isFunction';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleIterable(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var iterator;\n        executeSchedule(subscriber, scheduler, function () {\n            iterator = input[Symbol_iterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                var _a;\n                var value;\n                var done;\n                try {\n                    (_a = iterator.next(), value = _a.value, done = _a.done);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                    return;\n                }\n                if (done) {\n                    subscriber.complete();\n                }\n                else {\n                    subscriber.next(value);\n                }\n            }, 0, true);\n        });\n        return function () { return isFunction(iterator === null || iterator === void 0 ? void 0 : iterator.return) && iterator.return(); };\n    });\n}\n//# sourceMappingURL=scheduleIterable.js.map","import { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nexport function scheduleReadableStreamLike(input, scheduler) {\n    return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input), scheduler);\n}\n//# sourceMappingURL=scheduleReadableStreamLike.js.map","import { scheduled } from '../scheduled/scheduled';\nimport { innerFrom } from './innerFrom';\nexport function from(input, scheduler) {\n    return scheduler ? scheduled(input, scheduler) : innerFrom(input);\n}\n//# sourceMappingURL=from.js.map","export function isValidDate(value) {\n    return value instanceof Date && !isNaN(value);\n}\n//# sourceMappingURL=isDate.js.map","import { createErrorClass } from './createErrorClass';\nexport var EmptyError = createErrorClass(function (_super) { return function EmptyErrorImpl() {\n    _super(this);\n    this.name = 'EmptyError';\n    this.message = 'no elements in sequence';\n}; });\n//# sourceMappingURL=EmptyError.js.map","import { createErrorClass } from './createErrorClass';\nexport var ArgumentOutOfRangeError = createErrorClass(function (_super) {\n    return function ArgumentOutOfRangeErrorImpl() {\n        _super(this);\n        this.name = 'ArgumentOutOfRangeError';\n        this.message = 'argument out of range';\n    };\n});\n//# sourceMappingURL=ArgumentOutOfRangeError.js.map","import { createErrorClass } from './createErrorClass';\nexport var NotFoundError = createErrorClass(function (_super) {\n    return function NotFoundErrorImpl(message) {\n        _super(this);\n        this.name = 'NotFoundError';\n        this.message = message;\n    };\n});\n//# sourceMappingURL=NotFoundError.js.map","import { createErrorClass } from './createErrorClass';\nexport var SequenceError = createErrorClass(function (_super) {\n    return function SequenceErrorImpl(message) {\n        _super(this);\n        this.name = 'SequenceError';\n        this.message = message;\n    };\n});\n//# sourceMappingURL=SequenceError.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n    return function TimeoutErrorImpl(info) {\n        if (info === void 0) { info = null; }\n        _super(this);\n        this.message = 'Timeout has occurred';\n        this.name = 'TimeoutError';\n        this.info = info;\n    };\n});\nexport function timeout(config, schedulerArg) {\n    var _a = (isValidDate(config) ? { first: config } : typeof config === 'number' ? { each: config } : config), first = _a.first, each = _a.each, _b = _a.with, _with = _b === void 0 ? timeoutErrorFactory : _b, _c = _a.scheduler, scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c, _d = _a.meta, meta = _d === void 0 ? null : _d;\n    if (first == null && each == null) {\n        throw new TypeError('No timeout provided.');\n    }\n    return operate(function (source, subscriber) {\n        var originalSourceSubscription;\n        var timerSubscription;\n        var lastValue = null;\n        var seen = 0;\n        var startTimer = function (delay) {\n            timerSubscription = executeSchedule(subscriber, scheduler, function () {\n                try {\n                    originalSourceSubscription.unsubscribe();\n                    innerFrom(_with({\n                        meta: meta,\n                        lastValue: lastValue,\n                        seen: seen,\n                    })).subscribe(subscriber);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }, delay);\n        };\n        originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            seen++;\n            subscriber.next((lastValue = value));\n            each > 0 && startTimer(each);\n        }, undefined, undefined, function () {\n            if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n                timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            }\n            lastValue = null;\n        }));\n        !seen && startTimer(first != null ? (typeof first === 'number' ? first : +first - scheduler.now()) : each);\n    });\n}\nfunction timeoutErrorFactory(info) {\n    throw new TimeoutError(info);\n}\n//# sourceMappingURL=timeout.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { map } from \"../operators/map\";\nvar isArray = Array.isArray;\nfunction callOrApply(fn, args) {\n    return isArray(args) ? fn.apply(void 0, __spreadArray([], __read(args))) : fn(args);\n}\nexport function mapOneOrManyArgs(fn) {\n    return map(function (args) { return callOrApply(fn, args); });\n}\n//# sourceMappingURL=mapOneOrManyArgs.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalFinalizer) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(createOperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        if (innerSubScheduler) {\n                            executeSchedule(subscriber, innerSubScheduler, function () { return doInnerSub(bufferedValue); });\n                        }\n                        else {\n                            doInnerSub(bufferedValue);\n                        }\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(createOperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalFinalizer === null || additionalFinalizer === void 0 ? void 0 : additionalFinalizer();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nexport function mergeAll(concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    return mergeMap(identity, concurrent);\n}\n//# sourceMappingURL=mergeAll.js.map","import { mergeAll } from './mergeAll';\nexport function concatAll() {\n    return mergeAll(1);\n}\n//# sourceMappingURL=concatAll.js.map","import { __read } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Observable } from '../Observable';\nimport { mergeMap } from '../operators/mergeMap';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isFunction } from '../util/isFunction';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nvar nodeEventEmitterMethods = ['addListener', 'removeListener'];\nvar eventTargetMethods = ['addEventListener', 'removeEventListener'];\nvar jqueryMethods = ['on', 'off'];\nexport function fromEvent(target, eventName, options, resultSelector) {\n    if (isFunction(options)) {\n        resultSelector = options;\n        options = undefined;\n    }\n    if (resultSelector) {\n        return fromEvent(target, eventName, options).pipe(mapOneOrManyArgs(resultSelector));\n    }\n    var _a = __read(isEventTarget(target)\n        ? eventTargetMethods.map(function (methodName) { return function (handler) { return target[methodName](eventName, handler, options); }; })\n        :\n            isNodeStyleEventEmitter(target)\n                ? nodeEventEmitterMethods.map(toCommonHandlerRegistry(target, eventName))\n                : isJQueryStyleEventEmitter(target)\n                    ? jqueryMethods.map(toCommonHandlerRegistry(target, eventName))\n                    : [], 2), add = _a[0], remove = _a[1];\n    if (!add) {\n        if (isArrayLike(target)) {\n            return mergeMap(function (subTarget) { return fromEvent(subTarget, eventName, options); })(innerFrom(target));\n        }\n    }\n    if (!add) {\n        throw new TypeError('Invalid event target');\n    }\n    return new Observable(function (subscriber) {\n        var handler = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return subscriber.next(1 < args.length ? args : args[0]);\n        };\n        add(handler);\n        return function () { return remove(handler); };\n    });\n}\nfunction toCommonHandlerRegistry(target, eventName) {\n    return function (methodName) { return function (handler) { return target[methodName](eventName, handler); }; };\n}\nfunction isNodeStyleEventEmitter(target) {\n    return isFunction(target.addListener) && isFunction(target.removeListener);\n}\nfunction isJQueryStyleEventEmitter(target) {\n    return isFunction(target.on) && isFunction(target.off);\n}\nfunction isEventTarget(target) {\n    return isFunction(target.addEventListener) && isFunction(target.removeEventListener);\n}\n//# sourceMappingURL=fromEvent.js.map","import { mergeAll } from '../operators/mergeAll';\nimport { innerFrom } from './innerFrom';\nimport { EMPTY } from './empty';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from './from';\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var concurrent = popNumber(args, Infinity);\n    var sources = args;\n    return !sources.length\n        ?\n            EMPTY\n        : sources.length === 1\n            ?\n                innerFrom(sources[0])\n            :\n                mergeAll(concurrent)(from(sources, scheduler));\n}\n//# sourceMappingURL=merge.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function filter(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return predicate.call(thisArg, value, index++) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=filter.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { concat } from '../observable/concat';\nimport { take } from './take';\nimport { ignoreElements } from './ignoreElements';\nimport { mapTo } from './mapTo';\nimport { mergeMap } from './mergeMap';\nimport { innerFrom } from '../observable/innerFrom';\nexport function delayWhen(delayDurationSelector, subscriptionDelay) {\n    if (subscriptionDelay) {\n        return function (source) {\n            return concat(subscriptionDelay.pipe(take(1), ignoreElements()), source.pipe(delayWhen(delayDurationSelector)));\n        };\n    }\n    return mergeMap(function (value, index) { return innerFrom(delayDurationSelector(value, index)).pipe(take(1), mapTo(value)); });\n}\n//# sourceMappingURL=delayWhen.js.map","import { concatAll } from '../operators/concatAll';\nimport { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function concat() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return concatAll()(from(args, popScheduler(args)));\n}\n//# sourceMappingURL=concat.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nexport function ignoreElements() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, noop));\n    });\n}\n//# sourceMappingURL=ignoreElements.js.map","import { map } from './map';\nexport function mapTo(value) {\n    return map(function () { return value; });\n}\n//# sourceMappingURL=mapTo.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { delayWhen } from './delayWhen';\nimport { timer } from '../observable/timer';\nexport function delay(due, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration = timer(due, scheduler);\n    return delayWhen(function () { return duration; });\n}\n//# sourceMappingURL=delay.js.map","import { Observable } from '../Observable';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\nexport function timer(dueTime, intervalOrScheduler, scheduler) {\n    if (dueTime === void 0) { dueTime = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var intervalDuration = -1;\n    if (intervalOrScheduler != null) {\n        if (isScheduler(intervalOrScheduler)) {\n            scheduler = intervalOrScheduler;\n        }\n        else {\n            intervalDuration = intervalOrScheduler;\n        }\n    }\n    return new Observable(function (subscriber) {\n        var due = isValidDate(dueTime) ? +dueTime - scheduler.now() : dueTime;\n        if (due < 0) {\n            due = 0;\n        }\n        var n = 0;\n        return scheduler.schedule(function () {\n            if (!subscriber.closed) {\n                subscriber.next(n++);\n                if (0 <= intervalDuration) {\n                    this.schedule(undefined, intervalDuration);\n                }\n                else {\n                    subscriber.complete();\n                }\n            }\n        }, due);\n    });\n}\n//# sourceMappingURL=timer.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share(options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.connector, connector = _a === void 0 ? function () { return new Subject(); } : _a, _b = options.resetOnError, resetOnError = _b === void 0 ? true : _b, _c = options.resetOnComplete, resetOnComplete = _c === void 0 ? true : _c, _d = options.resetOnRefCountZero, resetOnRefCountZero = _d === void 0 ? true : _d;\n    return function (wrapperSource) {\n        var connection;\n        var resetConnection;\n        var subject;\n        var refCount = 0;\n        var hasCompleted = false;\n        var hasErrored = false;\n        var cancelReset = function () {\n            resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n            resetConnection = undefined;\n        };\n        var reset = function () {\n            cancelReset();\n            connection = subject = undefined;\n            hasCompleted = hasErrored = false;\n        };\n        var resetAndUnsubscribe = function () {\n            var conn = connection;\n            reset();\n            conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n        };\n        return operate(function (source, subscriber) {\n            refCount++;\n            if (!hasErrored && !hasCompleted) {\n                cancelReset();\n            }\n            var dest = (subject = subject !== null && subject !== void 0 ? subject : connector());\n            subscriber.add(function () {\n                refCount--;\n                if (refCount === 0 && !hasErrored && !hasCompleted) {\n                    resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n                }\n            });\n            dest.subscribe(subscriber);\n            if (!connection &&\n                refCount > 0) {\n                connection = new SafeSubscriber({\n                    next: function (value) { return dest.next(value); },\n                    error: function (err) {\n                        hasErrored = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnError, err);\n                        dest.error(err);\n                    },\n                    complete: function () {\n                        hasCompleted = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnComplete);\n                        dest.complete();\n                    },\n                });\n                innerFrom(source).subscribe(connection);\n            }\n        })(wrapperSource);\n    };\n}\nfunction handleReset(reset, on) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    if (on === true) {\n        reset();\n        return;\n    }\n    if (on === false) {\n        return;\n    }\n    var onSubscriber = new SafeSubscriber({\n        next: function () {\n            onSubscriber.unsubscribe();\n            reset();\n        },\n    });\n    return innerFrom(on.apply(void 0, __spreadArray([], __read(args)))).subscribe(onSubscriber);\n}\n//# sourceMappingURL=share.js.map","import { Observable } from '../Observable';\nimport { noop } from '../util/noop';\nexport var NEVER = new Observable(noop);\nexport function never() {\n    return NEVER;\n}\n//# sourceMappingURL=never.js.map","/* eslint-disable no-restricted-globals */\nimport * as constants from './constants';\nvar SENSITIVE_TAGS = ['input', 'select', 'textarea'];\nexport var createShouldTrackEvent = function (autocaptureOptions, allowlist) {\n    return function (actionType, element) {\n        var _a, _b, _c;\n        var pageUrlAllowlist = autocaptureOptions.pageUrlAllowlist, shouldTrackEventResolver = autocaptureOptions.shouldTrackEventResolver;\n        /* istanbul ignore next */\n        var tag = (_b = (_a = element === null || element === void 0 ? void 0 : element.tagName) === null || _a === void 0 ? void 0 : _a.toLowerCase) === null || _b === void 0 ? void 0 : _b.call(_a);\n        // window, document, and Text nodes have no tag\n        if (!tag) {\n            return false;\n        }\n        if (shouldTrackEventResolver) {\n            return shouldTrackEventResolver(actionType, element);\n        }\n        if (!isPageUrlAllowed(window.location.href, pageUrlAllowlist)) {\n            return false;\n        }\n        /* istanbul ignore next */\n        var elementType = String(element === null || element === void 0 ? void 0 : element.getAttribute('type')) || '';\n        if (typeof elementType === 'string') {\n            switch (elementType.toLowerCase()) {\n                case 'hidden':\n                    return false;\n                case 'password':\n                    return false;\n            }\n        }\n        /* istanbul ignore if */\n        if (allowlist) {\n            var hasMatchAnyAllowedSelector = allowlist.some(function (selector) { var _a; return !!((_a = element === null || element === void 0 ? void 0 : element.matches) === null || _a === void 0 ? void 0 : _a.call(element, selector)); });\n            if (!hasMatchAnyAllowedSelector) {\n                return false;\n            }\n        }\n        switch (tag) {\n            case 'input':\n            case 'select':\n            case 'textarea':\n                return actionType === 'change' || actionType === 'click';\n            default: {\n                /* istanbul ignore next */\n                var computedStyle = (_c = window === null || window === void 0 ? void 0 : window.getComputedStyle) === null || _c === void 0 ? void 0 : _c.call(window, element);\n                /* istanbul ignore next */\n                if (computedStyle && computedStyle.getPropertyValue('cursor') === 'pointer' && actionType === 'click') {\n                    return true;\n                }\n                return actionType === 'click';\n            }\n        }\n    };\n};\nexport var isNonSensitiveString = function (text) {\n    if (text == null) {\n        return false;\n    }\n    if (typeof text === 'string') {\n        var ccRegex = /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;\n        if (ccRegex.test((text || '').replace(/[- ]/g, ''))) {\n            return false;\n        }\n        var ssnRegex = /(^\\d{3}-?\\d{2}-?\\d{4}$)/;\n        if (ssnRegex.test(text)) {\n            return false;\n        }\n    }\n    return true;\n};\nexport var isTextNode = function (node) {\n    return !!node && node.nodeType === 3;\n};\nexport var isNonSensitiveElement = function (element) {\n    var _a, _b, _c;\n    /* istanbul ignore next */\n    var tag = (_b = (_a = element === null || element === void 0 ? void 0 : element.tagName) === null || _a === void 0 ? void 0 : _a.toLowerCase) === null || _b === void 0 ? void 0 : _b.call(_a);\n    var isContentEditable = element instanceof HTMLElement ? ((_c = element.getAttribute('contenteditable')) === null || _c === void 0 ? void 0 : _c.toLowerCase()) === 'true' : false;\n    return !SENSITIVE_TAGS.includes(tag) && !isContentEditable;\n};\n// Maybe this can be simplified with element.innerText, keep and manual concatenating for now, more research needed.\nexport var getText = function (element) {\n    var text = '';\n    if (isNonSensitiveElement(element) && element.childNodes && element.childNodes.length) {\n        element.childNodes.forEach(function (child) {\n            var childText = '';\n            if (isTextNode(child)) {\n                if (child.textContent) {\n                    childText = child.textContent;\n                }\n            }\n            else {\n                childText = getText(child);\n            }\n            text += childText\n                .split(/(\\s+)/)\n                .filter(isNonSensitiveString)\n                .join('')\n                .replace(/[\\r\\n]/g, ' ')\n                .replace(/[ ]+/g, ' ')\n                .substring(0, 255);\n        });\n    }\n    return text;\n};\nexport var isPageUrlAllowed = function (url, pageUrlAllowlist) {\n    if (!pageUrlAllowlist || !pageUrlAllowlist.length) {\n        return true;\n    }\n    return pageUrlAllowlist.some(function (allowedUrl) {\n        if (typeof allowedUrl === 'string') {\n            return url === allowedUrl;\n        }\n        return url.match(allowedUrl);\n    });\n};\nexport var getAttributesWithPrefix = function (element, prefix) {\n    return element.getAttributeNames().reduce(function (attributes, attributeName) {\n        if (attributeName.startsWith(prefix)) {\n            var attributeKey = attributeName.replace(prefix, '');\n            var attributeValue = element.getAttribute(attributeName);\n            if (attributeKey) {\n                attributes[attributeKey] = attributeValue || '';\n            }\n        }\n        return attributes;\n    }, {});\n};\nexport var isEmpty = function (value) {\n    return (value === undefined ||\n        value === null ||\n        (typeof value === 'object' && Object.keys(value).length === 0) ||\n        (typeof value === 'string' && value.trim().length === 0));\n};\nexport var removeEmptyProperties = function (properties) {\n    return Object.keys(properties).reduce(function (filteredProperties, key) {\n        var value = properties[key];\n        if (!isEmpty(value)) {\n            filteredProperties[key] = value;\n        }\n        return filteredProperties;\n    }, {});\n};\nexport var getNearestLabel = function (element) {\n    var parent = element.parentElement;\n    if (!parent) {\n        return '';\n    }\n    var labelElement;\n    try {\n        labelElement = parent.querySelector(':scope>span,h1,h2,h3,h4,h5,h6');\n    }\n    catch (error) {\n        labelElement = null;\n    }\n    if (labelElement) {\n        /* istanbul ignore next */\n        var labelText = labelElement.textContent || '';\n        return isNonSensitiveString(labelText) ? labelText : '';\n    }\n    return getNearestLabel(parent);\n};\nexport var querySelectUniqueElements = function (root, selectors) {\n    if (root && 'querySelectorAll' in root && typeof root.querySelectorAll === 'function') {\n        var elementSet = selectors.reduce(function (elements, selector) {\n            if (selector) {\n                var selectedElements = Array.from(root.querySelectorAll(selector));\n                selectedElements.forEach(function (element) {\n                    elements.add(element);\n                });\n            }\n            return elements;\n        }, new Set());\n        return Array.from(elementSet);\n    }\n    return [];\n};\n// Similar as element.closest, but works with multiple selectors\nexport var getClosestElement = function (element, selectors) {\n    if (!element) {\n        return null;\n    }\n    /* istanbul ignore next */\n    if (selectors.some(function (selector) { var _a; return (_a = element === null || element === void 0 ? void 0 : element.matches) === null || _a === void 0 ? void 0 : _a.call(element, selector); })) {\n        return element;\n    }\n    /* istanbul ignore next */\n    return getClosestElement(element === null || element === void 0 ? void 0 : element.parentElement, selectors);\n};\n// Returns the element properties for the given element in Visual Labeling.\nexport var getEventTagProps = function (element) {\n    var _a;\n    var _b, _c;\n    if (!element) {\n        return {};\n    }\n    /* istanbul ignore next */\n    var tag = (_c = (_b = element === null || element === void 0 ? void 0 : element.tagName) === null || _b === void 0 ? void 0 : _b.toLowerCase) === null || _c === void 0 ? void 0 : _c.call(_b);\n    var properties = (_a = {},\n        _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_TAG] = tag,\n        _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_TEXT] = getText(element),\n        _a[constants.AMPLITUDE_EVENT_PROP_PAGE_URL] = window.location.href.split('?')[0],\n        _a);\n    return removeEmptyProperties(properties);\n};\nexport var asyncLoadScript = function (url) {\n    return new Promise(function (resolve, reject) {\n        var _a;\n        try {\n            var scriptElement = document.createElement('script');\n            scriptElement.type = 'text/javascript';\n            scriptElement.async = true;\n            scriptElement.src = url;\n            scriptElement.addEventListener('load', function () {\n                resolve({ status: true });\n            }, { once: true });\n            scriptElement.addEventListener('error', function () {\n                reject({\n                    status: false,\n                    message: \"Failed to load the script \".concat(url),\n                });\n            });\n            /* istanbul ignore next */\n            (_a = document.head) === null || _a === void 0 ? void 0 : _a.appendChild(scriptElement);\n        }\n        catch (error) {\n            /* istanbul ignore next */\n            reject(error);\n        }\n    });\n};\nexport function generateUniqueId() {\n    return \"\".concat(Date.now(), \"-\").concat(Math.random().toString(36).substr(2, 9));\n}\nexport var filterOutNonTrackableEvents = function (event) {\n    // Filter out changeEvent events with no target\n    // This could happen when change events are triggered programmatically\n    if (event.event.target === null || !event.closestTrackedAncestor) {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=helpers.js.map","/* istanbul ignore file */\n/* eslint-disable no-restricted-globals */\nimport { AMPLITUDE_ORIGIN, AMPLITUDE_VISUAL_TAGGING_SELECTOR_SCRIPT_URL, AMPLITUDE_VISUAL_TAGGING_HIGHLIGHT_CLASS, } from '../constants';\nimport { asyncLoadScript, generateUniqueId, getEventTagProps } from '../helpers';\n// TODO: use MessageChannel instead of window.postMessage\nvar WindowMessenger = /** @class */ (function () {\n    function WindowMessenger(_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.origin, origin = _c === void 0 ? AMPLITUDE_ORIGIN : _c;\n        var _this = this;\n        this.endpoint = AMPLITUDE_ORIGIN;\n        this.requestCallbacks = {};\n        this.onSelect = function (data) {\n            _this.notify({ action: 'element-selected', data: data });\n        };\n        this.onTrack = function (type, properties) {\n            if (type === 'selector-mode-changed') {\n                _this.notify({ action: 'track-selector-mode-changed', data: properties });\n            }\n            else if (type === 'selector-moved') {\n                _this.notify({ action: 'track-selector-moved', data: properties });\n            }\n        };\n        this.endpoint = origin;\n    }\n    WindowMessenger.prototype.notify = function (message) {\n        var _a, _b, _c, _d;\n        (_b = (_a = this.logger) === null || _a === void 0 ? void 0 : _a.debug) === null || _b === void 0 ? void 0 : _b.call(_a, 'Message sent: ', JSON.stringify(message));\n        (_d = (_c = window.opener) === null || _c === void 0 ? void 0 : _c.postMessage) === null || _d === void 0 ? void 0 : _d.call(_c, message, this.endpoint);\n    };\n    // Send an async request to the parent window\n    WindowMessenger.prototype.sendRequest = function (action, args, options) {\n        var _this = this;\n        if (options === void 0) { options = { timeout: 15000 }; }\n        // Create Request ID\n        var id = generateUniqueId();\n        var request = {\n            id: id,\n            action: action,\n            args: args,\n        };\n        // Create a Promise that will be resolved when the response is received\n        var promise = new Promise(function (resolve, reject) {\n            _this.requestCallbacks[id] = { resolve: resolve, reject: reject };\n            // Send the request\n            _this.notify(request);\n            // Handle request timeouts\n            if ((options === null || options === void 0 ? void 0 : options.timeout) > 0) {\n                setTimeout(function () {\n                    reject(new Error(\"\".concat(action, \" timed out (id: \").concat(id, \")\")));\n                    delete _this.requestCallbacks[id];\n                }, options.timeout);\n            }\n        });\n        return promise;\n    };\n    // Handle messages from the parent window\n    WindowMessenger.prototype.handleResponse = function (response) {\n        var _a;\n        if (!this.requestCallbacks[response.id]) {\n            (_a = this.logger) === null || _a === void 0 ? void 0 : _a.warn(\"No callback found for request id: \".concat(response.id));\n            return;\n        }\n        this.requestCallbacks[response.id].resolve(response.responseData);\n        delete this.requestCallbacks[response.id];\n    };\n    WindowMessenger.prototype.setup = function (_a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, logger = _b.logger, endpoint = _b.endpoint, isElementSelectable = _b.isElementSelectable, cssSelectorAllowlist = _b.cssSelectorAllowlist, actionClickAllowlist = _b.actionClickAllowlist;\n        this.logger = logger;\n        // If endpoint is customized, don't override it.\n        if (endpoint && this.endpoint === AMPLITUDE_ORIGIN) {\n            this.endpoint = endpoint;\n        }\n        var amplitudeVisualTaggingSelectorInstance = null;\n        // Attach Event Listener to listen for messages from the parent window\n        window.addEventListener('message', function (event) {\n            var _a, _b, _c, _d, _e;\n            (_b = (_a = _this.logger) === null || _a === void 0 ? void 0 : _a.debug) === null || _b === void 0 ? void 0 : _b.call(_a, 'Message received: ', JSON.stringify(event));\n            // Only accept messages from the specified origin\n            if (_this.endpoint !== event.origin) {\n                return;\n            }\n            var eventData = event === null || event === void 0 ? void 0 : event.data;\n            var action = eventData === null || eventData === void 0 ? void 0 : eventData.action;\n            // Ignore messages without action\n            if (!action) {\n                return;\n            }\n            // If id exists, handle responses to previous requests\n            if ('id' in eventData) {\n                (_d = (_c = _this.logger) === null || _c === void 0 ? void 0 : _c.debug) === null || _d === void 0 ? void 0 : _d.call(_c, 'Received Response to previous request: ', JSON.stringify(event));\n                _this.handleResponse(eventData);\n                // If action exists, handle the action using existing handlers\n            }\n            else {\n                if (action === 'ping') {\n                    _this.notify({ action: 'pong' });\n                }\n                else if (action === 'initialize-visual-tagging-selector') {\n                    var actionData_1 = eventData === null || eventData === void 0 ? void 0 : eventData.data;\n                    asyncLoadScript(AMPLITUDE_VISUAL_TAGGING_SELECTOR_SCRIPT_URL)\n                        .then(function () {\n                        var _a;\n                        // eslint-disable-next-line\n                        amplitudeVisualTaggingSelectorInstance = (_a = window === null || window === void 0 ? void 0 : window.amplitudeVisualTaggingSelector) === null || _a === void 0 ? void 0 : _a.call(window, {\n                            getEventTagProps: getEventTagProps,\n                            isElementSelectable: function (element) {\n                                if (isElementSelectable) {\n                                    return isElementSelectable((actionData_1 === null || actionData_1 === void 0 ? void 0 : actionData_1.actionType) || 'click', element);\n                                }\n                                return true;\n                            },\n                            onTrack: _this.onTrack,\n                            onSelect: _this.onSelect,\n                            visualHighlightClass: AMPLITUDE_VISUAL_TAGGING_HIGHLIGHT_CLASS,\n                            messenger: _this,\n                            cssSelectorAllowlist: cssSelectorAllowlist,\n                            actionClickAllowlist: actionClickAllowlist,\n                        });\n                        _this.notify({ action: 'selector-loaded' });\n                    })\n                        .catch(function () {\n                        var _a;\n                        (_a = _this.logger) === null || _a === void 0 ? void 0 : _a.warn('Failed to initialize visual tagging selector');\n                    });\n                }\n                else if (action === 'close-visual-tagging-selector') {\n                    // eslint-disable-next-line\n                    (_e = amplitudeVisualTaggingSelectorInstance === null || amplitudeVisualTaggingSelectorInstance === void 0 ? void 0 : amplitudeVisualTaggingSelectorInstance.close) === null || _e === void 0 ? void 0 : _e.call(amplitudeVisualTaggingSelectorInstance);\n                }\n            }\n        });\n        // Notify the parent window that the page has loaded\n        this.notify({ action: 'page-loaded' });\n    };\n    return WindowMessenger;\n}());\nexport { WindowMessenger };\n//# sourceMappingURL=messenger.js.map","import { __read, __values } from \"tslib\";\nimport { isNonSensitiveElement } from './helpers';\nvar BLOCKED_ATTRIBUTES = [\n    // Already captured elsewhere in the hierarchy object\n    'id',\n    'class',\n    // non-useful and potentially large attribute\n    'style',\n    // sensitive as prefilled form data may populate this attribute\n    'value',\n    // DOM events\n    'onclick',\n    'onchange',\n    'oninput',\n    'onblur',\n    'onsubmit',\n    'onfocus',\n    'onkeydown',\n    'onkeyup',\n    'onkeypress',\n    // React specific\n    'data-reactid',\n    'data-react-checksum',\n    'data-reactroot',\n];\nvar SENSITIVE_ELEMENT_ATTRIBUTE_ALLOWLIST = ['type'];\nvar SVG_TAGS = ['svg', 'path', 'g'];\nvar HIGHLY_SENSITIVE_INPUT_TYPES = ['password', 'hidden'];\nvar MAX_ATTRIBUTE_LENGTH = 128;\nvar MAX_HIERARCHY_LENGTH = 1024;\nexport function getElementProperties(element) {\n    var e_1, _a;\n    var _b, _c, _d, _e;\n    if (element === null) {\n        return null;\n    }\n    var tagName = String(element.tagName).toLowerCase();\n    var properties = {\n        tag: tagName,\n    };\n    var siblings = Array.from((_c = (_b = element.parentElement) === null || _b === void 0 ? void 0 : _b.children) !== null && _c !== void 0 ? _c : []);\n    if (siblings.length) {\n        properties.index = siblings.indexOf(element);\n        properties.indexOfType = siblings.filter(function (el) { return el.tagName === element.tagName; }).indexOf(element);\n    }\n    var prevSiblingTag = (_e = (_d = element.previousElementSibling) === null || _d === void 0 ? void 0 : _d.tagName) === null || _e === void 0 ? void 0 : _e.toLowerCase();\n    if (prevSiblingTag) {\n        properties.prevSib = String(prevSiblingTag);\n    }\n    var id = element.getAttribute('id');\n    if (id) {\n        properties.id = String(id);\n    }\n    var classes = Array.from(element.classList);\n    if (classes.length) {\n        properties.classes = classes;\n    }\n    var attributes = {};\n    var attributesArray = Array.from(element.attributes);\n    var filteredAttributes = attributesArray.filter(function (attr) { return !BLOCKED_ATTRIBUTES.includes(attr.name); });\n    var isSensitiveElement = !isNonSensitiveElement(element);\n    // if input is hidden or password or for SVGs, skip attribute collection entirely\n    if (!HIGHLY_SENSITIVE_INPUT_TYPES.includes(String(element.getAttribute('type'))) && !SVG_TAGS.includes(tagName)) {\n        try {\n            for (var filteredAttributes_1 = __values(filteredAttributes), filteredAttributes_1_1 = filteredAttributes_1.next(); !filteredAttributes_1_1.done; filteredAttributes_1_1 = filteredAttributes_1.next()) {\n                var attr = filteredAttributes_1_1.value;\n                // If sensitive element, only allow certain attributes\n                if (isSensitiveElement && !SENSITIVE_ELEMENT_ATTRIBUTE_ALLOWLIST.includes(attr.name)) {\n                    continue;\n                }\n                // Finally cast attribute value to string and limit attribute value length\n                attributes[attr.name] = String(attr.value).substring(0, MAX_ATTRIBUTE_LENGTH);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (filteredAttributes_1_1 && !filteredAttributes_1_1.done && (_a = filteredAttributes_1.return)) _a.call(filteredAttributes_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    if (Object.keys(attributes).length) {\n        properties.attrs = attributes;\n    }\n    return properties;\n}\nexport function getAncestors(targetEl) {\n    var ancestors = [];\n    if (!targetEl) {\n        return ancestors;\n    }\n    // Add self to the list of ancestors\n    ancestors.push(targetEl);\n    var current = targetEl.parentElement;\n    while (current && current.tagName !== 'HTML') {\n        ancestors.push(current);\n        current = current.parentElement;\n    }\n    return ancestors;\n}\n// Get the DOM hierarchy of the element, starting from the target element to the root element.\nexport var getHierarchy = function (element) {\n    var hierarchy = [];\n    if (!element) {\n        return [];\n    }\n    // Get list of ancestors including itself and get properties at each level in the hierarchy\n    var ancestors = getAncestors(element);\n    hierarchy = ensureListUnderLimit(ancestors.map(function (el) { return getElementProperties(el); }), MAX_HIERARCHY_LENGTH);\n    return hierarchy;\n};\nexport function ensureListUnderLimit(list, bytesLimit) {\n    var numChars = 0;\n    for (var i = 0; i < list.length; i++) {\n        var node = list[i];\n        if (node === null) {\n            // simulate 'None' in python\n            numChars += 4;\n        }\n        else {\n            var value = ensureUnicodePythonCompatible(node);\n            // Using Array.from(string).length instead of string.length\n            // to correctly count Unicode characters (including emojis)\n            numChars += value ? Array.from(value).length : 4;\n        }\n        if (numChars > bytesLimit) {\n            return list.slice(0, i);\n        }\n    }\n    return list;\n}\n/**\n * Converts a JSON-compatible value to a Python-compatible string representation.\n * This function handles various data types and ensures proper escaping and formatting.\n *\n * @param value - The value to be converted (can be any JSON-compatible type)\n * @param nested - Indicates if the value is nested within another structure (default: false)\n * @returns A string representation of the value compatible with Python, or null if conversion fails\n */\nexport function ensureUnicodePythonCompatible(value, nested) {\n    if (nested === void 0) { nested = false; }\n    try {\n        if (value == null) {\n            // Handle null values\n            if (nested) {\n                return 'None'; // Represent null as 'None' in Python when nested\n            }\n            return null; // Return null for top-level null values\n        }\n        else if (typeof value === 'string') {\n            if (nested) {\n                // Escape special characters in nested strings\n                value = value.replace(/\\\\/g, '\\\\\\\\').replace(/\\n/g, '\\\\n').replace(/\\t/g, '\\\\t').replace(/\\r/g, '\\\\r');\n                // Handle quotes in the string\n                if (value.includes('\"')) {\n                    return \"'\".concat(value, \"'\"); // Wrap in single quotes if it contains double quotes\n                }\n                if (value.includes(\"'\")) {\n                    return \"\\\"\".concat(value.replace(/'/g, \"\\\\'\"), \"\\\"\"); // Wrap in double quotes and escape single quotes\n                }\n                return \"'\".concat(value, \"'\"); // Default to wrapping in single quotes\n            }\n            return value; // Return non-nested strings as-is\n        }\n        else if (typeof value === 'boolean') {\n            // Convert boolean to Python-style capitalized string\n            return value ? 'True' : 'False';\n        }\n        else if (Array.isArray(value)) {\n            // Handle arrays by recursively converting each element\n            var elements = value.map(function (o) { return ensureUnicodePythonCompatible(o, true); });\n            return \"[\".concat(elements.join(', '), \"]\");\n        }\n        else if (typeof value === 'object') {\n            // Handle objects (dictionaries in Python)\n            var entries = Object.entries(value)\n                .filter(function (_a) {\n                var _b = __read(_a, 1), key = _b[0];\n                return key != null;\n            }) // Filter out null keys\n                .map(function (_a) {\n                var _b = __read(_a, 2), key = _b[0], val = _b[1];\n                return \"\".concat(String(ensureUnicodePythonCompatible(key, true)), \": \").concat(String(ensureUnicodePythonCompatible(val, true)));\n            });\n            var result = \"{\".concat(entries.join(', '), \"}\");\n            // Handle single quotes in the resulting string\n            if (result.includes(\"\\\\'\")) {\n                result = result.replace(/'/g, \"'\").replace(/'/g, \"\\\\'\");\n            }\n            return result;\n        }\n        // For any other types, return their string representation;\n        return value.toString();\n    }\n    catch (e) {\n        // Return null if any error occurs during the conversion\n        return null;\n    }\n}\n//# sourceMappingURL=hierarchy.js.map","import { __read, __values } from \"tslib\";\nimport { buffer, filter, map, debounceTime, merge, pairwise, delay } from 'rxjs';\nimport { filterOutNonTrackableEvents } from '../helpers';\nimport { AMPLITUDE_ELEMENT_CLICKED_EVENT } from '../constants';\nvar RAGE_CLICK_THRESHOLD = 5;\nexport function trackClicks(_a) {\n    var amplitude = _a.amplitude, allObservables = _a.allObservables, options = _a.options, shouldTrackEvent = _a.shouldTrackEvent;\n    var clickObservable = allObservables.clickObservable;\n    // Trigger if the target of the click event has changed and position is different\n    // Keeping track of position is important to avoid false positives when the user clicks on the same\n    // element where certain frameworks could replace the element instance between rerenders\n    var comparisonTrigger = clickObservable.pipe(pairwise(), filter(function (_a) {\n        var _b = __read(_a, 2), prev = _b[0], current = _b[1];\n        var targetChanged = prev.event.target !== current.event.target;\n        /* istanbul ignore next */\n        var samePos = Math.abs(current.event.screenX - prev.event.screenX) <= 20 &&\n            Math.abs(current.event.screenY - prev.event.screenY) <= 20;\n        return targetChanged && !samePos;\n    }));\n    // Trigger if there is no click event within 1 second\n    var timeoutTrigger = clickObservable.pipe(debounceTime(options.debounceTime), map(function () { return 'timeout'; }));\n    var triggers = merge(comparisonTrigger, timeoutTrigger);\n    // Get buffers of clicks, if the buffer length is over 5, it is rage click\n    var bufferedClicks = clickObservable.pipe(delay(0), filter(filterOutNonTrackableEvents), filter(function (click) {\n        // Only track clicks on elements that should be tracked,\n        return shouldTrackEvent('click', click.closestTrackedAncestor);\n    }), buffer(triggers));\n    return bufferedClicks.subscribe(function (clicks) {\n        var e_1, _a;\n        // TODO: update this when rage clicks are added\n        var clickType = clicks.length >= RAGE_CLICK_THRESHOLD ? AMPLITUDE_ELEMENT_CLICKED_EVENT : AMPLITUDE_ELEMENT_CLICKED_EVENT;\n        try {\n            for (var clicks_1 = __values(clicks), clicks_1_1 = clicks_1.next(); !clicks_1_1.done; clicks_1_1 = clicks_1.next()) {\n                var click = clicks_1_1.value;\n                /* istanbul ignore next */\n                amplitude === null || amplitude === void 0 ? void 0 : amplitude.track(clickType, click.targetElementProperties);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (clicks_1_1 && !clicks_1_1.done && (_a = clicks_1.return)) _a.call(clicks_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    });\n}\n//# sourceMappingURL=track-click.js.map","import { __assign, __awaiter, __generator, __read, __spreadArray, __values } from \"tslib\";\n/* eslint-disable no-restricted-globals */\nimport { DEFAULT_CSS_SELECTOR_ALLOWLIST, DEFAULT_DATA_ATTRIBUTE_PREFIX, DEFAULT_ACTION_CLICK_ALLOWLIST, } from '@amplitude/analytics-core';\nimport * as constants from './constants';\nimport { fromEvent, map, Observable, share } from 'rxjs';\nimport { getText, getAttributesWithPrefix, removeEmptyProperties, getNearestLabel, createShouldTrackEvent, getClosestElement, } from './helpers';\nimport { WindowMessenger } from './libs/messenger';\nimport { getHierarchy } from './hierarchy';\nimport { trackClicks } from './autocapture/track-click';\nimport { trackChange } from './autocapture/track-change';\nimport { trackActionClick } from './autocapture/track-action-click';\nexport var ObservablesEnum;\n(function (ObservablesEnum) {\n    ObservablesEnum[\"ClickObservable\"] = \"clickObservable\";\n    ObservablesEnum[\"ChangeObservable\"] = \"changeObservable\";\n    // ErrorObservable = 'errorObservable',\n    ObservablesEnum[\"NavigateObservable\"] = \"navigateObservable\";\n    ObservablesEnum[\"MutationObservable\"] = \"mutationObservable\";\n})(ObservablesEnum || (ObservablesEnum = {}));\n// Type predicate\nexport function isElementBasedEvent(event) {\n    return event.type === 'click' || event.type === 'change';\n}\nexport var autocapturePlugin = function (options) {\n    var _a, _b, _c;\n    if (options === void 0) { options = {}; }\n    var _d = options.dataAttributePrefix, dataAttributePrefix = _d === void 0 ? DEFAULT_DATA_ATTRIBUTE_PREFIX : _d, _e = options.visualTaggingOptions, visualTaggingOptions = _e === void 0 ? {\n        enabled: true,\n        messenger: new WindowMessenger(),\n    } : _e;\n    options.cssSelectorAllowlist = (_a = options.cssSelectorAllowlist) !== null && _a !== void 0 ? _a : DEFAULT_CSS_SELECTOR_ALLOWLIST;\n    options.actionClickAllowlist = (_b = options.actionClickAllowlist) !== null && _b !== void 0 ? _b : DEFAULT_ACTION_CLICK_ALLOWLIST;\n    options.debounceTime = (_c = options.debounceTime) !== null && _c !== void 0 ? _c : 0; // TODO: update this when rage clicks are added to 1000ms\n    var name = constants.PLUGIN_NAME;\n    var type = 'enrichment';\n    var subscriptions = [];\n    // Create observables on events on the window\n    var createObservables = function () {\n        var _a;\n        // Create Observables from direct user events\n        var clickObservable = fromEvent(document, 'click', { capture: true }).pipe(map(function (click) { return addAdditionalEventProperties(click, 'click'); }), share());\n        var changeObservable = fromEvent(document, 'change', { capture: true }).pipe(map(function (change) { return addAdditionalEventProperties(change, 'change'); }), share());\n        // Create Observable from unhandled errors\n        // const errorObservable = fromEvent<ErrorEvent>(window, 'error').pipe(\n        //   map((error) => addAdditionalEventProperties(error, 'error')),\n        // );\n        // Create observable for URL changes\n        var navigateObservable;\n        /* istanbul ignore next */\n        if (window.navigation) {\n            navigateObservable = fromEvent(window.navigation, 'navigate').pipe(map(function (navigate) { return addAdditionalEventProperties(navigate, 'navigate'); }), share());\n        }\n        // Track DOM Mutations\n        var mutationObservable = new Observable(function (observer) {\n            var mutationObserver = new MutationObserver(function (mutations) {\n                observer.next(mutations);\n            });\n            mutationObserver.observe(document.body, {\n                childList: true,\n                attributes: true,\n                characterData: true,\n                subtree: true,\n            });\n            return function () { return mutationObserver.disconnect(); };\n        }).pipe(map(function (mutation) { return addAdditionalEventProperties(mutation, 'mutation'); }), share());\n        return _a = {},\n            _a[ObservablesEnum.ClickObservable] = clickObservable,\n            _a[ObservablesEnum.ChangeObservable] = changeObservable,\n            // [ObservablesEnum.ErrorObservable]: errorObservable,\n            _a[ObservablesEnum.NavigateObservable] = navigateObservable,\n            _a[ObservablesEnum.MutationObservable] = mutationObservable,\n            _a;\n    };\n    // Returns the Amplitude event properties for the given element.\n    var getEventProperties = function (actionType, element) {\n        var _a;\n        var _b, _c;\n        /* istanbul ignore next */\n        var tag = (_c = (_b = element === null || element === void 0 ? void 0 : element.tagName) === null || _b === void 0 ? void 0 : _b.toLowerCase) === null || _c === void 0 ? void 0 : _c.call(_b);\n        /* istanbul ignore next */\n        var rect = typeof element.getBoundingClientRect === 'function' ? element.getBoundingClientRect() : { left: null, top: null };\n        var ariaLabel = element.getAttribute('aria-label');\n        var attributes = getAttributesWithPrefix(element, dataAttributePrefix);\n        var nearestLabel = getNearestLabel(element);\n        /* istanbul ignore next */\n        var properties = (_a = {},\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_ID] = element.getAttribute('id') || '',\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_CLASS] = element.getAttribute('class'),\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_HIERARCHY] = getHierarchy(element),\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_TAG] = tag,\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_TEXT] = getText(element),\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_POSITION_LEFT] = rect.left == null ? null : Math.round(rect.left),\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_POSITION_TOP] = rect.top == null ? null : Math.round(rect.top),\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_ARIA_LABEL] = ariaLabel,\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_ATTRIBUTES] = attributes,\n            _a[constants.AMPLITUDE_EVENT_PROP_ELEMENT_PARENT_LABEL] = nearestLabel,\n            _a[constants.AMPLITUDE_EVENT_PROP_PAGE_URL] = window.location.href.split('?')[0],\n            _a[constants.AMPLITUDE_EVENT_PROP_PAGE_TITLE] = (typeof document !== 'undefined' && document.title) || '',\n            _a[constants.AMPLITUDE_EVENT_PROP_VIEWPORT_HEIGHT] = window.innerHeight,\n            _a[constants.AMPLITUDE_EVENT_PROP_VIEWPORT_WIDTH] = window.innerWidth,\n            _a);\n        if (tag === 'a' && actionType === 'click' && element instanceof HTMLAnchorElement) {\n            properties[constants.AMPLITUDE_EVENT_PROP_ELEMENT_HREF] = element.href;\n        }\n        return removeEmptyProperties(properties);\n    };\n    var addAdditionalEventProperties = function (event, type) {\n        var baseEvent = {\n            event: event,\n            timestamp: Date.now(),\n            type: type,\n        };\n        if (isElementBasedEvent(baseEvent) && baseEvent.event.target !== null) {\n            // Retrieve additional event properties from the target element\n            var closestTrackedAncestor = getClosestElement(baseEvent.event.target, options.cssSelectorAllowlist);\n            if (closestTrackedAncestor) {\n                baseEvent.closestTrackedAncestor = closestTrackedAncestor;\n                baseEvent.targetElementProperties = getEventProperties(baseEvent.type, closestTrackedAncestor);\n            }\n            return baseEvent;\n        }\n        return baseEvent;\n    };\n    var setup = function (config, amplitude) { return __awaiter(void 0, void 0, void 0, function () {\n        var shouldTrackEvent, shouldTrackActionClick, allObservables, clickTrackingSubscription, changeSubscription, actionClickSubscription, allowlist, actionClickAllowlist;\n        var _a, _b;\n        return __generator(this, function (_c) {\n            /* istanbul ignore if */\n            if (typeof document === 'undefined') {\n                return [2 /*return*/];\n            }\n            shouldTrackEvent = createShouldTrackEvent(options, options.cssSelectorAllowlist);\n            shouldTrackActionClick = createShouldTrackEvent(options, options.actionClickAllowlist);\n            allObservables = createObservables();\n            clickTrackingSubscription = trackClicks({\n                allObservables: allObservables,\n                options: options,\n                amplitude: amplitude,\n                shouldTrackEvent: shouldTrackEvent,\n            });\n            subscriptions.push(clickTrackingSubscription);\n            changeSubscription = trackChange({\n                allObservables: allObservables,\n                getEventProperties: getEventProperties,\n                amplitude: amplitude,\n                shouldTrackEvent: shouldTrackEvent,\n            });\n            subscriptions.push(changeSubscription);\n            actionClickSubscription = trackActionClick({\n                allObservables: allObservables,\n                options: options,\n                getEventProperties: getEventProperties,\n                amplitude: amplitude,\n                shouldTrackEvent: shouldTrackEvent,\n                shouldTrackActionClick: shouldTrackActionClick,\n            });\n            subscriptions.push(actionClickSubscription);\n            /* istanbul ignore next */\n            (_a = config === null || config === void 0 ? void 0 : config.loggerProvider) === null || _a === void 0 ? void 0 : _a.log(\"\".concat(name, \" has been successfully added.\"));\n            // Setup visual tagging selector\n            if (window.opener && visualTaggingOptions.enabled) {\n                allowlist = options.cssSelectorAllowlist;\n                actionClickAllowlist = options.actionClickAllowlist;\n                /* istanbul ignore next */\n                (_b = visualTaggingOptions.messenger) === null || _b === void 0 ? void 0 : _b.setup(__assign(__assign({ logger: config === null || config === void 0 ? void 0 : config.loggerProvider }, ((config === null || config === void 0 ? void 0 : config.serverZone) && { endpoint: constants.AMPLITUDE_ORIGINS_MAP[config.serverZone] })), { isElementSelectable: createShouldTrackEvent(options, __spreadArray(__spreadArray([], __read(allowlist), false), __read(actionClickAllowlist), false)), cssSelectorAllowlist: allowlist, actionClickAllowlist: actionClickAllowlist }));\n            }\n            return [2 /*return*/];\n        });\n    }); };\n    var execute = function (event) { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, event];\n        });\n    }); };\n    var teardown = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var subscriptions_1, subscriptions_1_1, subscription;\n        var e_1, _a;\n        return __generator(this, function (_b) {\n            try {\n                for (subscriptions_1 = __values(subscriptions), subscriptions_1_1 = subscriptions_1.next(); !subscriptions_1_1.done; subscriptions_1_1 = subscriptions_1.next()) {\n                    subscription = subscriptions_1_1.value;\n                    subscription.unsubscribe();\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (subscriptions_1_1 && !subscriptions_1_1.done && (_a = subscriptions_1.return)) _a.call(subscriptions_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            return [2 /*return*/];\n        });\n    }); };\n    return {\n        name: name,\n        type: type,\n        setup: setup,\n        execute: execute,\n        teardown: teardown,\n    };\n};\n//# sourceMappingURL=autocapture-plugin.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var activeTask = null;\n        var lastValue = null;\n        var lastTime = null;\n        var emit = function () {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            var targetTime = lastTime + dueTime;\n            var now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounceTime.js.map","import { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function buffer(closingNotifier) {\n    return operate(function (source, subscriber) {\n        var currentBuffer = [];\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return currentBuffer.push(value); }, function () {\n            subscriber.next(currentBuffer);\n            subscriber.complete();\n        }));\n        innerFrom(closingNotifier).subscribe(createOperatorSubscriber(subscriber, function () {\n            var b = currentBuffer;\n            currentBuffer = [];\n            subscriber.next(b);\n        }, noop));\n        return function () {\n            currentBuffer = null;\n        };\n    });\n}\n//# sourceMappingURL=buffer.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function pairwise() {\n    return operate(function (source, subscriber) {\n        var prev;\n        var hasPrev = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var p = prev;\n            prev = value;\n            hasPrev && subscriber.next([p, value]);\n            hasPrev = true;\n        }));\n    });\n}\n//# sourceMappingURL=pairwise.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { filter, map, merge, switchMap, take, timeout, EMPTY } from 'rxjs';\nimport { filterOutNonTrackableEvents, getClosestElement } from '../helpers';\nimport { AMPLITUDE_ELEMENT_CLICKED_EVENT } from '../constants';\nexport function trackActionClick(_a) {\n    var amplitude = _a.amplitude, allObservables = _a.allObservables, options = _a.options, getEventProperties = _a.getEventProperties, shouldTrackEvent = _a.shouldTrackEvent, shouldTrackActionClick = _a.shouldTrackActionClick;\n    var clickObservable = allObservables.clickObservable, mutationObservable = allObservables.mutationObservable, navigateObservable = allObservables.navigateObservable;\n    var filteredClickObservable = clickObservable.pipe(filter(function (click) {\n        // Filter out regularly tracked click events that are already handled in trackClicks\n        return !shouldTrackEvent('click', click.closestTrackedAncestor);\n    }), map(function (click) {\n        // overwrite the closestTrackedAncestor with the closest element that is on the actionClickAllowlist\n        var closestActionClickEl = getClosestElement(click.event.target, options.actionClickAllowlist);\n        click.closestTrackedAncestor = closestActionClickEl;\n        // overwrite the targetElementProperties with the properties of the closestActionClickEl\n        if (click.closestTrackedAncestor !== null) {\n            click.targetElementProperties = getEventProperties(click.type, click.closestTrackedAncestor);\n        }\n        return click;\n    }), filter(filterOutNonTrackableEvents), filter(function (clickEvent) {\n        // Only track change on elements that should be tracked\n        return shouldTrackActionClick('click', clickEvent.closestTrackedAncestor);\n    }));\n    var changeObservables = [mutationObservable];\n    /* istanbul ignore next */\n    if (navigateObservable) {\n        changeObservables.push(navigateObservable);\n    }\n    var mutationOrNavigate = merge.apply(void 0, __spreadArray([], __read(changeObservables), false));\n    var actionClicks = filteredClickObservable.pipe(\n    // If a mutation occurs within 0.5 seconds of a click event (timeout({ first: 500 })), it emits the original first click event.\n    // take 1 to only limit the action events in case there are multiple\n    switchMap(function (click) {\n        return mutationOrNavigate.pipe(take(1), timeout({ first: 500, with: function () { return EMPTY; } }), // in case of timeout, map to empty to prevent any click from being emitted\n        map(function () { return click; }));\n    }));\n    return actionClicks.subscribe(function (actionClick) {\n        /* istanbul ignore next */\n        amplitude === null || amplitude === void 0 ? void 0 : amplitude.track(AMPLITUDE_ELEMENT_CLICKED_EVENT, getEventProperties('click', actionClick.closestTrackedAncestor));\n    });\n}\n//# sourceMappingURL=track-action-click.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function switchMap(project, resultSelector) {\n    return operate(function (source, subscriber) {\n        var innerSubscriber = null;\n        var index = 0;\n        var isComplete = false;\n        var checkComplete = function () { return isComplete && !innerSubscriber && subscriber.complete(); };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            innerSubscriber === null || innerSubscriber === void 0 ? void 0 : innerSubscriber.unsubscribe();\n            var innerIndex = 0;\n            var outerIndex = index++;\n            innerFrom(project(value, outerIndex)).subscribe((innerSubscriber = createOperatorSubscriber(subscriber, function (innerValue) { return subscriber.next(resultSelector ? resultSelector(value, innerValue, outerIndex, innerIndex++) : innerValue); }, function () {\n                innerSubscriber = null;\n                checkComplete();\n            })));\n        }, function () {\n            isComplete = true;\n            checkComplete();\n        }));\n    });\n}\n//# sourceMappingURL=switchMap.js.map","/* eslint-disable @typescript-eslint/unbound-method */\nimport client from './browser-client-factory';\nexport { createInstance } from './browser-client-factory';\nexport const {\n  add,\n  extendSession,\n  flush,\n  getDeviceId,\n  getSessionId,\n  getUserId,\n  groupIdentify,\n  identify,\n  init,\n  logEvent,\n  remove,\n  reset,\n  revenue,\n  setDeviceId,\n  setGroup,\n  setOptOut,\n  setSessionId,\n  setTransport,\n  setUserId,\n  track,\n} = client;\nexport { AmplitudeBrowser } from './browser-client';\nexport { runQueuedFunctions } from './utils/snippet-helper';\nexport { Revenue, Identify } from '@amplitude/analytics-core';\n\nimport {\n  AmplitudeReturn as AmplitudeReturnType,\n  BaseEvent as BaseEventType,\n  EventOptions as EventOptionsType,\n  BrowserClient as BrowserClientType,\n  AttributionOptions as AttributionOptionsType,\n  AutocaptureOptions as AutocaptureOptionsType,\n  BrowserOptions as BrowserOptionsType,\n  BrowserConfig as BrowserConfigType,\n  IConfig as IConfigType,\n  Event as EventType,\n  IdentifyEvent as IdentifyEventType,\n  GroupIdentifyEvent as GroupIdentifyEventType,\n  IdentifyOperation as IdentifyOperationType,\n  SpecialEventType as SpecialEventTypeType,\n  IIdentify as IIdentifyType,\n  IRevenue as IRevenueType,\n  RevenueProperty as RevenuePropertyType,\n  ILogger as ILoggerType,\n  LogLevel as LogLevelType,\n  Plugin as PluginType,\n  BeforePlugin as BeforePluginType,\n  EnrichmentPlugin as EnrichmentPluginType,\n  DestinationPlugin as DestinationPluginType,\n  Result as ResultType,\n  ServerZoneType as ServerZoneTypeType,\n  ServerZone as ServerZoneEnum,\n  IdentityStorageType as IdentityStorageTypeType,\n  Storage as StorageTypeType,\n  TransportType as TransportTypeType,\n  OfflineDisabled as OfflineDisabledType,\n  Messenger as MessengerType,\n  ElementInteractionsOptions as ElementInteractionsOptionsType,\n  ActionType as ActionTypeType,\n  DEFAULT_CSS_SELECTOR_ALLOWLIST as DEFAULT_CSS_SELECTOR_ALLOWLIST_TYPE,\n  DEFAULT_DATA_ATTRIBUTE_PREFIX as DEFAULT_DATA_ATTRIBUTE_PREFIX_TYPE,\n  DEFAULT_ACTION_CLICK_ALLOWLIST as DEFAULT_ACTION_CLICK_ALLOWLIST_TYPE,\n} from '@amplitude/analytics-core';\n\nimport {\n  Campaign as CampaignType,\n  CampaignParser as CampaignParserType,\n  ClickIdParameters as ClickIdParametersType,\n  ReferrerParameters as ReferrerParametersType,\n  UTMParameters as UTMParametersType,\n} from './attribution/campaign';\n\n// Export the following types to maintain backward compatibility with `analytics-types`.\n// In the next major version, only export customer-facing types to reduce the public API surface.\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace Types {\n  export type AmplitudeReturn<T> = AmplitudeReturnType<T>;\n  export type BaseEvent = BaseEventType;\n  export type EventOptions = EventOptionsType;\n  export type Campaign = CampaignType;\n  export type CampaignParser = CampaignParserType;\n  export type ClickIdParameters = ClickIdParametersType;\n  export type ReferrerParameters = ReferrerParametersType;\n  export type UTMParameters = UTMParametersType;\n  export type BrowserClient = BrowserClientType;\n  export type AttributionOptions = AttributionOptionsType;\n  export type AutocaptureOptions = AutocaptureOptionsType;\n  export type BrowserConfig = BrowserConfigType;\n  export type BrowserOptions = BrowserOptionsType;\n  export type Config = IConfigType;\n  export type Event = EventType;\n  export type IdentifyEvent = IdentifyEventType;\n  export type GroupIdentifyEvent = GroupIdentifyEventType;\n  export const IdentifyOperation = IdentifyOperationType;\n  export const SpecialEventType = SpecialEventTypeType;\n  export type Identify = IIdentifyType;\n  export type Revenue = IRevenueType;\n  export const RevenueProperty = RevenuePropertyType;\n  export type Logger = ILoggerType;\n  export const LogLevel = LogLevelType;\n  export type Plugin = PluginType;\n  export type BeforePlugin = BeforePluginType;\n  export type EnrichmentPlugin = EnrichmentPluginType;\n  export type DestinationPlugin = DestinationPluginType;\n  export type Result = ResultType;\n  export type ServerZoneType = ServerZoneTypeType;\n  export const ServerZone = ServerZoneEnum;\n  export type IdentityStorageType = IdentityStorageTypeType;\n  export type Storage<T> = StorageTypeType<T>;\n  export type TransportType = TransportTypeType;\n  export const OfflineDisabled = OfflineDisabledType;\n  export type Messenger = MessengerType;\n  export type ElementInteractionsOptions = ElementInteractionsOptionsType;\n  export type ActionType = ActionTypeType;\n  export const DEFAULT_CSS_SELECTOR_ALLOWLIST = DEFAULT_CSS_SELECTOR_ALLOWLIST_TYPE;\n  export const DEFAULT_DATA_ATTRIBUTE_PREFIX = DEFAULT_DATA_ATTRIBUTE_PREFIX_TYPE;\n  export const DEFAULT_ACTION_CLICK_ALLOWLIST = DEFAULT_ACTION_CLICK_ALLOWLIST_TYPE;\n}\n","import { filter } from 'rxjs';\nimport { filterOutNonTrackableEvents } from '../helpers';\nimport { AMPLITUDE_ELEMENT_CHANGED_EVENT } from '../constants';\nexport function trackChange(_a) {\n    var amplitude = _a.amplitude, allObservables = _a.allObservables, getEventProperties = _a.getEventProperties, shouldTrackEvent = _a.shouldTrackEvent;\n    var changeObservable = allObservables.changeObservable;\n    var filteredChangeObservable = changeObservable.pipe(filter(filterOutNonTrackableEvents), filter(function (changeEvent) {\n        // Only track change on elements that should be tracked,\n        return shouldTrackEvent('change', changeEvent.closestTrackedAncestor);\n    }));\n    return filteredChangeObservable.subscribe(function (changeEvent) {\n        /* istanbul ignore next */\n        amplitude === null || amplitude === void 0 ? void 0 : amplitude.track(AMPLITUDE_ELEMENT_CHANGED_EVENT, getEventProperties('change', changeEvent.closestTrackedAncestor));\n    });\n}\n//# sourceMappingURL=track-change.js.map","import { Campaign } from './campaign';\n\nexport const UTM_CAMPAIGN = 'utm_campaign';\nexport const UTM_CONTENT = 'utm_content';\nexport const UTM_ID = 'utm_id';\nexport const UTM_MEDIUM = 'utm_medium';\nexport const UTM_SOURCE = 'utm_source';\nexport const UTM_TERM = 'utm_term';\n\nexport const DCLID = 'dclid';\nexport const FBCLID = 'fbclid';\nexport const GBRAID = 'gbraid';\nexport const GCLID = 'gclid';\nexport const KO_CLICK_ID = 'ko_click_id';\nexport const LI_FAT_ID = 'li_fat_id';\nexport const MSCLKID = 'msclkid';\nexport const RDT_CID = 'rtd_cid';\nexport const TTCLID = 'ttclid';\nexport const TWCLID = 'twclid';\nexport const WBRAID = 'wbraid';\n\nexport const EMPTY_VALUE = 'EMPTY';\n\nexport const BASE_CAMPAIGN: Campaign = {\n  utm_campaign: undefined,\n  utm_content: undefined,\n  utm_id: undefined,\n  utm_medium: undefined,\n  utm_source: undefined,\n  utm_term: undefined,\n  referrer: undefined,\n  referring_domain: undefined,\n  dclid: undefined,\n  gbraid: undefined,\n  gclid: undefined,\n  fbclid: undefined,\n  ko_click_id: undefined,\n  li_fat_id: undefined,\n  msclkid: undefined,\n  rtd_cid: undefined,\n  ttclid: undefined,\n  twclid: undefined,\n  wbraid: undefined,\n};\n\nexport const MKTG = 'MKTG';\n","import { createIdentifyEvent, Identify, ILogger } from '@amplitude/analytics-core';\nimport { Campaign } from './campaign';\nimport { BASE_CAMPAIGN } from './constants';\n\nexport interface Options {\n  excludeReferrers?: (string | RegExp)[];\n  initialEmptyValue?: string;\n  resetSessionOnNewCampaign?: boolean;\n}\n\nconst domainWithoutSubdomain = (domain: string) => {\n  const parts = domain.split('.');\n\n  if (parts.length <= 2) {\n    return domain;\n  }\n\n  return parts.slice(parts.length - 2, parts.length).join('.');\n};\n\n//Direct traffic mean no external referral, no UTMs, no click-ids, and no other customer identified marketing campaign url params.\nconst isDirectTraffic = (current: Campaign) => {\n  return Object.values(current).every((value) => !value);\n};\n\nexport const isNewCampaign = (\n  current: Campaign,\n  previous: Campaign | undefined,\n  options: Options,\n  logger: ILogger,\n  isNewSession = true,\n) => {\n  const { referrer, referring_domain, ...currentCampaign } = current;\n  const { referrer: _previous_referrer, referring_domain: prevReferringDomain, ...previousCampaign } = previous || {};\n\n  if (isExcludedReferrer(options.excludeReferrers, current.referring_domain)) {\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n    logger.debug(`This is not a new campaign because ${current.referring_domain} is in the exclude referrer list.`);\n    return false;\n  }\n\n  //In the same session, direct traffic should not override or unset any persisting query params\n  if (!isNewSession && isDirectTraffic(current) && previous) {\n    logger.debug('This is not a new campaign because this is a direct traffic in the same session.');\n    return false;\n  }\n\n  const hasNewCampaign = JSON.stringify(currentCampaign) !== JSON.stringify(previousCampaign);\n  const hasNewDomain =\n    domainWithoutSubdomain(referring_domain || '') !== domainWithoutSubdomain(prevReferringDomain || '');\n\n  const result = !previous || hasNewCampaign || hasNewDomain;\n\n  if (!result) {\n    logger.debug(\"This is not a new campaign because it's the same as the previous one.\");\n  } else {\n    logger.debug(`This is a new campaign. An $identify event will be sent.`);\n  }\n\n  return result;\n};\n\nexport const isExcludedReferrer = (excludeReferrers: (string | RegExp)[] = [], referringDomain = '') => {\n  return excludeReferrers.some((value) =>\n    value instanceof RegExp ? value.test(referringDomain) : value === referringDomain,\n  );\n};\n\nexport const createCampaignEvent = (campaign: Campaign, options: Options) => {\n  const campaignParameters: Campaign = {\n    // This object definition allows undefined keys to be iterated on\n    // in .reduce() to build indentify object\n    ...BASE_CAMPAIGN,\n    ...campaign,\n  };\n  const identifyEvent = Object.entries(campaignParameters).reduce((identify, [key, value]) => {\n    identify.setOnce(`initial_${key}`, value ?? options.initialEmptyValue ?? 'EMPTY');\n    if (value) {\n      return identify.set(key, value);\n    }\n    return identify.unset(key);\n  }, new Identify());\n\n  return createIdentifyEvent(identifyEvent);\n};\n\nexport const getDefaultExcludedReferrers = (cookieDomain: string | undefined) => {\n  let domain = cookieDomain;\n  if (domain) {\n    if (domain.startsWith('.')) {\n      domain = domain.substring(1);\n    }\n    return [new RegExp(`${domain.replace('.', '\\\\.')}$`)];\n  }\n  return [];\n};\n","import { getQueryParams } from '@amplitude/analytics-core';\nimport {\n  UTM_CAMPAIGN,\n  UTM_CONTENT,\n  UTM_MEDIUM,\n  UTM_SOURCE,\n  UTM_TERM,\n  GCLID,\n  FBCLID,\n  BASE_CAMPAIGN,\n  DCLID,\n  MSCLKID,\n  RDT_CID,\n  TWCLID,\n  TTCLID,\n  KO_CLICK_ID,\n  LI_FAT_ID,\n  GBRAID,\n  WBRAID,\n  UTM_ID,\n} from './constants';\nimport {\n  Campaign,\n  CampaignParser as ICampaignParser,\n  ClickIdParameters,\n  ReferrerParameters,\n  UTMParameters,\n} from './campaign';\n\nexport class CampaignParser implements ICampaignParser {\n  async parse(): Promise<Campaign> {\n    return {\n      ...BASE_CAMPAIGN,\n      ...this.getUtmParam(),\n      ...this.getReferrer(),\n      ...this.getClickIds(),\n    } as Campaign;\n  }\n\n  getUtmParam(): UTMParameters {\n    const params = getQueryParams();\n\n    const utmCampaign = params[UTM_CAMPAIGN];\n    const utmContent = params[UTM_CONTENT];\n    const utmId = params[UTM_ID];\n    const utmMedium = params[UTM_MEDIUM];\n    const utmSource = params[UTM_SOURCE];\n    const utmTerm = params[UTM_TERM];\n\n    return {\n      utm_campaign: utmCampaign,\n      utm_content: utmContent,\n      utm_id: utmId,\n      utm_medium: utmMedium,\n      utm_source: utmSource,\n      utm_term: utmTerm,\n    };\n  }\n\n  getReferrer(): ReferrerParameters {\n    const data: ReferrerParameters = {\n      referrer: undefined,\n      referring_domain: undefined,\n    };\n    try {\n      data.referrer = document.referrer || undefined;\n      data.referring_domain = data.referrer?.split('/')[2] ?? undefined;\n    } catch {\n      // nothing to track\n    }\n    return data;\n  }\n\n  getClickIds(): ClickIdParameters {\n    const params = getQueryParams();\n    return {\n      [DCLID]: params[DCLID],\n      [FBCLID]: params[FBCLID],\n      [GBRAID]: params[GBRAID],\n      [GCLID]: params[GCLID],\n      [KO_CLICK_ID]: params[KO_CLICK_ID],\n      [LI_FAT_ID]: params[LI_FAT_ID],\n      [MSCLKID]: params[MSCLKID],\n      [RDT_CID]: params[RDT_CID],\n      [TTCLID]: params[TTCLID],\n      [TWCLID]: params[TWCLID],\n      [WBRAID]: params[WBRAID],\n    };\n  }\n}\n","import { BrowserConfig, ILogger, Storage, getStorageKey, isNewSession } from '@amplitude/analytics-core';\nimport { Campaign } from './campaign';\nimport { Options, getDefaultExcludedReferrers, createCampaignEvent, isNewCampaign } from './helpers';\nimport { CampaignParser } from './campaign-parser';\nimport { BASE_CAMPAIGN } from './constants';\n\nexport class WebAttribution {\n  options: Options;\n  storage: Storage<Campaign>;\n  storageKey: string;\n  previousCampaign?: Campaign;\n  currentCampaign: Campaign;\n  shouldTrackNewCampaign = false;\n  sessionTimeout: number;\n  lastEventTime?: number;\n  logger: ILogger;\n\n  constructor(options: Options, config: BrowserConfig) {\n    this.options = {\n      initialEmptyValue: 'EMPTY',\n      resetSessionOnNewCampaign: false,\n      excludeReferrers: getDefaultExcludedReferrers(config.cookieOptions?.domain),\n      ...options,\n    };\n    this.storage = config.cookieStorage as unknown as Storage<Campaign>;\n    this.storageKey = getStorageKey(config.apiKey, 'MKTG');\n    this.currentCampaign = BASE_CAMPAIGN;\n    this.sessionTimeout = config.sessionTimeout;\n    this.lastEventTime = config.lastEventTime;\n    this.logger = config.loggerProvider;\n    config.loggerProvider.log('Installing web attribution tracking.');\n  }\n\n  async init() {\n    [this.currentCampaign, this.previousCampaign] = await this.fetchCampaign();\n    const isEventInNewSession = !this.lastEventTime ? true : isNewSession(this.sessionTimeout, this.lastEventTime);\n\n    if (isNewCampaign(this.currentCampaign, this.previousCampaign, this.options, this.logger, isEventInNewSession)) {\n      this.shouldTrackNewCampaign = true;\n      await this.storage.set(this.storageKey, this.currentCampaign);\n    }\n  }\n\n  async fetchCampaign() {\n    return await Promise.all([new CampaignParser().parse(), this.storage.get(this.storageKey)]);\n  }\n\n  /**\n   * This can be called when enable web attribution and either\n   * 1. set a new session\n   * 2. has new campaign and enable resetSessionOnNewCampaign\n   */\n  generateCampaignEvent(event_id?: number) {\n    // Mark this campaign has been tracked\n    this.shouldTrackNewCampaign = false;\n    const campaignEvent = createCampaignEvent(this.currentCampaign, this.options);\n    if (event_id) {\n      campaignEvent.event_id = event_id;\n    }\n    return campaignEvent;\n  }\n\n  shouldSetSessionIdOnNewCampaign() {\n    return this.shouldTrackNewCampaign && !!this.options.resetSessionOnNewCampaign;\n  }\n}\n","import { AMPLITUDE_PREFIX } from '../types/constants';\nexport var getStorageKey = function (apiKey, postKey, limit) {\n    if (postKey === void 0) { postKey = ''; }\n    if (limit === void 0) { limit = 10; }\n    return [AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');\n};\n//# sourceMappingURL=helpers.js.map","import {\n  AmplitudeCore,\n  Destination,\n  Identify,\n  returnWrapper,\n  Revenue,\n  UUID,\n  getAnalyticsConnector,\n  setConnectorDeviceId,\n  setConnectorUserId,\n  isNewSession,\n  IdentityEventSender,\n  getQueryParams,\n  Event,\n  EventOptions,\n  IIdentify,\n  IRevenue,\n  TransportType,\n  OfflineDisabled,\n  Result,\n  BrowserOptions,\n  BrowserConfig,\n  BrowserClient,\n} from '@amplitude/analytics-core';\nimport {\n  getAttributionTrackingConfig,\n  getPageViewTrackingConfig,\n  getElementInteractionsConfig,\n  isAttributionTrackingEnabled,\n  isSessionTrackingEnabled,\n  isFileDownloadTrackingEnabled,\n  isFormInteractionTrackingEnabled,\n  isElementInteractionsEnabled,\n  isPageViewTrackingEnabled,\n} from './default-tracking';\nimport { convertProxyObjectToRealObject, isInstanceProxy } from './utils/snippet-helper';\nimport { Context } from './plugins/context';\nimport { useBrowserConfig, createTransport } from './config';\nimport { pageViewTrackingPlugin } from '@amplitude/plugin-page-view-tracking-browser';\nimport { formInteractionTracking } from './plugins/form-interaction-tracking';\nimport { fileDownloadTracking } from './plugins/file-download-tracking';\nimport { DEFAULT_SESSION_END_EVENT, DEFAULT_SESSION_START_EVENT } from './constants';\nimport { detNotify } from './det-notification';\nimport { networkConnectivityCheckerPlugin } from './plugins/network-connectivity-checker';\nimport { createBrowserJoinedConfigGenerator } from './config/joined-config';\nimport { autocapturePlugin } from '@amplitude/plugin-autocapture-browser';\nimport { WebAttribution } from './attribution/web-attribution';\n\n/**\n * Exported for `@amplitude/unified` or integration with blade plugins.\n * If you only use `@amplitude/analytics-browser`, use `amplitude.init()` or `amplitude.createInstance()` instead.\n */\nexport class AmplitudeBrowser extends AmplitudeCore implements BrowserClient {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  config: BrowserConfig;\n  previousSessionDeviceId: string | undefined;\n  previousSessionUserId: string | undefined;\n  webAttribution: WebAttribution | undefined;\n\n  init(apiKey = '', userIdOrOptions?: string | BrowserOptions, maybeOptions?: BrowserOptions) {\n    let userId: string | undefined;\n    let options: BrowserOptions | undefined;\n\n    if (arguments.length > 2) {\n      userId = userIdOrOptions as string | undefined;\n      options = maybeOptions;\n    } else {\n      if (typeof userIdOrOptions === 'string') {\n        userId = userIdOrOptions;\n        options = undefined;\n      } else {\n        userId = userIdOrOptions?.userId;\n        options = userIdOrOptions;\n      }\n    }\n    return returnWrapper(this._init({ ...options, userId, apiKey }));\n  }\n  protected async _init(options: BrowserOptions & { apiKey: string }) {\n    // Step 1: Block concurrent initialization\n    if (this.initializing) {\n      return;\n    }\n    this.initializing = true;\n\n    let browserOptions = await useBrowserConfig(options.apiKey, options, this);\n    // Step 2: Create browser config\n    if (options.fetchRemoteConfig) {\n      const joinedConfigGenerator = await createBrowserJoinedConfigGenerator(browserOptions);\n      browserOptions = await joinedConfigGenerator.generateJoinedConfig();\n    }\n    await super._init(browserOptions);\n    this.logBrowserOptions(browserOptions);\n\n    // Add web attribution plugin\n    if (isAttributionTrackingEnabled(this.config.defaultTracking)) {\n      const attributionTrackingOptions = getAttributionTrackingConfig(this.config);\n      this.webAttribution = new WebAttribution(attributionTrackingOptions, this.config);\n      // Fetch the current campaign, check if need to track web attribution later\n      await this.webAttribution.init();\n    }\n\n    // Step 3: Set session ID\n    // Priority 1: `options.sessionId`\n    // Priority 2: sessionId from url if it's Number\n    // Priority 3: last known sessionId from user identity storage\n    // Default: `Date.now()`\n    // Session ID is handled differently than device ID and user ID due to session events\n    const queryParams = getQueryParams();\n    const querySessionId = Number.isNaN(Number(queryParams.ampSessionId))\n      ? undefined\n      : Number(queryParams.ampSessionId);\n    this.setSessionId(options.sessionId ?? querySessionId ?? this.config.sessionId ?? Date.now());\n\n    // Set up the analytics connector to integrate with the experiment SDK.\n    // Send events from the experiment SDK and forward identifies to the\n    // identity store.\n    const connector = getAnalyticsConnector(options.instanceName);\n    connector.identityStore.setIdentity({\n      userId: this.config.userId,\n      deviceId: this.config.deviceId,\n    });\n\n    // Step 4: Install plugins\n    // Do not track any events before this\n    if (this.config.offline !== OfflineDisabled) {\n      await this.add(networkConnectivityCheckerPlugin()).promise;\n    }\n    await this.add(new Destination()).promise;\n    await this.add(new Context()).promise;\n    await this.add(new IdentityEventSender()).promise;\n\n    // Notify if DET is enabled\n    detNotify(this.config);\n\n    if (isFileDownloadTrackingEnabled(this.config.defaultTracking)) {\n      this.config.loggerProvider.debug('Adding file download tracking plugin');\n      await this.add(fileDownloadTracking()).promise;\n    }\n\n    if (isFormInteractionTrackingEnabled(this.config.defaultTracking)) {\n      this.config.loggerProvider.debug('Adding form interaction plugin');\n      await this.add(formInteractionTracking()).promise;\n    }\n\n    // Add page view plugin\n    if (isPageViewTrackingEnabled(this.config.defaultTracking)) {\n      this.config.loggerProvider.debug('Adding page view tracking plugin');\n      await this.add(pageViewTrackingPlugin(getPageViewTrackingConfig(this.config))).promise;\n    }\n\n    if (isElementInteractionsEnabled(this.config.autocapture)) {\n      this.config.loggerProvider.debug('Adding user interactions plugin (autocapture plugin)');\n      await this.add(autocapturePlugin(getElementInteractionsConfig(this.config))).promise;\n    }\n\n    this.initializing = false;\n\n    // Step 6: Run queued dispatch functions\n    await this.runQueuedFunctions('dispatchQ');\n\n    // Step 7: Add the event receiver after running remaining queued functions.\n    connector.eventBridge.setEventReceiver((event) => {\n      void this.track(event.eventType, event.eventProperties);\n    });\n  }\n\n  getUserId() {\n    return this.config?.userId;\n  }\n\n  setUserId(userId: string | undefined) {\n    if (!this.config) {\n      this.q.push(this.setUserId.bind(this, userId));\n      return;\n    }\n    this.config.loggerProvider.debug('function setUserId: ', userId);\n    if (userId !== this.config.userId || userId === undefined) {\n      this.config.userId = userId;\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      this.timeline.onIdentityChanged({ userId: userId });\n      setConnectorUserId(userId, this.config.instanceName);\n    }\n  }\n\n  getDeviceId() {\n    return this.config?.deviceId;\n  }\n\n  setDeviceId(deviceId: string) {\n    if (!this.config) {\n      this.q.push(this.setDeviceId.bind(this, deviceId));\n      return;\n    }\n    this.config.loggerProvider.debug('function setDeviceId: ', deviceId);\n    if (deviceId !== this.config.deviceId) {\n      this.config.deviceId = deviceId;\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      this.timeline.onIdentityChanged({ deviceId: deviceId });\n      setConnectorDeviceId(deviceId, this.config.instanceName);\n    }\n  }\n\n  reset() {\n    this.setDeviceId(UUID());\n    this.setUserId(undefined);\n  }\n\n  getSessionId() {\n    return this.config?.sessionId;\n  }\n\n  setSessionId(sessionId: number) {\n    const promises: Promise<Result>[] = [];\n    if (!this.config) {\n      this.q.push(this.setSessionId.bind(this, sessionId));\n      return returnWrapper(Promise.resolve());\n    }\n    // Prevents starting a new session with the same session ID\n    if (sessionId === this.config.sessionId) {\n      return returnWrapper(Promise.resolve());\n    }\n\n    this.config.loggerProvider.debug('function setSessionId: ', sessionId);\n\n    const previousSessionId = this.getSessionId();\n    if (previousSessionId !== sessionId) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      this.timeline.onSessionIdChanged(sessionId);\n    }\n\n    const lastEventTime = this.config.lastEventTime;\n    let lastEventId = this.config.lastEventId ?? -1;\n\n    this.config.sessionId = sessionId;\n    this.config.lastEventTime = undefined;\n    this.config.pageCounter = 0;\n\n    if (isSessionTrackingEnabled(this.config.defaultTracking)) {\n      if (previousSessionId && lastEventTime) {\n        promises.push(\n          this.track(DEFAULT_SESSION_END_EVENT, undefined, {\n            device_id: this.previousSessionDeviceId,\n            event_id: ++lastEventId,\n            session_id: previousSessionId,\n            time: lastEventTime + 1,\n            user_id: this.previousSessionUserId,\n          }).promise,\n        );\n      }\n      this.config.lastEventTime = this.config.sessionId;\n    }\n\n    // Fire web attribution event when enable webAttribution tracking\n    // 1. has new campaign (call setSessionId from init function)\n    // 2. or shouldTrackNewCampaign (call setSessionId from async process(event) when there has new campaign and resetSessionOnNewCampaign = true )\n    const isCampaignEventTracked = this.trackCampaignEventIfNeeded(++lastEventId, promises);\n\n    if (isSessionTrackingEnabled(this.config.defaultTracking)) {\n      promises.push(\n        this.track(DEFAULT_SESSION_START_EVENT, undefined, {\n          event_id: isCampaignEventTracked ? ++lastEventId : lastEventId,\n          session_id: this.config.sessionId,\n          time: this.config.lastEventTime,\n        }).promise,\n      );\n    }\n\n    this.previousSessionDeviceId = this.config.deviceId;\n    this.previousSessionUserId = this.config.userId;\n    return returnWrapper(Promise.all(promises));\n  }\n\n  extendSession() {\n    if (!this.config) {\n      this.q.push(this.extendSession.bind(this));\n      return;\n    }\n    this.config.lastEventTime = Date.now();\n  }\n\n  setTransport(transport: TransportType) {\n    if (!this.config) {\n      this.q.push(this.setTransport.bind(this, transport));\n      return;\n    }\n    this.config.transportProvider = createTransport(transport);\n  }\n\n  identify(identify: IIdentify, eventOptions?: EventOptions) {\n    if (isInstanceProxy(identify)) {\n      const queue = identify._q;\n      identify._q = [];\n      identify = convertProxyObjectToRealObject(new Identify(), queue);\n    }\n    if (eventOptions?.user_id) {\n      this.setUserId(eventOptions.user_id);\n    }\n    if (eventOptions?.device_id) {\n      this.setDeviceId(eventOptions.device_id);\n    }\n    return super.identify(identify, eventOptions);\n  }\n\n  groupIdentify(groupType: string, groupName: string | string[], identify: IIdentify, eventOptions?: EventOptions) {\n    if (isInstanceProxy(identify)) {\n      const queue = identify._q;\n      identify._q = [];\n      identify = convertProxyObjectToRealObject(new Identify(), queue);\n    }\n    return super.groupIdentify(groupType, groupName, identify, eventOptions);\n  }\n\n  revenue(revenue: IRevenue, eventOptions?: EventOptions) {\n    if (isInstanceProxy(revenue)) {\n      const queue = revenue._q;\n      revenue._q = [];\n      revenue = convertProxyObjectToRealObject(new Revenue(), queue);\n    }\n    return super.revenue(revenue, eventOptions);\n  }\n\n  private trackCampaignEventIfNeeded(lastEventId?: number, promises?: Promise<Result>[]) {\n    if (!this.webAttribution || !this.webAttribution.shouldTrackNewCampaign) {\n      return false;\n    }\n\n    const campaignEvent = this.webAttribution.generateCampaignEvent(lastEventId);\n    if (promises) {\n      promises.push(this.track(campaignEvent).promise);\n    } else {\n      this.track(campaignEvent);\n    }\n    this.config.loggerProvider.log('Tracking attribution.');\n    return true;\n  }\n\n  async process(event: Event) {\n    const currentTime = Date.now();\n    const isEventInNewSession = isNewSession(this.config.sessionTimeout, this.config.lastEventTime);\n    const shouldSetSessionIdOnNewCampaign =\n      this.webAttribution && this.webAttribution.shouldSetSessionIdOnNewCampaign();\n\n    if (\n      event.event_type !== DEFAULT_SESSION_START_EVENT &&\n      event.event_type !== DEFAULT_SESSION_END_EVENT &&\n      (!event.session_id || event.session_id === this.getSessionId())\n    ) {\n      if (isEventInNewSession || shouldSetSessionIdOnNewCampaign) {\n        this.setSessionId(currentTime);\n        if (shouldSetSessionIdOnNewCampaign) {\n          this.config.loggerProvider.log('Created a new session for new campaign.');\n        }\n      } else if (!isEventInNewSession) {\n        // Web attribution should be tracked during the middle of a session\n        // if there has been a chance in the campaign information.\n        this.trackCampaignEventIfNeeded();\n      }\n    }\n\n    return super.process(event);\n  }\n\n  private logBrowserOptions(browserConfig: BrowserOptions & { apiKey: string }) {\n    try {\n      const browserConfigCopy = {\n        ...browserConfig,\n        apiKey: browserConfig.apiKey.substring(0, 10) + '********',\n      };\n      this.config.loggerProvider.debug('Initialized Amplitude with BrowserConfig:', JSON.stringify(browserConfigCopy));\n    } catch (e) {\n      /* istanbul ignore next */\n      this.config.loggerProvider.error('Error logging browser config', e);\n    }\n  }\n}\n","import { debugWrapper, getClientLogConfig, getClientStates, BrowserClient } from '@amplitude/analytics-core';\nimport { AmplitudeBrowser } from './browser-client';\n\nexport const createInstance = (): BrowserClient => {\n  const client = new AmplitudeBrowser();\n  return {\n    init: debugWrapper(\n      client.init.bind(client),\n      'init',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n    add: debugWrapper(\n      client.add.bind(client),\n      'add',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.plugins']),\n    ),\n    remove: debugWrapper(\n      client.remove.bind(client),\n      'remove',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.plugins']),\n    ),\n    track: debugWrapper(\n      client.track.bind(client),\n      'track',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    logEvent: debugWrapper(\n      client.logEvent.bind(client),\n      'logEvent',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    identify: debugWrapper(\n      client.identify.bind(client),\n      'identify',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    groupIdentify: debugWrapper(\n      client.groupIdentify.bind(client),\n      'groupIdentify',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    setGroup: debugWrapper(\n      client.setGroup.bind(client),\n      'setGroup',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    revenue: debugWrapper(\n      client.revenue.bind(client),\n      'revenue',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    flush: debugWrapper(\n      client.flush.bind(client),\n      'flush',\n      getClientLogConfig(client),\n      getClientStates(client, ['config.apiKey', 'timeline.queue.length']),\n    ),\n    getUserId: debugWrapper(\n      client.getUserId.bind(client),\n      'getUserId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config', 'config.userId']),\n    ),\n    setUserId: debugWrapper(\n      client.setUserId.bind(client),\n      'setUserId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config', 'config.userId']),\n    ),\n    getDeviceId: debugWrapper(\n      client.getDeviceId.bind(client),\n      'getDeviceId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config', 'config.deviceId']),\n    ),\n    setDeviceId: debugWrapper(\n      client.setDeviceId.bind(client),\n      'setDeviceId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config', 'config.deviceId']),\n    ),\n    reset: debugWrapper(\n      client.reset.bind(client),\n      'reset',\n      getClientLogConfig(client),\n      getClientStates(client, ['config', 'config.userId', 'config.deviceId']),\n    ),\n    getSessionId: debugWrapper(\n      client.getSessionId.bind(client),\n      'getSessionId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n    setSessionId: debugWrapper(\n      client.setSessionId.bind(client),\n      'setSessionId',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n    extendSession: debugWrapper(\n      client.extendSession.bind(client),\n      'extendSession',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n    setOptOut: debugWrapper(\n      client.setOptOut.bind(client),\n      'setOptOut',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n    setTransport: debugWrapper(\n      client.setTransport.bind(client),\n      'setTransport',\n      getClientLogConfig(client),\n      getClientStates(client, ['config']),\n    ),\n  };\n};\n\nexport default createInstance();\n","import { getGlobalScope } from '@amplitude/analytics-core';\nimport * as amplitudeGTM from './index';\nimport { createInstance } from './browser-client-factory';\nimport { runQueuedFunctions } from './utils/snippet-helper';\n\n// https://developer.mozilla.org/en-US/docs/Glossary/IIFE\n(function () {\n  const GlobalScope = getGlobalScope();\n\n  if (!GlobalScope) {\n    console.error('[Amplitude] Error: GlobalScope is not defined');\n    return;\n  }\n\n  const createNamedInstance = (instanceName?: string) => {\n    const instance = createInstance();\n    const GlobalScope = getGlobalScope();\n    if (GlobalScope && GlobalScope.amplitudeGTM && GlobalScope.amplitudeGTM._iq && instanceName) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      GlobalScope.amplitudeGTM._iq[instanceName] = instance;\n    }\n    return instance;\n  };\n\n  GlobalScope.amplitudeGTM = Object.assign(GlobalScope.amplitudeGTM || {}, amplitudeGTM, {\n    createInstance: createNamedInstance,\n  });\n\n  if (GlobalScope.amplitudeGTM.invoked) {\n    const queue = GlobalScope.amplitudeGTM._q;\n    GlobalScope.amplitudeGTM._q = [];\n    runQueuedFunctions(amplitudeGTM, queue);\n\n    const instanceNames = Object.keys(GlobalScope.amplitudeGTM._iq) || [];\n    for (let i = 0; i < instanceNames.length; i++) {\n      const instanceName = instanceNames[i];\n      const instance = Object.assign(GlobalScope.amplitudeGTM._iq[instanceName], createNamedInstance(instanceName));\n      const queue = instance._q;\n      instance._q = [];\n      runQueuedFunctions(instance, queue);\n    }\n  }\n})();\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","IdentifyOperation","SpecialEventType","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","slice","concat","__await","__asyncGenerator","asyncIterator","q","a","resume","fulfill","settle","shift","__asyncValues","AMPLITUDE_PREFIX","STORAGE_PREFIX","AMPLITUDE_SERVER_URL","isValidObject","properties","keys","key","isValidProperties","property","e_1","_a","isArray","isValid","value_1","value_1_1","valueElement","includes","e_1_1","Identify","_propertySet","Set","_properties","getUserProperties","set","_safeSet","SET","setOnce","SET_ONCE","append","APPEND","prepend","PREPEND","postInsert","POSTINSERT","preInsert","PREINSERT","remove","REMOVE","add","ADD","unset","UNSET","clearAll","CLEAR_ALL","operation","_validate","userPropertyMap","undefined","has","Status","OrderedIdentifyOperations","RevenueProperty","buildResult","event","code","message","Unknown","getGlobalScope","ampIntegrationContextName","globalThis","window","self","global","hex","map","index","toString","padStart","UUID","globalScope","crypto","getRandomValues","Math","random","replace","legacyUUID","Uint8Array","entries","_b","int","join","Timeline","client","queue","applying","plugins","register","plugin","config","_c","some","existingPlugin","name","loggerProvider","warn","type","setup","deregister","pluginName","findIndex","splice","teardown","reset","_this","scheduleApply","timeout","setTimeout","item","before","before_1","before_1_1","enrichment","enrichment_1","enrichment_1_1","e_2_1","destination","executeDestinations","e_2","_d","_e","filter","execute","eventClone","catch","all","resolveResult","flush","onIdentityChanged","identity","forEach","onSessionIdChanged","sessionId","onOptOutChanged","optOut","createIdentifyEvent","identify","eventOptions","event_type","IDENTIFY","user_properties","returnWrapper","awaitable","promise","AmplitudeCore","initializing","isReady","dispatchQ","logEvent","track","bind","timeline","_init","runQueuedFunctions","queueName","queuedFunctions","queuedFunctions_1","queuedFunctions_1_1","queuedFunction","val","eventInput","eventProperties","event_properties","createTrackEvent","dispatch","groupIdentify","groupType","groupName","GROUP_IDENTIFY","group_properties","groups","createGroupIdentifyEvent","setGroup","createGroupEvent","revenue","REVENUE","getEventProperties","createRevenueEvent","_addPlugin","_removePlugin","dispatchWithCallback","callback","process","getOperationAppliedUserProperties","userProperties","updatedProperties","nonOpProperties","values","opProperties","prop","log","setOptOut","_setOptOut","Boolean","find","debug","Revenue","productId","quantity","price","setProductId","setQuantity","setPrice","setRevenueType","revenueType","setCurrency","currency","setRevenue","setReceipt","receipt","setReceiptSig","receiptSig","setEventProperties","REVENUE_PRODUCT_ID","REVENUE_QUANTITY","REVENUE_PRICE","REVENUE_TYPE","REVENUE_CURRENCY","RECEIPT","RECEIPT_SIG","LogLevel","PREFIX","Logger","logLevel","None","disable","enable","Warn","args","_i","Verbose","console","Error","Debug","getDefaultConfig","flushMaxRetries","flushQueueSize","flushIntervalMillis","instanceName","offline","serverUrl","serverZone","useBatch","Config","options","_optOut","defaultConfig","apiKey","minIdLength","plan","ingestionMetadata","storageProvider","transportProvider","serverConfig","createServerConfig","defineProperty","get","enumerable","configurable","getServerUrl","_serverZone","RequestMetadata","sdk","metrics","histogram","recordHistogram","getResponseBodyString","res","responseBodyString","JSON","stringify","Destination","retryTimeout","throttleTimeout","storageKey","scheduleId","scheduledTimeout","flushId","unsent","substring","insert_id","context","attempts","schedule","saveEvents","removeEventsExceedFlushMaxRetries","list","fulfillRequest","scheduleEvents","clearTimeout","resetSchedule","useRetry","later","arr","size","chunkSize","max","reduce","chunks","element","chunkIndex","floor","batch","send","payload","errorMessage","api_key","events","extra","min_id_length","client_upload_time","Date","toISOString","request_metadata","requestMetadata","handleResponse","statusCode","status","Failed","Success","handleSuccessResponse","Invalid","handleInvalidResponse","PayloadTooLarge","handlePayloadTooLargeResponse","RateLimit","handleRateLimitResponse","handleOtherResponse","missingField","startsWith","dropIndex","eventsWithInvalidFields","eventsWithMissingFields","eventsWithInvalidIdLengths","silencedEvents","flat","dropIndexSet","retry","tryable","dropUserIds","exceededDailyQuotaUsers","dropDeviceIds","exceededDailyQuotaDevices","throttledIndex","throttledEvents","dropUserIdsSet","dropDeviceIdsSet","throttledIndexSet","user_id","device_id","removeEvents","updatedEvents","eventsToRemove","queuedContext","ApplicationContextProviderImpl","getApplicationContext","versionName","language","getLanguage","platform","os","deviceModel","navigator","languages","EventBridgeImpl","receiver","setEventReceiver","SuppressedError","isEqual","obj1","obj2","typeA","primitive_1","primitive_1_1","isArrayA","isArrayB","sorted1","sort","sorted2","result_1","obj","ownProps","resArray","ServerZone","IdentityStoreImpl","listeners","editIdentity","actingUserProperties","actingIdentity","setUserId","userId","setDeviceId","deviceId","setUserProperties","updateUserProperties","actions","e_3","actingProperties","_f","action","_g","_h","_j","_k","_l","e_3_1","commit","setIdentity","getIdentity","originalIdentity","listener","addIdentityListener","removeIdentityListener","delete","safeGlobal","AnalyticsConnector","identityStore","eventBridge","applicationContextProvider","getInstance","getAnalyticsConnector","IdentityEventSender","isNewSession","sessionTimeout","lastEventTime","now","getCookieName","postKey","limit","userLanguage","getQueryParams","location","search","split","acc","curr","query","tryDecodeURIComponent","decodeURIComponent","getStacktrace","ignoreDepth","stack","text","trim","getClientLogConfig","logger","getValueByStringPath","path","attr","getClientStates","paths","paths_1","paths_1_1","debugWrapper","fn","fnName","getLogConfig","getStates","fnContext","debugContext","stacktrace","time","start","states","after","end","MemoryStorage","memoryStorage","Map","isEnabled","getRaw","clear","CookieStorage","testStrorage","testKey","testValue","decodedValue","decodeCookiesAsDefault","decodeCookiesWithDoubleUrlEncoding","parse","cookie","match","document","c","expirationDays","expires","expireDate","date","str","setTime","getTime","btoa","encodeURIComponent","toUTCString","domain","secure","sameSite","atob","BaseTransport","_serverUrl","_payload","buildResponse","responseJSON","_m","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","buildStatus","eventsIngested","events_ingested","payloadSizeBytes","payload_size_bytes","serverUploadTime","server_upload_time","missing_field","events_with_invalid_fields","events_with_missing_fields","events_with_invalid_id_lengths","epsThreshold","eps_threshold","exceeded_daily_quota_devices","silencedDevices","silenced_devices","silenced_events","throttledDevices","throttled_devices","throttled_events","throttledUsers","throttled_users","exceeded_daily_quota_users","Timeout","FetchTransport","_super","response","responseText","fetch","headers","Accept","method","DEFAULT_CSS_SELECTOR_ALLOWLIST","DEFAULT_DATA_ATTRIBUTE_PREFIX","DEFAULT_ACTION_CLICK_ALLOWLIST","isTrackingEnabled","autocapture","isAttributionTrackingEnabled","isPageViewTrackingEnabled","isSessionTrackingEnabled","isElementInteractionsEnabled","elementInteractions","getElementInteractionsConfig","getPageViewTrackingConfig","eventType","trackOn","trackHistoryChanges","pageCounter","defaultTracking","pageViews","instance","convertProxyObjectToRealObject","name_1","isInstanceProxy","VERSION","Context","library","userAgent","lastEventId","nextEventId","event_id","session_id","appVersion","app_version","trackingOptions","ipAddress","ip","partner_id","partnerId","ingestion_metadata","source_name","sourceName","source_version","sourceVersion","user_agent","BrowserStorage","storage","testStorage","getItem","setItem","removeItem","MAX_ARRAY_LENGTH","LocalStorage","localStorage","droppedEventsCount","SessionStorage","sessionStorage","XHRTransport","state","XMLHttpRequest","xhr","open","onreadystatechange","readyState","setRequestHeader","SendBeaconTransport","sendBeacon","data","parseLegacyCookies","cookieStorage","deleteLegacyCookies","cookieName","toLowerCase","getOldCookieName","cookies","decode","parseTime","num","integer","parseInt","isNaN","escape","DEFAULT_EVENT_PREFIX","DEFAULT_FORM_START_EVENT","DEFAULT_FORM_SUBMIT_EVENT","DEFAULT_FILE_DOWNLOAD_EVENT","DEFAULT_SESSION_START_EVENT","DEFAULT_SESSION_END_EVENT","FILE_EXTENSION","FILE_NAME","LINK_ID","LINK_TEXT","LINK_URL","FORM_ID","FORM_NAME","FORM_DESTINATION","DEFAULT_IDENTITY_STORAGE","BrowserConfig","cookieOptions","identityStorage","transport","fetchRemoteConfig","debugLogsEnabled","expiration","upgrade","createTransport","version","_cookieStorage","updateStorage","_deviceId","_userId","_sessionId","_lastEventTime","_lastEventId","_pageCounter","_debugLogsEnabled","cache","useBrowserConfig","amplitudeInstance","getTopLevelDomain","_3","createCookieStorage","legacyCookies","previousCookies","queryParams","ampDeviceId","previousSessionDeviceId","previousSessionUserId","_y","_z","_0","_1","_2","browserConfig","url","hostname","host","parts","levels","DCLID","FBCLID","GBRAID","GCLID","KO_CLICK_ID","LI_FAT_ID","MSCLKID","RDT_CID","TTCLID","TWCLID","WBRAID","BASE_CAMPAIGN","utm_campaign","utm_content","utm_id","utm_medium","utm_source","utm_term","referrer","referring_domain","dclid","gbraid","gclid","fbclid","ko_click_id","li_fat_id","msclkid","rtd_cid","ttclid","twclid","wbraid","CampaignParser","getUtmParam","getReferrer","getClickIds","params","omitUndefined","input","pageViewTrackingPlugin","amplitude","pushState","localConfig","getDecodeURI","locationStr","decodedLocationStr","decodeURI","createPageViewEvent","locationHREF","href","getCampaignParams","pathname","title","shouldTrackOnPageLoad","previousURL","trackHistoryPageView","newURL","shouldTrackPageView","shouldTrackHistoryPageView","trackHistoryPageViewWrapper","addEventListener","history","Proxy","target","unused","pageViewEvent","isCampaignEvent","removeEventListener","$set","$unset","userProperties_1","every","trackingOption","newURLStr","oldURLStr","URL","oldURL","origin","formInteractionTracking","observer","eventListeners","handler","initializeFormTracking","addFormInteractionListener","form","hasFormChanged","formDestination","extractFormAction","stringOrUndefined","id","getElementsByTagName","MutationObserver","mutations","mutation","addedNodes","node","nodeName","querySelectorAll","observe","subtree","childList","window_1","disconnect","getAttribute","encodeURI","fileDownloadTracking","initializeFileDownloadTracking","addFileDownloadListener","ext","exec","fileExtension","notified","networkConnectivityCheckerPlugin","addNetworkListener","onLine","TIMEOUT_MESSAGE","RemoteConfigFetch","configKeys","sessionTargetingMatch","getRemoteConfig","configNamespace","fetchStartTime","configAPIResponse","remoteConfig","fetchWithTimeout","configs","fetchTimeAPISuccess","fetchTimeAPIFail","controller","timeoutId","AbortController","abort","signal","urlParams","configKey","knownError","lastFetchedSessionId","completeRequest","err","aborted","URLSearchParams","parseAndStoreConfig","retryFetch","json","success","STAGING","EU","createRemoteConfigFetch","BrowserJoinedConfigGenerator","initialize","remoteConfigFetch","generateJoinedConfig","transformedAutocaptureRemoteConfig","pageUrlAllowlistRegex","transformedRcElementInteractions","exactAllowList","pageUrlAllowlist","regexList","pattern","RegExp","regexError","combinedPageUrlAllowlist","attribution","fileDownloads","formInteractions","sessions","AMPLITUDE_ELEMENT_CLICKED_EVENT","AMPLITUDE_EVENT_PROP_ELEMENT_TAG","AMPLITUDE_EVENT_PROP_ELEMENT_TEXT","AMPLITUDE_EVENT_PROP_PAGE_URL","AMPLITUDE_ORIGIN","AMPLITUDE_ORIGINS_MAP","US","isFunction","createErrorClass","createImpl","ctorFunc","UnsubscriptionError","errors","arrRemove","Subscription","initialTeardown","closed","_parentage","_finalizers","empty","unsubscribe","_parentage_1","_parentage_1_1","initialFinalizer","_finalizers_1","_finalizers_1_1","finalizer","execFinalizer","_hasParent","_addParent","parent","_removeParent","EMPTY","EMPTY_SUBSCRIPTION","isSubscription","onUnhandledError","onStoppedNotification","useDeprecatedSynchronousErrorHandling","useDeprecatedNextContext","timeoutProvider","reportUnhandledError","noop","errorContext","cb","Subscriber","isStopped","EMPTY_OBSERVER","complete","SafeSubscriber","_next","_error","_complete","_bind","Function","ConsumerObserver","partialObserver","handleUnhandledError","observerOrNext","context_1","observable","x","pipeFromArray","fns","prev","Observable","subscribe","_subscribe","lift","operator","source","subscriber","isObserver","_trySubscribe","sink","promiseCtor","getPromiseCtor","Symbol_observable","pipe","operations","toPromise","hasLift","operate","init","liftedSource","createOperatorSubscriber","onNext","onComplete","onError","onFinalize","OperatorSubscriber","shouldUnsubscribe","closed_1","ConnectableObservable","subjectFactory","_subject","_refCount","_connection","getSubject","subject","_teardown","connect","connection","subject_1","refCount","refCounter","sharedConnection","conn","higherOrderRefCount","timestampProvider","performanceTimestampProvider","delegate","performance","animationFrameProvider","request","requestAnimationFrame","cancel","cancelAnimationFrame","handle","timestamp","provider","run","elapsed","ObjectUnsubscribedError","Subject","currentObservers","observers","hasError","thrownError","AnonymousSubject","_throwIfClosed","_checkFinalizedStatuses","_innerSubscribe","asObservable","BehaviorSubject","_value","getValue","subscription","dateTimestampProvider","ReplaySubject","_bufferSize","_windowTime","_timestampProvider","Infinity","_buffer","_infiniteTimeWindow","_trimBuffer","copy","adjustedBufferSize","last","AsyncSubject","_hasValue","_isComplete","resolved","Action","scheduler","work","delay","intervalProvider","setInterval","AsyncAction","pending","recycleAsyncId","requestAsyncId","_id","_scheduler","_execute","_delay","errorValue","errored","nextHandle","activeHandles","findAndClearHandle","setImmediate","clearImmediate","immediateProvider","AsapAction","_scheduled","Scheduler","schedulerActionCtor","AsyncScheduler","SchedulerAction","_active","AsapScheduler","asyncScheduler","async","QueueAction","QueueScheduler","AnimationFrameAction","AnimationFrameScheduler","VirtualTimeScheduler","maxFrames","VirtualAction","frame","frameTimeFactor","active","Number","isFinite","sortActions","isScheduler","popScheduler","popNumber","defaultValue","isArrayLike","isPromise","isInteropObservable","isAsyncIterable","createInvalidObservableTypeError","NotificationKind","isIterable","Symbol_iterator","readableStreamLikeToAsyncGenerator","readableStream","reader","getReader","read","releaseLock","isReadableStreamLike","innerFrom","obs","array","fromAsyncIterable","iterable","iterable_1","iterable_1_1","asyncIterable","asyncIterable_1","asyncIterable_1_1","executeSchedule","parentSubscription","repeat","scheduleSubscription","observeOn","subscribeOn","scheduleAsyncIterable","scheduled","scheduleObservable","scheduleArray","schedulePromise","scheduleIterable","scheduleReadableStreamLike","isValidDate","TimeoutError","info","timeoutErrorFactory","project","mapOneOrManyArgs","callOrApply","mergeMap","resultSelector","concurrent","ii","onBeforeNext","expand","innerSubScheduler","additionalFinalizer","buffer","isComplete","checkComplete","outerNext","doInnerSub","innerComplete","innerValue","_loop_1","bufferedValue","mergeInternals","mergeAll","concatAll","nodeEventEmitterMethods","eventTargetMethods","jqueryMethods","fromEvent","eventName","isEventTarget","methodName","addListener","removeListener","isNodeStyleEventEmitter","toCommonHandlerRegistry","on","off","isJQueryStyleEventEmitter","subTarget","merge","sources","predicate","take","count","seen","delayWhen","delayDurationSelector","subscriptionDelay","mapTo","due","duration","dueTime","intervalOrScheduler","intervalDuration","timer","share","connector","resetOnError","resetOnComplete","resetOnRefCountZero","wrapperSource","resetConnection","hasCompleted","hasErrored","cancelReset","resetAndUnsubscribe","dest","handleReset","onSubscriber","SENSITIVE_TAGS","createShouldTrackEvent","autocaptureOptions","allowlist","actionType","shouldTrackEventResolver","tag","tagName","isPageUrlAllowed","elementType","hasMatchAnyAllowedSelector","selector","matches","computedStyle","getComputedStyle","getPropertyValue","isNonSensitiveString","test","isNonSensitiveElement","isContentEditable","HTMLElement","getText","childNodes","child","childText","nodeType","textContent","allowedUrl","removeEmptyProperties","filteredProperties","isEmpty","getNearestLabel","labelElement","parentElement","querySelector","labelText","getClosestElement","selectors","getEventTagProps","constants.AMPLITUDE_EVENT_PROP_ELEMENT_TAG","constants.AMPLITUDE_EVENT_PROP_ELEMENT_TEXT","constants.AMPLITUDE_EVENT_PROP_PAGE_URL","filterOutNonTrackableEvents","closestTrackedAncestor","WindowMessenger","endpoint","requestCallbacks","onSelect","notify","onTrack","opener","postMessage","sendRequest","substr","responseData","isElementSelectable","cssSelectorAllowlist","actionClickAllowlist","amplitudeVisualTaggingSelectorInstance","eventData","actionData_1","scriptElement","createElement","src","once","head","appendChild","amplitudeVisualTaggingSelector","visualHighlightClass","messenger","close","BLOCKED_ATTRIBUTES","SENSITIVE_ELEMENT_ATTRIBUTE_ALLOWLIST","SVG_TAGS","HIGHLY_SENSITIVE_INPUT_TYPES","getHierarchy","hierarchy","bytesLimit","numChars","ensureUnicodePythonCompatible","ensureListUnderLimit","targetEl","ancestors","current","getAncestors","el","siblings","children","indexOfType","prevSiblingTag","previousElementSibling","prevSib","classes","classList","attributes","filteredAttributes","isSensitiveElement","filteredAttributes_1","filteredAttributes_1_1","attrs","getElementProperties","nested","elements","ObservablesEnum","trackClicks","closingNotifier","allObservables","shouldTrackEvent","clickObservable","comparisonTrigger","hasPrev","targetChanged","samePos","abs","screenX","screenY","triggers","debounceTime","activeTask","lastValue","lastTime","emit","emitWhenIdle","targetTime","click","currentBuffer","clicks","clickType","clicks_1","clicks_1_1","targetElementProperties","trackActionClick","shouldTrackActionClick","mutationObservable","navigateObservable","filteredClickObservable","closestActionClickEl","clickEvent","changeObservables","mutationOrNavigate","actionClicks","schedulerArg","first","each","with","_with","meta","originalSourceSubscription","timerSubscription","startTimer","innerSubscriber","innerIndex","outerIndex","actionClick","Types","autocapturePlugin","dataAttributePrefix","visualTaggingOptions","enabled","subscriptions","rect","getBoundingClientRect","left","top","ariaLabel","prefix","getAttributeNames","attributeName","attributeKey","attributeValue","getAttributesWithPrefix","nearestLabel","round","innerHeight","innerWidth","HTMLAnchorElement","addAdditionalEventProperties","baseEvent","isElementBasedEvent","clickTrackingSubscription","changeSubscription","actionClickSubscription","capture","changeObservable","change","navigation","navigate","mutationObserver","characterData","ClickObservable","ChangeObservable","NavigateObservable","MutationObservable","createObservables","changeEvent","trackChange","constants.AMPLITUDE_ORIGINS_MAP","subscriptions_1","subscriptions_1_1","domainWithoutSubdomain","isNewCampaign","previous","currentCampaign","prevReferringDomain","previousCampaign","isExcludedReferrer","excludeReferrers","isDirectTraffic","hasNewCampaign","hasNewDomain","referringDomain","WebAttribution","cookieDomain","shouldTrackNewCampaign","initialEmptyValue","resetSessionOnNewCampaign","fetchCampaign","isEventInNewSession","generateCampaignEvent","campaign","campaignParameters","identifyEvent","campaignEvent","shouldSetSessionIdOnNewCampaign","AmplitudeBrowser","userIdOrOptions","maybeOptions","browserOptions","joinedConfigGenerator","logBrowserOptions","attributionTrackingOptions","getAttributionTrackingConfig","webAttribution","querySessionId","ampSessionId","setSessionId","detNotify","isFormInteractionTrackingEnabled","getUserId","setConnectorUserId","getDeviceId","setConnectorDeviceId","getSessionId","promises","previousSessionId","isCampaignEventTracked","trackCampaignEventIfNeeded","extendSession","setTransport","currentTime","browserConfigCopy","createInstance","IdentifyOperationType","SpecialEventTypeType","RevenuePropertyType","LogLevelType","ServerZoneEnum","OfflineDisabled","DEFAULT_CSS_SELECTOR_ALLOWLIST_TYPE","DEFAULT_DATA_ATTRIBUTE_PREFIX_TYPE","DEFAULT_ACTION_CLICK_ALLOWLIST_TYPE","GlobalScope","createNamedInstance","amplitudeGTM","_iq","invoked","instanceNames","queue_1"],"mappings":"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"}